<!DOCTYPE html>

<html lang="ko">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>SCM ê°œë°œ ë³´ê³ ì„œ</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>

        /* Market Report Generator - Base Styles */
/* Extracted from: ê¸€ë¡œë²Œ ëŸ¬ë²„íŠ¸ë™(MHE&CTL) ì‹œì¥ ì „ëµ ë³´ê³ ì„œ */


* {

    margin: 0;

    padding: 0;

    box-sizing: border-box; 

}



:root {
    --bg: #fafbfc;
    --surface: #ffffff;
    --text: #2f2f33;
    --muted: #666a73;
    --border: #e9ecf1;
    --primary-50: #f7f5ff;
    --primary-100: #efeaff;
    --primary-200: #ded5ff;
    --primary-300: #c4b6ff;
    --primary-400: #a08dff;
    --primary-500: #7b64ff;
    --primary-600: #6a54f0;
    --accent: #12b886;
    --shadow: 0 2px 8px rgba(17, 17, 26, 0.03);
}

body {
    font-family: 'Noto Sans KR', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.7;
}



.container {

    max-width: 1400px;

    margin: 0 auto;

    padding: 32px 20px;

}



header {
    background: var(--surface);
    padding: 32px 40px;
    text-align: center;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(17, 17, 26, 0.03);
    margin-bottom: 32px;
    border-bottom: 1px solid var(--border);
}



h1 {
    color: var(--text);
    font-size: 1.8em;
    margin-bottom: 6px;
    font-weight: 600;
    letter-spacing: -0.01em;
}



.subtitle {
    color: var(--muted);
    font-size: 0.95em;
    font-weight: 400;
}



.home-section {
    background: var(--surface);
    padding: 32px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(17, 17, 26, 0.03);
    margin-bottom: 24px;
    border: 1px solid var(--border);
}



.button-grid {

    display: grid;

    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));

    gap: 25px;

    margin-top: 40px;

}



.nav-button {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 20px;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.2s ease, border-color 0.2s ease;
    text-align: left;
    box-shadow: 0 1px 3px rgba(17, 17, 26, 0.04);
}



.nav-button:hover {
    background: var(--primary-50);
    border-color: var(--primary-300);
}



.nav-button h3 {
    color: var(--text);
    margin-bottom: 4px;
    font-size: 1.1em;
    font-weight: 600;
}



.nav-button p {
    color: var(--muted);
    font-size: 0.85em;
    margin: 0;
}



.content-section {
    display: none;
    background: var(--surface);
    padding: 32px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(17, 17, 26, 0.03);
    margin-bottom: 24px;
    border: 1px solid var(--border);
    max-width: 1400px;
    margin-left: auto;
    margin-right: auto;
}



.content-section.active {

    display: block;

    animation: fadeIn 0.5s ease;

}



@keyframes fadeIn {

    from { opacity: 0; transform: translateY(20px); }

    to { opacity: 1; transform: translateY(0); }

}



h2 {
    color: var(--text);
    font-size: 1.5em;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border);
    font-weight: 600;
}



h3 {
    color: var(--text);
    font-size: 1.25em;
    margin-top: 28px;
    margin-bottom: 14px;
}



h4 {
    color: var(--muted);
    font-size: 1.05em;
    margin-top: 22px;
    margin-bottom: 10px;
}



.back-button {
    background: linear-gradient(180deg, var(--primary-500), var(--primary-600));
    color: #fff;
    border: none;
    padding: 12px 22px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 0.95em;
    margin-top: 28px;
    margin-bottom: 0;
    transition: transform 0.15s ease, box-shadow 0.2s ease;
    box-shadow: 0 8px 24px rgba(123, 100, 255, 0.25);
    font-weight: 600;
}



.back-button:hover {
    transform: translateY(-1px);
    box-shadow: 0 10px 28px rgba(123, 100, 255, 0.28);
}



.stat-card {
    background: var(--surface);
    padding: 20px;
    border-radius: 10px;
    margin: 18px 0;
    border: 1px solid var(--border);
    box-shadow: 0 1px 3px rgba(17, 17, 26, 0.04);
}



.stat-grid {

    display: grid;

    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));

    gap: 20px;

    margin: 25px 0;

}



.stat-item {
    background: var(--surface);
    padding: 16px;
    border-radius: 10px;
    text-align: center;
    border: 1px solid var(--border);
}



.stat-value {
    font-size: 1.6em;
    font-weight: 600;
    color: var(--primary-600);
    margin-bottom: 6px;
    text-align: center;
}



.stat-label {
    color: var(--muted);
    font-size: 0.9em;
}



.chart-container {
    background: var(--surface);
    padding: 20px;
    border-radius: 10px;
    margin: 24px 0;
    box-shadow: 0 1px 3px rgba(17, 17, 26, 0.04);
    border: 1px solid var(--border);
}



table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    margin: 22px 0;
    background: var(--surface);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(17, 17, 26, 0.04);
    border: 1px solid var(--border);
}



th {
    background: #fafbfc;
    color: var(--text);
    padding: 14px 16px;
    text-align: left;
    font-weight: 500;
    border-bottom: 1px solid var(--border);
}



td {
    padding: 14px 16px;
    border-top: 1px solid var(--border);
    border-left: none;
    border-right: none;
}



tr:hover {
    background: #fbfbff;
}



.highlight {
    background: linear-gradient(180deg, #fffefb, #fffdfa);
    padding: 18px;
    border-radius: 12px;
    margin: 18px 0;
    border: 1px solid #f2ead6;
}



.swot-grid {

    display: grid;

    grid-template-columns: repeat(2, 1fr);

    gap: 20px;

    margin: 25px 0;

}



.swot-item {

    padding: 25px;

    border-radius: 12px;

    border: 2px solid;

}



.strength {

    background: linear-gradient(135deg, #e8f5e8 0%, #dceedc 100%);

    border-color: #a5d5a5;

}



.weakness {

    background: linear-gradient(135deg, #ffe8e8 0%, #ffdcdc 100%);

    border-color: #f5a5a5;

}



.opportunity {

    background: linear-gradient(135deg, #e8f0f5 0%, #dce8ee 100%);

    border-color: #a5c5d5;

}



.threat {

    background: linear-gradient(135deg, #f5e8f0 0%, #eedce8 100%);

    border-color: #d5a5c5;

}



ul, ol {

    margin-left: 25px;

    margin-top: 15px;

    margin-bottom: 15px;

}



li {

    margin-bottom: 10px;

    line-height: 1.7;

}



.competitor-card {

    background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);

    padding: 25px;

    border-radius: 12px;

    margin: 20px 0;

    border: 2px solid #f5d5d5;

}



.region-section {

    background: linear-gradient(135deg, #e8f5fa 0%, #dceef5 100%);

    padding: 25px;

    border-radius: 12px;

    margin: 25px 0;

    border-left: 5px solid #a5c5d5;

}



strong {
    color: var(--primary-600);
}

/* Utilities */
.muted { color: var(--muted); }
.pill { display:inline-block; padding:6px 10px; border-radius:999px; font-size:12px; background:var(--primary-50); color:var(--primary-600); border:1px solid var(--primary-100); }

/* Calendar Styles */
#calendar-wrapper {
    margin-top: 20px;
}

.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding: 10px 0;
}

.calendar-nav-btn {
    background: var(--primary-500);
    color: #fff;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.2em;
    transition: background 0.2s ease;
}

.calendar-nav-btn:hover {
    background: var(--primary-600);
}

#calendar-month-year {
    margin: 0;
    font-size: 1.3em;
    color: var(--text);
}

#calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 8px;
    background: var(--surface);
    padding: 10px;
    border-radius: 12px;
    border: 1px solid var(--border);
}

.calendar-day-header {
    text-align: center;
    font-weight: 600;
    padding: 10px;
    color: var(--muted);
    font-size: 0.9em;
}

.calendar-day-header.sunday {
    color: #e74c3c;
}

.calendar-day-header.saturday {
    color: #3498db;
}

.calendar-day {
    min-height: 80px;
    padding: 8px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--surface);
    position: relative;
    cursor: pointer;
    transition: background 0.2s ease;
}

.calendar-day:hover {
    background: var(--primary-50);
}

.calendar-day.other-month {
    opacity: 0.3;
    background: #f5f5f5;
}

.calendar-day-number {
    font-weight: 600;
    margin-bottom: 4px;
    color: var(--text);
}

.calendar-day.sunday .calendar-day-number {
    color: #e74c3c;
}

.calendar-day.saturday .calendar-day-number {
    color: #3498db;
}

.calendar-day.holiday {
    background: #fff5f5;
}

.calendar-day.holiday .calendar-day-number {
    color: #e74c3c;
    font-weight: 700;
}

.calendar-holiday-label {
    font-size: 0.65em;
    color: #e74c3c;
    font-weight: 600;
    margin-top: 2px;
}

.calendar-event {
    font-size: 0.75em;
    padding: 2px 4px;
    margin: 2px 0;
    background: var(--primary-200);
    color: var(--primary-700);
    border-radius: 4px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    cursor: move;
    user-select: none;
    transition: transform 0.2s ease, opacity 0.2s ease;
}

.calendar-event:hover {
    background: var(--primary-300);
}

.calendar-event.dragging {
    opacity: 0.5;
    transform: scale(0.95);
}

.calendar-day.drag-over {
    background: var(--primary-100);
    border-color: var(--primary-400);
    border-width: 2px;
}

.calendar-today {
    background: var(--primary-100);
    border-color: var(--primary-400);
}

/* Weekly Production Plan Styles */
.week-selector {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding: 15px;
    background: var(--surface);
    border-radius: 12px;
    border: 1px solid var(--border);
}

.week-nav-btn {
    background: var(--primary-500);
    color: #fff;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.95em;
    transition: background 0.2s ease;
}

.week-nav-btn:hover {
    background: var(--primary-600);
}

#week-title {
    margin: 0;
    font-size: 1.3em;
    color: var(--text);
}

.production-table-container {
    overflow-x: auto;
    margin: 20px 0;
}

.production-table {
    width: 100%;
    border-collapse: collapse;
    background: var(--surface);
    font-size: 0.85em;
}

.production-table th {
    background: #fafbfc;
    color: var(--text);
    padding: 10px 8px;
    text-align: center;
    font-weight: 500;
    border-top: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    white-space: nowrap;
}

.production-table .machine-header {
    background: linear-gradient(180deg, #e8f5f0, #d0eae0);
    min-width: 60px;
}

.production-table .month-header {
    background: linear-gradient(180deg, #e8f5f0, #d0eae0);
    min-width: 50px;
}

.production-table .shift-header {
    min-width: 150px;
    font-size: 0.9em;
}

.production-table .day-shift {
    background: linear-gradient(180deg, #fff8e8, #ffeed0);
}

.production-table .night-shift {
    background: linear-gradient(180deg, #e8e8ff, #d0d0f5);
}

.production-table td {
    border-top: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    padding: 4px;
    vertical-align: top;
    min-height: 40px;
    position: relative;
}

.production-table .machine-cell {
    background: linear-gradient(135deg, #f5f5ff, #eeeeff);
    font-weight: 600;
    text-align: center;
    color: var(--primary-600);
}

.production-table .shift-cell {
    min-height: 140px;
    height: 140px;
    background: var(--surface);
    overflow-y: auto;
}

.production-table .shift-cell.day-shift-bg {
    background: linear-gradient(180deg, #fffef8, #fffdf0);
}

.production-table .shift-cell.night-shift-bg {
    background: linear-gradient(180deg, #f8f8ff, #f0f0ff);
}

.work-item {
    background: linear-gradient(135deg, #ffffff, #f5f8ff);
    border: 1px solid var(--primary-200);
    border-left: 3px solid var(--primary-500);
    padding: 4px 6px;
    margin: 2px 0;
    border-radius: 4px;
    cursor: move;
    transition: all 0.2s ease;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    font-size: 0.85em;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.work-item:hover {
    background: linear-gradient(135deg, #f0f4ff, #e8f0ff);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transform: translateY(-1px);
}

.work-item.dragging {
    opacity: 0.4;
    transform: scale(0.95);
}

.work-item-name {
    display: inline;
    font-weight: 600;
    color: var(--text);
    font-size: 0.95em;
}

.work-item-quantity {
    display: inline;
    color: var(--primary-600);
    font-weight: 700;
    font-size: 0.95em;
    margin-left: 4px;
}

.work-item-note {
    color: #e74c3c;
    font-size: 0.85em;
    font-style: italic;
}

.work-item .work-item-note {
    display: block;
    margin-top: 2px;
}

.shift-cell.drag-over {
    background: var(--primary-100) !important;
    border: 2px dashed var(--primary-400);
}

.empty-cell {
    color: var(--muted);
    text-align: center;
    padding: 20px;
    font-style: italic;
}

/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    animation: fadeIn 0.3s ease;
}

.modal.active {
    display: flex;
    justify-content: center;
    align-items: center;
}

.modal-content {
    background: var(--surface);
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    width: 90%;
    max-width: 700px;
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from {
        transform: translateY(50px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid var(--border);
}

.modal-header h3 {
    margin: 0;
    font-size: 1.3em;
    color: var(--text);
}

.modal-close {
    font-size: 2em;
    color: var(--muted);
    cursor: pointer;
    line-height: 1;
    transition: color 0.2s ease;
}

.modal-close:hover {
    color: var(--text);
}

.modal-body {
    padding: 24px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--text);
    font-size: 0.95em;
}

.form-control {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid var(--border);
    border-radius: 8px;
    font-size: 1em;
    font-family: inherit;
    transition: border-color 0.2s ease;
}

.form-control:focus {
    outline: none;
    border-color: var(--primary-500);
    box-shadow: 0 0 0 3px var(--primary-100);
}

.modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    padding: 16px 24px;
    border-top: 1px solid var(--border);
}

.modal-btn {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-size: 0.95em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.modal-btn-cancel {
    background: var(--border);
    color: var(--text);
}

.modal-btn-cancel:hover {
    background: #ddd;
}

.modal-btn-confirm {
    background: var(--accent);
    color: #fff;
}

.modal-btn-confirm:hover {
    background: #0ea876;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(18, 184, 134, 0.3);
}

.add-date-btn {
    background: var(--primary-500);
    color: #fff;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 0.85em;
    cursor: pointer;
    transition: background 0.2s ease;
}

.add-date-btn:hover {
    background: var(--primary-600);
}

.date-row {
    display: grid;
    grid-template-columns: 2fr 1.5fr 1.5fr 80px;
    gap: 10px;
    align-items: end;
    margin-bottom: 10px;
    padding: 12px;
    background: var(--primary-50);
    border-radius: 8px;
    border: 1px solid var(--primary-200);
}

.date-row-field {
    display: flex;
    flex-direction: column;
}

.date-row-field label {
    font-size: 0.85em;
    margin-bottom: 4px;
    color: var(--text);
    font-weight: 500;
}

.date-row-field input {
    padding: 8px;
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 0.9em;
}

.remove-date-btn {
    background: #e74c3c;
    color: #fff;
    border: none;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.85em;
    transition: background 0.2s ease;
    height: 36px;
    min-width: 60px;
    white-space: nowrap;
}

.remove-date-btn:hover {
    background: #c0392b;
}

/* Print styles: show all sections */
@media print {
    body { background: #fff; }
    .home-section { display: none !important; }
    .content-section { display: block !important; box-shadow: none; border: none; padding: 0; }
    header { box-shadow: none; border: none; }
}



    </style>

</head>

<body>

    <div class="container">

        <header>

    <h1>SCM ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</h1>

    <p class="subtitle">ìƒì‚°ê³„íš ë° ê°œë°œ ì¼ì • ê´€ë¦¬</p>

</header>




        <div id="home" class="home-section">

    <h2>ğŸ“‹ ë³´ê³ ì„œ ëª©ì°¨</h2>

    <div class="button-grid">

        
        <div class="nav-button" onclick="showSection('dev-goals')">
            <h3>ê°œë°œ ëª©í‘œ</h3>
            <p>SCM ê°œë°œ ë¡œë“œë§µ</p>
        </div>

        <div class="nav-button" onclick="showSection('dev-status')">
            <h3>ê°œë°œ í˜„í™©</h3>
            <p>1ë‹¨ê³„ ê°œë°œ ì§„í–‰ ìƒí™©</p>
        </div>

        <div class="nav-button" onclick="showSection('extrusion-plan')">
            <h3>ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬</h3>
            <p>ìì¬ë³„ ìƒì‚° ê³„íš</p>
        </div>

    </div>

</div>




        
<div id="dev-goals" class="content-section">
    <h2>ê°œë°œ ëª©í‘œ</h2>
    
    <div class="highlight">
        <h3>0ë‹¨ê³„: ê¸°ì¡´ ìƒì‚°ê³„íš ì—…ë¬´ ë‹¨ì¶•</h3>
        <ol>
            <li><strong>ì£¼ê°„ ì••ì¶œê³„íš ì—…ì²´ ìš”êµ¬ì‚¬í•­ ì…ë ¥ RPA êµ¬ì¶•</strong>
                <ul>
                    <li>ì—…ì²´ë³„ ìš”êµ¬ì‚¬í•­ ìë™ ìˆ˜ì§‘ ë° ì…ë ¥ ì‹œìŠ¤í…œ ê°œë°œ</li>
                    <li>ë°ì´í„° ê²€ì¦ ë° ì˜ˆì™¸ì²˜ë¦¬ ë¡œì§ êµ¬í˜„</li>
                </ul>
            </li>
            <li><strong>SCM ë‹¨ë©´ë³„ ê³ ë¬´ ì‚¬ìš©ëŸ‰ ì‹¤ì œ ê°€ì¤‘ì¹˜ ì—…ë°ì´íŠ¸</strong>
                <ul>
                    <li>ì‹¤ì œ ìƒì‚° ë°ì´í„° ê¸°ë°˜ ê°€ì¤‘ì¹˜ ê³„ì‚°</li>
                    <li>ì£¼ê¸°ì  ë°ì´í„° ê°±ì‹  ìë™í™”</li>
                </ul>
            </li>
        </ol>
    </div>

    <div class="highlight" style="margin-top: 20px;">
        <h3>1ë‹¨ê³„: SCM ë§Œìœ¼ë¡œ ìƒì‚°ê³„íš ìˆ˜ë¦½</h3>
        <p style="margin-bottom: 15px;">ê¸°ì¡´ ì—‘ì…€ë¡œ ìˆ˜ë¦½í•˜ë˜ ì••ì¶œ ìƒì‚°ê³„íšì„ SCMì—ì„œ ëŒ€ì²´Â·ê³ ë„í™”í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.</p>
        
        <h4 style="margin-top: 20px; margin-bottom: 10px;">1) ì—‘ì…€ ê¸°ëŠ¥ êµ¬í˜„</h4>
        <ul style="margin-left: 20px; margin-bottom: 15px;">
            <li>ìì¬ë²ˆí˜¸ë³„ ì¬ê³  í˜„í™© í‘œì‹œ (1002/2000 ì°½ê³ )</li>
            <li>ë³´ìœ ì¼ìˆ˜ ê³„ì‚° (ë³´ìœ ì¼ìˆ˜ = ì¬ê³  / í•˜ë£¨ ì†Œìš”ëŸ‰)</li>
            <li>ì••ì¶œì‹œê°„ ê³„ì‚° ë° EA í™˜ì‚°</li>
            <li>ê¸ˆí˜• ê³µìš© ìì¬ í‘œì‹œ</li>
            <li>í•©ê³„/ìš”ì•½ ê¸°ëŠ¥</li>
                </ul>

        <h4 style="margin-top: 15px; margin-bottom: 10px;">2) POP ì—°ê³„</h4>
        <ul style="margin-left: 20px; margin-bottom: 15px;">
            <li>ê³„íš/ì‹¤ì  ìë™ êµ¬ë¶„</li>
            <li>ì£¼/ì•¼ê°„ ì‹¤ì  ì²˜ë¦¬</li>
            <li>ì‹¤ì  í™•ì • ê¸°ëŠ¥</li>
            <li>ì‹¤ì  ë°˜ì˜ ì—¬ë¶€ í‘œì‹œ</li>
                </ul>

        <h4 style="margin-top: 15px; margin-bottom: 10px;">3) ì—…ì²´ ìš”êµ¬ ìë™í™”</h4>
        <ul style="margin-left: 20px; margin-bottom: 15px;">
            <li>ì£¼/ì•¼ê°„ ìš”êµ¬ êµ¬ë¶„</li>
            <li>ìš”êµ¬ â†’ ê³„íš ìë™ ë°˜ì˜</li>
            <li>ì¶©ì¡± ì—¬ë¶€ í‘œì‹œ ë° ì§€ì—°/ì¡°ê¸° íŒë‹¨</li>
            <li>ì´ˆê³¼ ìƒì‚° ì‹œ ë‹¤ìŒ ì£¼ ì°¨ê°</li>
            <li>ìš”ì¼ ë‹¨ìœ„ ìš”êµ¬ ê´€ë¦¬ ë° ë¯¸ì™„ë£Œ ë‹¨ë©´ ê°•ì¡°</li>
        </ul>

        <h4 style="margin-top: 15px; margin-bottom: 10px;">4) UX ê°œì„ </h4>
        <ul style="margin-left: 20px; margin-bottom: 15px;">
            <li>ì»¬ëŸ¼ êµ¬ì¡° ë‹¨ìˆœí™”</li>
            <li>ìƒ‰ìƒÂ·ì•„ì´ì½˜ ê·œì¹™ ì •ë¦½</li>
            <li>ì¼ìë³„ í•©ê³„ í‘œì‹œ</li>
            <li>í•„í„°Â·ì •ë ¬ ê¸°ëŠ¥</li>
        </ul>

        <h4 style="margin-top: 15px; margin-bottom: 10px;">5) ìº˜ë¦°ë” ì—°ë™</h4>
        <ul style="margin-left: 20px; margin-bottom: 15px;">
            <li>ì••ì¶œìƒì‚°ê³„íšê³¼ ìº˜ë¦°ë” ì–‘ë°©í–¥ ë™ê¸°í™”</li>
            <li>ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ë‚ ì§œ/ì‹œê°„ëŒ€ ì´ë™</li>
            <li>ìˆ˜ëŸ‰ ë³€ê²½ ì‹œ ì‹¤ì‹œê°„ ë°˜ì˜</li>
        </ul>
    </div>

    <div class="highlight" style="margin-top: 20px;">
        <h3>2ë‹¨ê³„: ì•ˆì „ì¬ê³  ê¸°ë°˜ ìƒì‚°ê³„íš ìˆ˜ë¦½</h3>
        <ol>
            <li><strong>ë‹¨ë©´ë³„ ì•ˆì „ì¬ê³  ì„¤ì •</strong>
                <ul>
                    <li>ë‹¨ë©´ë³„ ìˆ˜ìš” ì˜ˆì¸¡ ëª¨ë¸ ê°œë°œ</li>
                    <li>ë¦¬ë“œíƒ€ì„ ë° ë³€ë™ì„± ë¶„ì„</li>
                    <li>ë™ì  ì•ˆì „ì¬ê³  ì‚°ì • ì•Œê³ ë¦¬ì¦˜</li>
                    <li>ì¬ê³  ë¶€ì¡± ì•Œë¦¼ ì‹œìŠ¤í…œ</li>
                </ul>
            </li>
        </ol>
    </div>

    <button class="back-button" onclick="showHome()">â† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°</button>
</div>


<div id="dev-status" class="content-section">
    <h2>ê°œë°œ í˜„í™©</h2>
    
    <div class="highlight" style="margin-top: 20px;">
        <h3>1ë‹¨ê³„: SCM ë§Œìœ¼ë¡œ ìƒì‚°ê³„íš ìˆ˜ë¦½</h3>
        <div id="stage1-content">
            <style>
            .requirement-section {
                margin: 30px 0;
            }
            .requirement-section h4 {
                color: var(--primary-600);
                margin: 25px 0 15px 0;
                font-size: 1.1em;
                border-bottom: 2px solid var(--primary-200);
                padding-bottom: 8px;
            }
            .requirement-section h5 {
                color: var(--text);
                margin: 20px 0 10px 0;
                font-size: 1em;
                font-weight: 600;
            }
            .requirement-section h5.toggleable-h5 {
                cursor: pointer;
                user-select: none;
                position: relative;
                padding-left: 20px;
            }
            .requirement-section h5.toggleable-h5:hover {
                color: var(--primary-500);
            }
            .toggle-icon-h5 {
                display: inline-block;
                position: absolute;
                left: 0;
                top: 50%;
                transform: translateY(-50%);
                transition: transform 0.2s;
                color: #666;
                font-size: 0.8em;
            }
            .requirement-section h5.toggleable-h5.expanded .toggle-icon-h5 {
                transform: translateY(-50%) rotate(90deg);
            }
            .toggleable-content {
                display: none;
                margin-left: 20px;
            }
            .toggleable-content.active {
                display: block;
            }
            .requirement-list {
                margin: 10px 0;
                padding-left: 0;
                list-style: none;
            }
            .requirement-list li {
                margin: 8px 0;
                line-height: 1.6;
                position: relative;
            }
            .requirement-list li.has-toggle {
                cursor: pointer;
            }
            .requirement-list li.has-toggle:hover {
                color: var(--primary-500);
            }
            .toggle-icon {
                display: inline-block;
                width: 6.6px;
                height: 6.6px;
                margin-right: 10px;
                vertical-align: middle;
                line-height: 1;
                position: relative;
                top: -0.18em;
                transition: transform 0.2s;
                color: #666;
                font-size: 6.6px;
            }
            .toggle-icon::before {
                content: 'â–¶';
                display: inline-block;
                font-size: 6.6px;
                line-height: 1;
            }
            .requirement-list li.has-toggle.expanded .toggle-icon {
                transform: rotate(90deg) translateY(0);
            }
            .requirement-list li.has-toggle .item-text {
                user-select: none;
            }
            .requirement-table {
                width: 100%;
                table-layout: fixed;
                border-collapse: collapse;
                margin: 20px 0;
                background: var(--surface);
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 1px 3px rgba(17, 17, 26, 0.04);
                border: 1px solid var(--border);
            }
            .requirement-table th {
                background: #fafbfc;
                color: var(--text);
                padding: 8px 16px;
                text-align: left;
                font-weight: 500;
                border-bottom: 1px solid var(--border);
                font-size: 0.9em;
            }
            .requirement-table td {
                padding: 8px 16px;
                border-top: 1px solid var(--border);
                vertical-align: middle;
                font-size: 0.9em;
            }
            .requirement-table tr:hover {
                background: #fafbfc;
            }
            .requirement-table.compact-table th,
            .requirement-table.compact-table td {
                padding: 7px 16px;
            }
            .status-select {
                padding: 4px 8px;
                border-radius: 4px;
                border: 1px solid var(--border);
                font-size: 0.85em;
                cursor: pointer;
                background: var(--surface);
                min-width: 90px;
            }
            .status-select.status-complete {
                background: #e8f5e9;
                color: #2e7d32;
                border-color: #a5d5a5;
            }
            .status-select.status-incomplete {
                background: #fff3e0;
                color: #e65100;
                border-color: #ffcc80;
            }
            .status-select.status-impossible {
                background: #fce4ec;
                color: #c2185b;
                border-color: #f48fb1;
            }
            .dev-status-select {
                padding: 4px 8px;
                border-radius: 4px;
                border: 1px solid var(--border);
                font-size: 0.85em;
                cursor: pointer;
                background: var(--surface);
                min-width: 90px;
                margin-left: 10px;
            }
            .dev-status-select.complete {
                background: #e8f5e9;
                color: #2e7d32;
                border-color: #a5d5a5;
            }
            .dev-status-select.incomplete {
                background: #fff3e0;
                color: #e65100;
                border-color: #ffcc80;
            }
            .dev-status-select.cancelled {
                background: #f5f5f5;
                color: #757575;
                border-color: #e0e0e0;
            }
            .dev-status-select.not-started {
                background: #f3e5f5;
                color: #7b1fa2;
                border-color: #ce93d8;
            }
            .requirement-image {
                max-width: 100%;
                margin: 15px 0;
                border-radius: 8px;
                box-shadow: 0 2px 8px rgba(17, 17, 26, 0.08);
                border: 1px solid var(--border);
            }
            .requirement-table-inline {
                width: 100%;
                border-collapse: collapse;
                margin: 15px 0;
                font-size: 0.85em;
            }
            .requirement-table-inline th,
            .requirement-table-inline td {
                padding: 8px 12px;
                border: 1px solid var(--border);
                text-align: left;
            }
            .requirement-table-inline th {
                background: #fafbfc;
                font-weight: 500;
            }
            .requirement-detail {
                margin: 20px 0;
                padding: 15px;
                background: #fafbfc;
                border-radius: 8px;
                border-left: 3px solid var(--primary-500);
            }
            .before-after-container {
                display: none;
                margin: 15px 0 15px 24px;
                padding: 15px;
                background: #fafbfc;
                border-radius: 8px;
                border: 1px solid var(--border);
            }
            .toggleable-content.active .before-after-container {
                display: block;
            }
            .before-after-container.active {
                display: block;
            }
            .image-comparison {
                display: flex;
                gap: 15px;
                margin-top: 10px;
            }
            .image-upload-section {
                flex: 1;
                display: flex;
                flex-direction: column;
            }
            .image-upload-section h6 {
                margin: 0 0 10px 0;
                font-size: 0.9em;
                font-weight: 600;
                color: var(--text);
            }
            .image-upload-area {
                position: relative;
                width: 100%;
                aspect-ratio: 4 / 3;
                border: 2px dashed var(--border);
                border-radius: 8px;
                background: white;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: default;
                overflow: hidden;
                transition: border-color 0.2s;
            }
            .image-upload-area:hover {
                border-color: var(--primary-500);
            }
            .image-upload-area.has-image {
                border: 2px solid var(--border);
                cursor: default;
            }
            .image-upload-area.has-image:hover {
                border-color: var(--border);
            }
            .image-upload-area img {
                width: 100%;
                height: 100%;
                object-fit: contain;
                cursor: pointer;
            }
            .image-upload-area .upload-placeholder {
                text-align: center;
                color: var(--text-secondary);
                font-size: 0.85em;
            }
            .image-upload-area .upload-placeholder small {
                display: block;
                margin-top: 5px;
                font-size: 0.75em;
                color: var(--muted);
            }
            .image-upload-area:focus {
                outline: none;
                border-color: #9b59b6;
                border-width: 2px;
            }
            .image-upload-area:focus.has-image {
                border-color: #9b59b6;
            }
            .upload-btn {
                padding: 4px 12px;
                background: var(--primary-500);
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 0.85em;
                transition: background 0.2s;
            }
            .upload-btn:hover {
                background: var(--primary-600);
            }
            .image-upload-area input[type="file"] {
                position: absolute;
                width: 1px;
                height: 1px;
                opacity: 0;
                pointer-events: none;
                overflow: hidden;
            }
            .image-modal {
                display: none;
                position: fixed;
                z-index: 10000;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.9);
                cursor: pointer;
            }
            .image-modal.active {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .image-modal img {
                max-width: 95%;
                max-height: 95%;
                width: auto;
                height: auto;
                object-fit: contain;
                cursor: default;
            }
            .image-modal .close-btn {
                position: absolute;
                top: 20px;
                right: 30px;
                color: white;
                font-size: 40px;
                font-weight: bold;
                cursor: pointer;
                z-index: 10001;
            }
            .image-modal .close-btn:hover {
                color: #ccc;
            }
            </style>

            <div class="requirement-section">
                <h4>1. ê³ ë¬´ì‚¬ìš© ê³„íš</h4>
                
                <h5 class="toggleable-h5" data-toggle-id="rubber-plan-loading">
                    <span class="toggle-icon-h5">â–¶</span>
                    1. ê³ ë¬´ ì‚¬ìš© ê³„íš
                    <select class="dev-status-select incomplete" onchange="updateDevStatus('rubber-plan-loading', this.value)" onclick="event.stopPropagation();">
                        <option value="cancelled">ê°œë°œ ì·¨ì†Œ</option>
                        <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                        <option value="complete">ì™„ë£Œ</option>
                    </select>
                </h5>
                <div class="toggleable-content" id="content-rubber-plan-loading">
                    <ul class="requirement-list">
                        <li>ê³ ë¬´ ì‚¬ìš©ê³„íš ë¡œë”© ì‹œê°„ ê°ì†Œ - í™•ì¸ ì‹œê°„ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë ¤ì„œ ë¶ˆí¸í•¨.</li>
                    </ul>
                    <div class="before-after-container" id="before-after-rubber-plan-loading">
                        <div class="image-comparison">
                            <div class="image-upload-section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h6 style="margin: 0;">AS IS</h6>
                                    <button class="upload-btn" onclick="triggerFileInput('file-as-is-rubber-plan-loading')">íŒŒì¼ ì„ íƒ</button>
                                </div>
                                <div class="image-upload-area" tabindex="0" id="upload-area-as-is-rubber-plan-loading">
                                    <input type="file" id="file-as-is-rubber-plan-loading" accept="image/*" onchange="handleImageUpload('rubber-plan-loading', 'as-is', this)">
                                    <div class="upload-placeholder" id="placeholder-as-is-rubber-plan-loading">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                                </div>
                            </div>
                            <div class="image-upload-section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h6 style="margin: 0;">TO BE</h6>
                                    <button class="upload-btn" onclick="triggerFileInput('file-to-be-rubber-plan-loading')">íŒŒì¼ ì„ íƒ</button>
                                </div>
                                <div class="image-upload-area" tabindex="0" id="upload-area-to-be-rubber-plan-loading">
                                    <input type="file" id="file-to-be-rubber-plan-loading" accept="image/*" onchange="handleImageUpload('rubber-plan-loading', 'to-be', this)">
                                    <div class="upload-placeholder" id="placeholder-to-be-rubber-plan-loading">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <h5 class="toggleable-h5" data-toggle-id="rubber-list-change">
                    <span class="toggle-icon-h5">â–¶</span>
                    2. ê³ ë¬´ ì„ ì • ë¦¬ìŠ¤íŠ¸ ë³€ê²½
                    <select class="dev-status-select incomplete" onchange="updateDevStatus('rubber-list-change', this.value)" onclick="event.stopPropagation();">
                        <option value="cancelled">ê°œë°œ ì·¨ì†Œ</option>
                        <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                        <option value="complete">ì™„ë£Œ</option>
                    </select>
                </h5>
                <div class="toggleable-content" id="content-rubber-list-change">
                    <ul class="requirement-list">
                        <li>ì‚¬ìš© ì•ˆ í•˜ëŠ” ê³ ë¬´ê°€ ë„ˆë¬´ ë§ìŒ.</li>
                        <li>ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ê³ ë¬´ê°€ ë¹ ì ¸ ìˆìŒ.</li>
                        <li>í•˜ê¸° í‘œì˜ ê³ ë¬´ ê¸°ì¤€ìœ¼ë¡œ ë“±ë¡ ìš”ì²­</li>
                    </ul>
                    
                    <table class="requirement-table compact-table" style="font-size: 0.8415em;">
                    <thead>
                        <tr>
                            <th style="width: 60px;">No.</th>
                            <th style="width: 120px;">ìì¬ë²ˆí˜¸</th>
                            <th style="width: 280px;">ë°°í•©ë²ˆí˜¸</th>
                            <th>ë“±ë¡ ì•½ì–´</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td>46006016</td><td>5226SO</td><td>5226SO</td></tr>
                        <tr><td>2</td><td>46006020</td><td>5824LS</td><td>5824LS</td></tr>
                        <tr><td>3</td><td>46007006</td><td>5823LL</td><td>5823LL</td></tr>
                        <tr><td>4</td><td>46008005</td><td>5835</td><td>5835</td></tr>
                        <tr><td>5</td><td>46002597</td><td>5833</td><td>5833</td></tr>
                        <tr><td>6</td><td>46006011</td><td>5834</td><td>5834</td></tr>
                        <tr><td>7</td><td>46006013</td><td>5223LS</td><td>5223LS</td></tr>
                        <tr><td>8</td><td>46006037</td><td>5224S</td><td>5224S</td></tr>
                        <tr><td>9</td><td>46006041</td><td>5225LS</td><td>5225LS</td></tr>
                        <tr><td>10</td><td>46006087</td><td>5830SK</td><td>5830SK</td></tr>
                        <tr><td>11</td><td>3006024</td><td>ë¯¸ì„¸ë°œí¬ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5830S</td><td>5830S</td></tr>
                        <tr><td>12</td><td>3006025</td><td>ê³ ê²½ë„ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5916S</td><td>5916S</td></tr>
                        <tr><td>13</td><td>3006170</td><td>ì••ì¶œìš© ê³ ê²½ë„ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5912S</td><td>5912S</td></tr>
                        <tr><td>14</td><td>3006410</td><td>G/Run í˜•ìƒ ìœ ì§€ìš© í˜¼ë ¨ ê³ ë¬´ / 5701S</td><td>5701S</td></tr>
                    </tbody>
                </table>
                </div>

                <h5 class="toggleable-h5" data-toggle-id="rubber-inventory-hoist">
                    <span class="toggle-icon-h5">â–¶</span>
                    3. ê³ ë¬´ë³„ ì•„ì¹¨ ì¬ê³  ë° í˜¸ê¸° ì¶”ê°€ (ê³ ë¬´ ì¢…ë¥˜ ì‚­ì œ)
                    <select class="dev-status-select incomplete" onchange="updateDevStatus('rubber-inventory-hoist', this.value)" onclick="event.stopPropagation();">
                        <option value="cancelled">ê°œë°œ ì·¨ì†Œ</option>
                        <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                        <option value="complete">ì™„ë£Œ</option>
                    </select>
                </h5>
                <div class="toggleable-content" id="content-rubber-inventory-hoist">
                    <h6 style="margin-top: 0; margin-bottom: 10px; font-size: 1em;">ì•„ì¹¨ ì¬ê³ </h6>
                    <ul class="requirement-list" style="margin-bottom: 15px; list-style: disc; padding-left: 20px;">
                        <li>í˜¼ë ¨ ë‹´ë‹¹ì ë“±ë¡ ì˜ˆì •</li>
                        <li>ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ or ê°’ ë³µì‚¬ ë¶™ì—¬ë„£ê¸° í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ êµ¬í˜„</li>
                    </ul>
                    <div style="position: relative; margin: 20px 0;">
                        <div style="position: absolute; top: 0; right: 0; z-index: 10; margin-bottom: 10px;">
                            <button id="toggle-rubber-inventory-summary" class="upload-btn" onclick="toggleRubberInventorySummary()" style="background: var(--primary-500);">í•©ê³„ë§Œ ë³´ê¸°</button>
                        </div>
                        <div style="overflow-x: auto; margin-top: 40px;">
                    <table id="rubber-inventory-table" class="requirement-table compact-table" style="min-width: 800px; font-size: 0.8415em; table-layout: fixed;">
                        <thead>
                            <tr>
                                <th style="width: 60px;">No.</th>
                                <th style="width: 120px;">ìì¬ë²ˆí˜¸</th>
                                <th style="width: 280px;">ë°°í•©ë²ˆí˜¸</th>
                                <th>ë“±ë¡ ì•½ì–´</th>
                                <th style="width: 120px;">ì•„ì¹¨ ì¬ê³ </th>
                                <th style="width: 120px;">ì‚¬ìš©ì²˜</th>
                                <th style="width: 120px;">12.18(ëª©)<br>ì£¼</th>
                                <th style="width: 120px;">12.18(ëª©)<br>ì•¼</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>1</td><td>46006016</td><td>5226SO</td><td>5226SO</td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>8</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>11</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>12</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>1</td><td>46006016</td><td>5226SO</td><td>5226SO</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>2</td><td>46006020</td><td>5824LS</td><td>5824LS</td><td></td><td>1</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>5</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>6</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>7</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>8</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>9</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>11</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>12</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>2</td><td>46006020</td><td>5824LS</td><td>5824LS</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>3</td><td>46007006</td><td>5823LL</td><td>5823LL</td><td></td><td>1</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>5</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>6</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>7</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>8</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>9</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>11</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>12</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>3</td><td>46007006</td><td>5823LL</td><td>5823LL</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>4</td><td>46008005</td><td>5835</td><td>5835</td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>9</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>12</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>4</td><td>46008005</td><td>5835</td><td>5835</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>5</td><td>46002597</td><td>5833</td><td>5833</td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>8</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>5</td><td>46002597</td><td>5833</td><td>5833</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>6</td><td>46006011</td><td>5834</td><td>5834</td><td></td><td>6</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>6</td><td>46006011</td><td>5834</td><td>5834</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>7</td><td>46006013</td><td>5223LS</td><td>5223LS</td><td></td><td>2</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>3</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>5</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>6</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>8</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>11</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>7</td><td>46006013</td><td>5223LS</td><td>5223LS</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>8</td><td>46006037</td><td>5224S</td><td>5224S</td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>5</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>8</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>8</td><td>46006037</td><td>5224S</td><td>5224S</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>9</td><td>46006041</td><td>5225LS</td><td>5225LS</td><td></td><td>3</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>5</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>6</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>9</td><td>46006041</td><td>5225LS</td><td>5225LS</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>10</td><td>46006087</td><td>5830SK</td><td>5830SK</td><td></td><td>3</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>5</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>6</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>8</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>10</td><td>46006087</td><td>5830SK</td><td>5830SK</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>11</td><td>3006024</td><td>ë¯¸ì„¸ë°œí¬ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5830S</td><td>5830S</td><td></td><td>3</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>11</td><td>3006024</td><td>ë¯¸ì„¸ë°œí¬ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5830S</td><td>5830S</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr style="background-color: #fff3cd;"><td>12</td><td>3006024</td><td>ë¯¸ì„¸ë°œí¬ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5830S</td><td>5830S M6</td><td></td><td>5</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" data-row-number="12" style="background-color: #fff3cd;"><td>12</td><td>3006024</td><td>ë¯¸ì„¸ë°œí¬ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5830S</td><td>5830S M6</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>13</td><td>3006025</td><td>ê³ ê²½ë„ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5916S</td><td>5916S</td><td></td><td>12</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>13</td><td>3006025</td><td>ê³ ê²½ë„ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5916S</td><td>5916S</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>14</td><td>3006170</td><td>ì••ì¶œìš© ê³ ê²½ë„ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5912S</td><td>5912S</td><td></td><td>4</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>8</td><td></td><td></td><td></td></tr>
                            <tr><td></td><td></td><td></td><td></td><td></td><td>11</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>14</td><td>3006170</td><td>ì••ì¶œìš© ê³ ê²½ë„ ì†”ë¦¬ë“œ í˜¼ë ¨ê³ ë¬´ / 5912S</td><td>5912S</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                            <tr><td>15</td><td>3006410</td><td>G/Run í˜•ìƒ ìœ ì§€ìš© í˜¼ë ¨ ê³ ë¬´ / 5701S</td><td>5701S</td><td></td><td>7</td><td></td><td></td><td></td></tr>
                            <tr class="summary-row" style="background-color: #e8e8e8;"><td>15</td><td>3006410</td><td>G/Run í˜•ìƒ ìœ ì§€ìš© í˜¼ë ¨ ê³ ë¬´ / 5701S</td><td>5701S</td><td></td><td>í•©ê³„</td><td></td><td></td><td></td></tr>
                        </tbody>
                    </table>
                        </div>
                    </div>
                    <div class="before-after-container" id="before-after-rubber-inventory-hoist">
                        <div class="image-comparison">
                            <div class="image-upload-section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h6 style="margin: 0;">AS IS</h6>
                                    <button class="upload-btn" onclick="triggerFileInput('file-as-is-rubber-inventory-hoist')">íŒŒì¼ ì„ íƒ</button>
                                </div>
                                <div class="image-upload-area" tabindex="0" id="upload-area-as-is-rubber-inventory-hoist">
                                    <input type="file" id="file-as-is-rubber-inventory-hoist" accept="image/*" onchange="handleImageUpload('rubber-inventory-hoist', 'as-is', this)">
                                    <div class="upload-placeholder" id="placeholder-as-is-rubber-inventory-hoist">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                                </div>
                            </div>
                            <div class="image-upload-section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h6 style="margin: 0;">TO BE</h6>
                                    <button class="upload-btn" onclick="triggerFileInput('file-to-be-rubber-inventory-hoist')">íŒŒì¼ ì„ íƒ</button>
                                </div>
                                <div class="image-upload-area" tabindex="0" id="upload-area-to-be-rubber-inventory-hoist">
                                    <input type="file" id="file-to-be-rubber-inventory-hoist" accept="image/*" onchange="handleImageUpload('rubber-inventory-hoist', 'to-be', this)">
                                    <div class="upload-placeholder" id="placeholder-to-be-rubber-inventory-hoist">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="requirement-section">
                <h4>2. ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬</h4>
                
                <h5>ì—´ ì‚­ì œ</h5>
                <ul class="requirement-list">
                    <li>OEM/AS/ETC ì—´ ì‚­ì œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-delete-oem', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>í’ˆëª©ë²ˆí˜¸ ì—´ ì‚­ì œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-delete-item', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì‘ì—…ê³„íš - ì£¼ê°„/ì•¼ê°„ ì—´ ì‚­ì œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-delete-work-plan', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì••ì¶œì‹œê°„ - ì£¼ê°„/ì•¼ê°„ ì—´ ì‚­ì œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-delete-extrusion-time', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì¼ìˆ˜ - ì£¼ê°„/ì•¼ê°„ ì—´ ì‚­ì œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-delete-days', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>í† ìš”ì¼ ì—´ ì‚­ì œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-delete-saturday', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                </ul>

                <h5>ì—´ ì¶”ê°€</h5>
                <ul class="requirement-list">
                    <li>ê³ ë¬´ ì¢…ë¥˜ ì—´ 3ê°œ ì¶”ê°€ - í˜¸ê¸°ë³„ë¡œ ë‹¤ë¥´ê²Œ ì„¤ì • ê°€ëŠ¥í•œì§€ í™•ì¸ í•„ìš”
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-add-rubber-type', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì½”íŒ… ì¢…ë¥˜ ì—´ 2ê°œ ì¶”ê°€
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-add-coating-type', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì¬ê³ ë³´ìœ ì¼ ì—´ ì¶”ê°€
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-add-inventory-days', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                        <ul style="margin-top: 5px;">
                            <li>ì¬ê³ ë³´ìœ ì¼ = í•©ê³„ ì¬ê³ /ì†Œìš”ëŸ‰</li>
                            <li>ì†Œìš”ëŸ‰ = D2 5ì¼ í‰ê·  (ë¯¸ì •)</li>
                        </ul>
                    </li>
                    <li>ì••ì¶œìˆ˜ëŸ‰ ì£¼ê°„ ì˜† ì••ì¶œ ì‹œê°„ ì¶”ê°€
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-add-daytime-time', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì••ì¶œìˆ˜ëŸ‰ ì•¼ê°„ ì˜† ì••ì¶œ ì‹œê°„ ì¶”ê°€
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-column-add-nighttime-time', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                </ul>

                <h5>ê¸°ëŠ¥ ì¶”ê°€</h5>
                <ul class="requirement-list">
                    <li>ì••ì¶œê¸ˆí˜•(êµ¬ê¸ˆ) ê³µìš© ìì¬ í‘œì‹œ ê¸°ëŠ¥ ì¶”ê°€
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-feature-add-shared-material', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                </ul>

                <h5>ì‹œìŠ¤í…œ ì¬ê³ </h5>
                <ul class="requirement-list">
                    <li>DRB â†’ 1002ë²ˆ ì°½ê³  ì¬ê³  ì‹¤ì‹œê°„ í‘œì‹œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-system-inventory-drb', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>SCM â†’ í˜„ë¬¼ ì¬ê³ ì¡°ì‚¬ ë“±ë¡ê°’ í‘œì‹œ, SCM ì´ë¦„ í˜„ë¬¼ ì¬ê³ ì¡°ì‚¬ë¡œ ë³€ê²½
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-system-inventory-scm', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>í˜‘ë ¥ì‚¬ â†’ 2000ë²ˆ ì°½ê³  ì¬ê³  ì‹¤ì‹œê°„ í‘œì‹œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-system-inventory-partner', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>í•©ê³„ = DRB + í˜‘ë ¥ì‚¬
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-system-inventory-total', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                </ul>

                <h5>ì••ì¶œ ìˆ˜ëŸ‰</h5>
                <ul class="requirement-list">
                    <li>ì••ì¶œ ì‹œê°„ í•©ê³„ ìƒì‹œ í‘œì‹œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-quantity-time-total', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                        <ul class="requirement-list" style="margin-top: 10px; margin-left: 20px;">
                            <li>ì••ì¶œ ì‹œê°„ = [ì••ì¶œìˆ˜ëŸ‰ (M ê¸°ì¤€) / ì••ì¶œì†ë„] / 60</li>
                        </ul>
                        <div class="before-after-container" id="before-after-extrusion-quantity-time-total">
                            <div class="image-comparison">
                                <div class="image-upload-section">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <h6 style="margin: 0;">AS IS</h6>
                                        <button class="upload-btn" onclick="triggerFileInput('file-as-is-extrusion-quantity-time-total')">íŒŒì¼ ì„ íƒ</button>
                                    </div>
                                    <div class="image-upload-area" tabindex="0" id="upload-area-as-is-extrusion-quantity-time-total">
                                        <input type="file" id="file-as-is-extrusion-quantity-time-total" accept="image/*" onchange="handleImageUpload('extrusion-quantity-time-total', 'as-is', this)">
                                        <div class="upload-placeholder" id="placeholder-as-is-extrusion-quantity-time-total">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                                    </div>
                                </div>
                                <div class="image-upload-section">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <h6 style="margin: 0;">TO BE</h6>
                                        <button class="upload-btn" onclick="triggerFileInput('file-to-be-extrusion-quantity-time-total')">íŒŒì¼ ì„ íƒ</button>
                                    </div>
                                    <div class="image-upload-area" tabindex="0" id="upload-area-to-be-extrusion-quantity-time-total">
                                        <input type="file" id="file-to-be-extrusion-quantity-time-total" accept="image/*" onchange="handleImageUpload('extrusion-quantity-time-total', 'to-be', this)">
                                        <div class="upload-placeholder" id="placeholder-to-be-extrusion-quantity-time-total">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>POPì—ì„œ ì‹¤ì œ ì‘ì—…ëŸ‰ ë¶ˆëŸ¬ì˜¤ê¸° ê¸°ëŠ¥ í•„ìš” (ìˆ˜ìš”ì¼ ì•„ì¹¨ 8ì‹œ 30ë¶„ ê¸°ì¤€ - ì›”/í™” ë®ì–´ì“°ê¸°)
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-quantity-pop-loading', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>í™•ì • ë²„íŠ¼ ì…ë ¥ ì‹œ ì‹¤ì  ë°˜ì˜ í•„ìš”.
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-quantity-confirm-reflection', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì‹¤ì  ë°˜ì˜ ì—¬ë¶€ í‘œì‹œ ê¸°ëŠ¥ í•„ìš”
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-quantity-reflection-display', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                </ul>

                <h5>ì—…ì²´ ìš”êµ¬</h5>
                <ul class="requirement-list">
                    <li>ì”ëŸ‰ 1ì£¼ ê¸°ì¤€ í‘œì‹œ
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-company-demand-balance', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                        <ul style="margin-top: 5px;">
                            <li>ì”ëŸ‰ = ì—…ì²´ìš”êµ¬(ì›”~ê¸ˆ) - ì••ì¶œ ìˆ˜ëŸ‰(ì›”~ê¸ˆ)</li>
                            <li>if ì”ëŸ‰ < 0, ì°¨ì£¼ ì²« ì—…ì²´ìš”êµ¬ì—ì„œ í•´ë‹¹ ê°’ ë§Œí¼ ë¹¼ê¸° ë°˜ì˜í•˜ëŠ” ê¸°ëŠ¥ (ë¹¼ê¸° ì „ ê°’ í™•ì¸ ê°€ëŠ¥í•´ì•¼ í•¨)</li>
                        </ul>
                    </li>
                    <li>ì—…ì²´ ìš”êµ¬ì¼ ì¼ë³„ë¡œ ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²´í¬í•˜ëŠ” ë¡œì§ ì¶”ê°€
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-company-demand-daily-check', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ë¯¸ì™„ë£Œë‹¨ë©´ ê°•ì¡°í•˜ëŠ” ê¸°ëŠ¥ í•„ìš”
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-company-demand-incomplete-highlight', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>IF ë‹¨ë©´ ìƒì‚°ëŸ‰ > ì—…ì²´ìš”êµ¬ìˆ˜ëŸ‰, ë‹¤ìŒ ì—…ì²´ ìš”êµ¬ ìˆ˜ëŸ‰ì—ì„œ ì°¨ì´ë¶„ë§Œí¼ ê°ì†Œ (ì¡°ê¸° ìƒì‚° í‘œì‹œ í•„ìš”)
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-company-demand-early-production', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì—…ì²´ ìš”êµ¬ ì£¼/ì•¼ë¡œ êµ¬ë¶„ ìš”ì²­
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-company-demand-daynight', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì—…ì²´ ìš”êµ¬ â†’ ì••ì¶œ ìˆ˜ëŸ‰ì´ë™ í™•ì • ê¸°ëŠ¥ ì¶”ê°€ (ì´ë™ ì´í›„ ë‹´ë‹¹ìì— ì˜í•´ ì‘ì—… ì¬ë°°ë¶„ ì˜ˆì •)
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-company-demand-move-confirm', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì›”/í™” ê²€ìƒ‰ ì‹œ ì—…ì²´ìš”êµ¬ ê¸ˆì£¼ ì›”~ê¸ˆ ì…€ ë‚˜ì˜¤ë„ë¡
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-company-demand-mon-tue-search', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ìˆ˜/ëª©/ê¸ˆ ê²€ìƒ‰ ì‹œ ì—…ì²´ìš”êµ¬ ì´ë²ˆì£¼ + ì°¨ì£¼ ì›”~ê¸ˆê¹Œì§€ ì…€ ë‚˜ì˜¤ë„ë¡
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-company-demand-wed-thu-fri-search', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                </ul>

                <h5>ìƒì‚°ê³„íš</h5>
                <ul class="requirement-list">
                    <li>ì œëª©í–‰ ì˜¤ë¦„ì°¨ìˆœ/ë‚´ë¦¼ì°¨ìˆœ ê¸°ëŠ¥ ì¶”ê°€
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-production-plan-sort', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                </ul>

                <h5>ë””ìì¸ ë³€ê²½</h5>
                <ul class="requirement-list">
                    <li>ì—…ì²´ìš”êµ¬ ìˆ˜ëŸ‰ ìˆì„ ì‹œ ì…€ ë°˜ì˜ ìƒ‰ í™€/ì§ êµ¬ë¶„ ìƒ‰ ìš”ì²­ (ë™ì¼ìƒ‰ìƒìœ¼ë¡œ í‘œì‹œë˜ì–´ ì…€ êµ¬ë¶„ í˜ë“¦)
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-design-change-cell-color', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>ì…€ ê°„ ë„ˆë¹„ ëŠ˜ë¦¼.
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-design-change-cell-width', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                    <li>34ì¸ì¹˜ ëª¨ë‹ˆí„°ì— í•˜ë‹¨ ë¶€ ì§¤ë¦¼ ë°œìƒ.
                        <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-design-change-monitor-cutoff', this.value)" style="margin-left: 10px;">
                            <option value="not-started">ë¯¸ê°œë°œ</option>
                            <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                            <option value="complete">ì™„ë£Œ</option>
                        </select>
                    </li>
                </ul>

                <h5 class="toggleable-h5" data-toggle-id="calendar-integration">
                    <span class="toggle-icon-h5">â–¶</span>
                    ìº˜ë¦°ë” ì—°ë™
                </h5>
                <div class="toggleable-content" id="content-calendar-integration">
                    <ul class="requirement-list">
                        <li>ì••ì¶œìƒì‚°ê³„íšê³¼ ìº˜ë¦°ë” ì–‘ë°©í–¥ ë™ê¸°í™”
                            <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-calendar-sync-bidirectional', this.value)" style="margin-left: 10px;">
                                <option value="not-started">ë¯¸ê°œë°œ</option>
                                <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                                <option value="complete">ì™„ë£Œ</option>
                            </select>
                        </li>
                        <li>ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ë‚ ì§œ/ì‹œê°„ëŒ€ ì´ë™
                            <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-calendar-sync-dragdrop', this.value)" style="margin-left: 10px;">
                                <option value="not-started">ë¯¸ê°œë°œ</option>
                                <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                                <option value="complete">ì™„ë£Œ</option>
                            </select>
                        </li>
                        <li>ìº˜ë¦°ë”/ì••ì¶œìƒì‚°ê³„íš ì••ì¶œ ìˆ˜ëŸ‰ ë³€ê²½ ì‹œ ì‹¤ì‹œê°„ ë°˜ì˜
                            <select class="dev-status-select incomplete" onchange="updateDevStatus('extrusion-calendar-sync-realtime', this.value)" style="margin-left: 10px;">
                                <option value="not-started">ë¯¸ê°œë°œ</option>
                                <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
                                <option value="complete">ì™„ë£Œ</option>
                            </select>
                        </li>
                    </ul>
                    <div class="before-after-container" id="before-after-extrusion-calendar-sync-realtime">
                        <div class="image-comparison">
                            <div class="image-upload-section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h6 style="margin: 0;">AS IS</h6>
                                    <button class="upload-btn" onclick="triggerFileInput('file-as-is-extrusion-calendar-sync-realtime')">íŒŒì¼ ì„ íƒ</button>
                                </div>
                                <div class="image-upload-area" tabindex="0" id="upload-area-as-is-extrusion-calendar-sync-realtime">
                                    <input type="file" id="file-as-is-extrusion-calendar-sync-realtime" accept="image/*" onchange="handleImageUpload('extrusion-calendar-sync-realtime', 'as-is', this)">
                                    <div class="upload-placeholder" id="placeholder-as-is-extrusion-calendar-sync-realtime">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                                </div>
                            </div>
                            <div class="image-upload-section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h6 style="margin: 0;">TO BE</h6>
                                    <button class="upload-btn" onclick="triggerFileInput('file-to-be-extrusion-calendar-sync-realtime')">íŒŒì¼ ì„ íƒ</button>
                                </div>
                                <div class="image-upload-area" tabindex="0" id="upload-area-to-be-extrusion-calendar-sync-realtime">
                                    <input type="file" id="file-to-be-extrusion-calendar-sync-realtime" accept="image/*" onchange="handleImageUpload('extrusion-calendar-sync-realtime', 'to-be', this)">
                                    <div class="upload-placeholder" id="placeholder-to-be-extrusion-calendar-sync-realtime">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="back-button" onclick="showHome()">â† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°</button>
</div>


<div id="weekly-plan" class="content-section">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="margin: 0;">ì£¼ê°„ ìƒì‚°ê³„íš</h2>
        <button class="week-nav-btn" onclick="openDevModal()" style="background: var(--accent);">+ ê°œë°œ ì¶”ê°€</button>
    </div>
    <div style="margin-bottom: 20px;">
        <h3 style="margin: 0; color: var(--text);">2024ë…„ 12ì›” 1ì£¼ì°¨ (12/1 ~ 12/5)</h3>
    </div>
    <div class="production-table-container">
        <table id="production-table" class="production-table">
            <thead>
                <tr>
                    <th rowspan="2" class="machine-header">êµ¬ë¶„</th>
                    <th colspan="2">12/1<br>ì›”</th>
                    <th colspan="2">12/2<br>í™”</th>
                    <th colspan="2">12/3<br>ìˆ˜</th>
                    <th colspan="2">12/4<br>ëª©</th>
                    <th colspan="2">12/5<br>ê¸ˆ</th>
                </tr>
                <tr>
                    <th class="shift-header day-shift">ì£¼</th>
                    <th class="shift-header night-shift">ì•¼</th>
                    <th class="shift-header day-shift">ì£¼</th>
                    <th class="shift-header night-shift">ì•¼</th>
                    <th class="shift-header day-shift">ì£¼</th>
                    <th class="shift-header night-shift">ì•¼</th>
                    <th class="shift-header day-shift">ì£¼</th>
                    <th class="shift-header night-shift">ì•¼</th>
                    <th class="shift-header day-shift">ì£¼</th>
                    <th class="shift-header night-shift">ì•¼</th>
                </tr>
            </thead>
            <tbody id="production-tbody">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ë‚´ìš© -->
            </tbody>
        </table>
    </div>
    <button class="back-button" onclick="showHome()">â† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°</button>
</div>


<!-- ì‹œì‘ì‹œê°„ ì„¤ì • ëª¨ë‹¬ -->
<div id="start-time-modal" class="modal">
    <div class="modal-content" style="max-width: 400px;">
        <div class="modal-header">
            <h3>ì‹œì‘ ì‹œê°„ ì„¤ì •</h3>
            <span class="modal-close" onclick="closeStartTimeModal()">&times;</span>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label>ê°œë°œ ì •ë³´</label>
                <div id="dev-info-display" style="padding: 10px; background: var(--primary-50); border-radius: 8px; margin-bottom: 15px;">
                </div>
            </div>
            <div class="form-group">
                <label>ì‹œì‘ ì‹œê°„</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="number" id="set-start-hour" class="form-control" placeholder="08" min="0" max="23" style="width: 80px; text-align: center;">
                    <span style="font-weight: bold; font-size: 1.2em;">:</span>
                    <input type="number" id="set-start-minute" class="form-control" placeholder="30" min="0" max="59" step="5" style="width: 80px; text-align: center;">
                </div>
                <small style="color: var(--muted);">ì‹œì‘ ì‹œê°„ì„ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ì¢…ë£Œ ì‹œê°„ì´ ê³„ì‚°ë©ë‹ˆë‹¤.</small>
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn modal-btn-cancel" onclick="closeStartTimeModal()">ì·¨ì†Œ</button>
            <button class="modal-btn modal-btn-confirm" onclick="confirmStartTime()">í™•ì¸</button>
        </div>
    </div>
</div>

<!-- ì¤‘ì‹ëŒ€ì‘ ì¶”ê°€ ëª¨ë‹¬ -->
<div id="lunch-break-modal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
        <div class="modal-header">
            <h3>ì¤‘ì‹ëŒ€ì‘ ì¶”ê°€</h3>
            <span class="modal-close" onclick="closeLunchBreakModal()">&times;</span>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label>ì‘ì—…ì¥ (ìµœëŒ€ 3ê°œ ì„ íƒ ê°€ëŠ¥)</label>
                <div id="lunch-workplace-checkboxes" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 10px;">
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#01" style="cursor: pointer;">
                        <span>1í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#02" style="cursor: pointer;">
                        <span>2í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#03" style="cursor: pointer;">
                        <span>3í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#04" style="cursor: pointer;">
                        <span>4í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#05" style="cursor: pointer;">
                        <span>5í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#06" style="cursor: pointer;">
                        <span>6í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#07" style="cursor: pointer;">
                        <span>7í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#08" style="cursor: pointer;">
                        <span>8í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#09" style="cursor: pointer;">
                        <span>9í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#10" style="cursor: pointer;">
                        <span>10í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#11" style="cursor: pointer;">
                        <span>11í˜¸</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" class="lunch-workplace-checkbox" value="ì••ì¶œ#12" style="cursor: pointer;">
                        <span>12í˜¸</span>
                    </label>
                </div>
                <small style="color: var(--muted); display: block; margin-top: 5px;">ìµœëŒ€ 3ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.</small>
            </div>
            <div class="form-group">
                <label for="lunch-date">ë‚ ì§œ</label>
                <select id="lunch-date" class="form-control">
                    <option value="12/1">12/1 (ì›”)</option>
                    <option value="12/2">12/2 (í™”)</option>
                    <option value="12/3">12/3 (ìˆ˜)</option>
                    <option value="12/4">12/4 (ëª©)</option>
                    <option value="12/5">12/5 (ê¸ˆ)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="lunch-shift">êµëŒ€</label>
                <select id="lunch-shift" class="form-control">
                    <option value="day">ì£¼ê°„</option>
                    <option value="night">ì•¼ê°„</option>
                </select>
            </div>
            <div class="form-group">
                <label for="lunch-type">ì¤‘ì‹ëŒ€ì‘ ìœ í˜•</label>
                <select id="lunch-type" class="form-control">
                    <option value="ì¤‘ì‹ëŒ€ì‘">ì¤‘ì‹ëŒ€ì‘</option>
                    <option value="ì¤‘ì‹ëŒ€ì‘ í›„ ê³„ì†">ì¤‘ì‹ëŒ€ì‘ í›„ ê³„ì†</option>
                </select>
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn modal-btn-cancel" onclick="closeLunchBreakModal()">ì·¨ì†Œ</button>
            <button class="modal-btn modal-btn-confirm" onclick="addLunchBreakItem()">ì¶”ê°€</button>
        </div>
    </div>
</div>

<!-- ê°œë°œ ì¶”ê°€ ëª¨ë‹¬ -->
<div id="dev-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ê°œë°œ ì‘ì—… ì¶”ê°€</h3>
            <span class="modal-close" onclick="closeDevModal()">&times;</span>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="dev-machine">í˜¸ê¸°</label>
                <select id="dev-machine" class="form-control">
                    <option value="1í˜¸">1í˜¸</option>
                    <option value="2í˜¸">2í˜¸</option>
                    <option value="3í˜¸">3í˜¸</option>
                    <option value="4í˜¸">4í˜¸</option>
                    <option value="5í˜¸">5í˜¸</option>
                    <option value="6í˜¸">6í˜¸</option>
                    <option value="7í˜¸">7í˜¸</option>
                    <option value="8í˜¸">8í˜¸</option>
                    <option value="9í˜¸">9í˜¸</option>
                    <option value="10í˜¸">10í˜¸</option>
                    <option value="11í˜¸">11í˜¸</option>
                    <option value="12í˜¸">12í˜¸</option>
                </select>
            </div>
            <div class="form-group">
                <label for="dev-section">ê°œë°œ ë‹¨ë©´</label>
                <input type="text" id="dev-section" class="form-control" placeholder="ì˜ˆ: JW1m">
            </div>
            <div class="form-group">
                <label style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ê°œë°œ ë‚ ì§œ ë° ì‹œê°„</span>
                    <button type="button" class="add-date-btn" onclick="addDateRow()">+ ë‚ ì§œ ì¶”ê°€</button>
                </label>
                <div id="date-rows-container">
                    <!-- ë‚ ì§œ í–‰ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë¨ -->
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn modal-btn-cancel" onclick="closeDevModal()">ì·¨ì†Œ</button>
            <button class="modal-btn modal-btn-confirm" onclick="addDevWork()">ì¶”ê°€</button>
        </div>
    </div>
</div>

<!-- ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜ -->
<div id="extrusion-plan" class="content-section">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="margin: 0;">ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬</h2>
    </div>
    
    <!-- ê²€ìƒ‰/í•„í„° ì˜ì—­ -->
    <div style="background: var(--surface); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid var(--border);">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 15px;">
            <div class="form-group" style="margin: 0;">
                <label style="font-size: 0.9em; margin-bottom: 5px; display: block;">ìì¬ë²ˆí˜¸</label>
                <input type="text" id="extrusion-material-num" class="form-control" placeholder="ìì¬ë²ˆí˜¸" style="padding: 8px;">
            </div>
            <div class="form-group" style="margin: 0;">
                <label style="font-size: 0.9em; margin-bottom: 5px; display: block;">í’ˆëª©ë²ˆí˜¸</label>
                <input type="text" id="extrusion-item-num" class="form-control" placeholder="í’ˆëª©ë²ˆí˜¸" style="padding: 8px;">
            </div>
            <div class="form-group" style="margin: 0;">
                <label style="font-size: 0.9em; margin-bottom: 5px; display: block;">ì°¨ì¢…</label>
                <input type="text" id="extrusion-vehicle-type" class="form-control" placeholder="ì°¨ì¢…" style="padding: 8px;">
            </div>
            <div class="form-group" style="margin: 0;">
                <label style="font-size: 0.9em; margin-bottom: 5px; display: block;">ì‘ì—…ì¥</label>
                <select id="extrusion-workplace-filter" class="form-control" style="padding: 8px;">
                    <option value="ì „ì²´">ì „ì²´</option>
                    <option value="ì••ì¶œ#01">ì••ì¶œ#01</option>
                    <option value="ì••ì¶œ#02">ì••ì¶œ#02</option>
                    <option value="ì••ì¶œ#03">ì••ì¶œ#03</option>
                    <option value="ì••ì¶œ#04">ì••ì¶œ#04</option>
                    <option value="ì••ì¶œ#05">ì••ì¶œ#05</option>
                    <option value="ì••ì¶œ#06">ì••ì¶œ#06</option>
                    <option value="ì••ì¶œ#07">ì••ì¶œ#07</option>
                    <option value="ì••ì¶œ#08">ì••ì¶œ#08</option>
                    <option value="ì••ì¶œ#09">ì••ì¶œ#09</option>
                    <option value="ì••ì¶œ#10">ì••ì¶œ#10</option>
                    <option value="ì••ì¶œ#11">ì••ì¶œ#11</option>
                    <option value="ì••ì¶œ#12">ì••ì¶œ#12</option>
                </select>
            </div>
            <div class="form-group" style="margin: 0;">
                <label style="font-size: 0.9em; margin-bottom: 5px; display: block;">ì—…ì²´</label>
                <select id="extrusion-company-filter" class="form-control" style="padding: 8px;">
                    <option value="ì „ì²´">ì „ì²´</option>
                </select>
            </div>
        </div>
        <div style="display: flex; gap: 10px; align-items: center;">
            <button onclick="searchExtrusionPlan()" class="modal-btn modal-btn-confirm" style="padding: 10px 20px;">Q ì¡°íšŒ</button>
            <button class="modal-btn" style="padding: 10px 20px; background: var(--success);">ì—‘ì…€ë‹¤ìš´ë¡œë“œ</button>
        </div>
    </div>
    
    <!-- í…Œì´ë¸” ì˜ì—­ -->
    <div id="extrusion-plan-main-table-container" style="overflow-x: auto; margin-bottom: 20px; display: none;">
        <table id="extrusion-plan-table" style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
            <thead>
                <tr style="background: var(--primary); color: white;">
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: center; position: sticky; left: 0; background: var(--primary); z-index: 10;">No.</th>
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: center; position: sticky; left: 35px; background: var(--primary); z-index: 10;">êµ¬ë¶„</th>
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: center; position: sticky; left: 100px; background: var(--primary); z-index: 10;">
                        ì‘ì—…ì¥
                        <span class="sort-icon" onclick="sortExtrusionTable('workplace')" style="cursor: pointer; margin-left: 5px;">â‡…</span>
                    </th>
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: center;">
                        ì°¨ì¢…
                        <span class="sort-icon" onclick="sortExtrusionTable('vehicleType')" style="cursor: pointer; margin-left: 5px;">â‡…</span>
                    </th>
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: center;">
                        ìì¬ë²ˆí˜¸
                        <span class="sort-icon" onclick="sortExtrusionTable('materialNum')" style="cursor: pointer; margin-left: 5px;">â‡…</span>
                    </th>
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: left;">
                        ìì¬ë‚´ì—­
                        <span class="sort-icon" onclick="sortExtrusionTable('materialDetail')" style="cursor: pointer; margin-left: 5px;">â‡…</span>
                    </th>
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: center;">í’ˆëª©ë²ˆí˜¸</th>
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: center;">ì—…ì²´ëª…</th>
                    <th rowspan="3" style="padding: 10px; border: 1px solid var(--border); text-align: center;">ë‹¨ìœ„</th>
                    <th colspan="10" style="padding: 10px; border: 1px solid var(--border); text-align: center;">ì••ì¶œìˆ˜ëŸ‰</th>
                </tr>
                <tr style="background: var(--primary); color: white;">
                    <th colspan="2" style="padding: 8px; border: 1px solid var(--border); text-align: center;">12.01(ì›”)</th>
                    <th colspan="2" style="padding: 8px; border: 1px solid var(--border); text-align: center;">12.02(í™”)</th>
                    <th colspan="2" style="padding: 8px; border: 1px solid var(--border); text-align: center;">12.03(ìˆ˜)</th>
                    <th colspan="2" style="padding: 8px; border: 1px solid var(--border); text-align: center;">12.04(ëª©)</th>
                    <th colspan="2" style="padding: 8px; border: 1px solid var(--border); text-align: center;">12.05(ê¸ˆ)</th>
                </tr>
                <tr style="background: var(--primary); color: white;">
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì£¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì•¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì£¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì•¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì£¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì•¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì£¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì•¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì£¼ê°„</th>
                    <th style="padding: 8px; border: 1px solid var(--border); text-align: center;">ì•¼ê°„</th>
                </tr>
            </thead>
            <tbody id="extrusion-plan-tbody">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ë‚´ìš© -->
            </tbody>
        </table>
    </div>
    
    <!-- ì£¼ê°„ ìƒì‚°ê³„íš í…Œì´ë¸” -->
    <div id="extrusion-plan-weekly-table-container" style="margin-top: 30px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="margin: 0;">ì£¼ê°„ ìƒì‚°ê³„íš</h3>
            <div style="display: flex; gap: 10px;">
                <button class="week-nav-btn" onclick="openExtrusionLunchBreakModal()" style="background: #e74c3c;">+ ì¤‘ì‹ëŒ€ì‘ ì¶”ê°€</button>
                <button class="week-nav-btn" onclick="openExtrusionDevModal()" style="background: var(--accent);">+ ê°œë°œ ì¶”ê°€</button>
            </div>
        </div>
        <div class="production-table-container">
            <table class="production-table">
                <thead>
                    <tr>
                        <th class="machine-header">êµ¬ë¶„</th>
                        <th colspan="2" class="month-header">12/1<br>ì›”</th>
                        <th colspan="2" class="month-header">12/2<br>í™”</th>
                        <th colspan="2" class="month-header">12/3<br>ìˆ˜</th>
                        <th colspan="2" class="month-header">12/4<br>ëª©</th>
                        <th colspan="2" class="month-header">12/5<br>ê¸ˆ</th>
                    </tr>
                    <tr>
                        <th class="machine-header"></th>
                        <th class="shift-header day-shift">ì£¼</th>
                        <th class="shift-header night-shift">ì•¼</th>
                        <th class="shift-header day-shift">ì£¼</th>
                        <th class="shift-header night-shift">ì•¼</th>
                        <th class="shift-header day-shift">ì£¼</th>
                        <th class="shift-header night-shift">ì•¼</th>
                        <th class="shift-header day-shift">ì£¼</th>
                        <th class="shift-header night-shift">ì•¼</th>
                        <th class="shift-header day-shift">ì£¼</th>
                        <th class="shift-header night-shift">ì•¼</th>
                    </tr>
                </thead>
                <tbody id="extrusion-plan-production-tbody">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ë‚´ìš© -->
                </tbody>
            </table>
        </div>
    </div>
    
    <button class="back-button" onclick="showHome()">â† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°</button>
</div>

<div id="segments" class="content-section">
    <h2>ìš”ì²­ì‚¬í•­</h2>
    
    <style>
    .requirement-table {
        width: 100%;
        table-layout: fixed;
        border-collapse: collapse;
        margin: 20px 0;
        background: var(--surface);
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(17, 17, 26, 0.04);
        border: 1px solid var(--border);
    }
    .requirement-table th {
        background: #fafbfc;
        color: var(--text);
        padding: 8px 16px;
        text-align: left;
        font-weight: 500;
        border-bottom: 1px solid var(--border);
        font-size: 0.9em;
    }
    .requirement-table td {
        padding: 8px 16px;
        border-top: 1px solid var(--border);
        vertical-align: top;
        font-size: 0.9em;
    }
    .requirement-table tr:hover {
        background: #fafbfc;
    }
    .requirement-table.compact-table th,
    .requirement-table.compact-table td {
        padding: 7px 16px;
    }
    .status-select {
        padding: 4px 8px;
        border-radius: 4px;
        border: 1px solid var(--border);
        font-size: 0.85em;
        cursor: pointer;
        background: var(--surface);
        min-width: 90px;
    }
    .status-select.status-complete {
        background: #e8f5e9;
        color: #2e7d32;
        border-color: #a5d5a5;
    }
    .status-select.status-incomplete {
        background: #fff3e0;
        color: #e65100;
        border-color: #ffcc80;
    }
    .status-select.status-impossible {
        background: #fce4ec;
        color: #c2185b;
        border-color: #f48fb1;
    }
    .requirement-image {
        max-width: 100%;
        margin: 15px 0;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(17, 17, 26, 0.08);
        border: 1px solid var(--border);
    }
    .requirement-table-inline {
        width: 100%;
        border-collapse: collapse;
        margin: 15px 0;
        font-size: 0.85em;
    }
    .requirement-table-inline th,
    .requirement-table-inline td {
        padding: 8px 12px;
        border: 1px solid var(--border);
        text-align: left;
    }
    .requirement-table-inline th {
        background: #fafbfc;
        font-weight: 500;
    }
    .requirement-detail {
        margin: 20px 0;
        padding: 15px;
        background: #fafbfc;
        border-radius: 8px;
        border-left: 3px solid var(--primary-500);
    }
    </style>
    
<table class="requirement-table">
  <thead>
    <tr>
      <th style="width: 50px;">No.</th>
      <th style="width: 200px;">ìš”ì²­ì‚¬í•­</th>
      <th>ìƒì„¸ ë‚´ìš©</th>
      <th style="width: 120px;">ìƒíƒœ</th>
      <th style="width: 100px;">ìš”ì²­ì¼</th>
      <th style="width: 100px;">ì™„ë£Œì¼</th>
      <th style="width: 150px;">ì°¸ê³  íŒŒì¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬<br>ë ˆì´ì•„ì›ƒ ìˆ˜ì •</td>
      <td>
        <div class="requirement-detail">
          <strong>ì—…ì²´ê°€ ìš”êµ¬í•œ ìì¬ í–‰ì„ ì ¤ ìœ„ë¡œ ì˜¬ë¦¬ëŠ” ê¸°ëŠ¥ ì¶”ê°€</strong>
          <br><br>
          <p style="color: var(--muted); font-size: 0.9em; margin-top: 10px;">â€» ì´ë¯¸ì§€ëŠ” PDF íŒŒì¼ ì°¸ì¡°</p>
        </div>
      </td>
      <td>
        <select class="status-select status-complete" onchange="updateRequirementStatus(1, this.value)">
          <option value="complete" selected>ì™„ë£Œ</option>
          <option value="incomplete">ë¯¸ì™„ë£Œ</option>
          <option value="impossible">ê°œë°œë¶ˆê°€</option>
        </select>
      </td>
      <td>10/2</td>
      <td>10/2</td>
      <td>SCM ìš”ì²­ì‚¬í•­ ì •ë¦¬.pdf</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬<br>ë ˆì´ì•„ì›ƒ ìˆ˜ì •</td>
      <td>
        <div class="requirement-detail">
          <strong>ì—…ì²´ê°€ ìš”êµ¬í•œ ìì¬ í–‰ì˜ ì…€ ìƒ‰ ë³€ê²½ ê¸°ëŠ¥ ì¶”ê°€</strong>
          <br><br>
          <p style="color: var(--muted); font-size: 0.9em; margin-top: 10px;">â€» ì´ë¯¸ì§€ëŠ” PDF íŒŒì¼ ì°¸ì¡°</p>
        </div>
      </td>
      <td>
        <select class="status-select status-complete" onchange="updateRequirementStatus(2, this.value)">
          <option value="complete" selected>ì™„ë£Œ</option>
          <option value="incomplete">ë¯¸ì™„ë£Œ</option>
          <option value="impossible">ê°œë°œë¶ˆê°€</option>
        </select>
      </td>
      <td>10/2</td>
      <td>10/2</td>
      <td>SCM ìš”ì²­ì‚¬í•­ ì •ë¦¬.pdf</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬<br>ë ˆì´ì•„ì›ƒ ìˆ˜ì •</td>
      <td>
        <div class="requirement-detail">
          <strong>ì‘ì—…ëŸ‰ ì…ë ¥ ì‹œ ì£¼ê°„/ì•¼ê°„ ê°ê° ì´ ì••ì¶œ ì‹œê°„ ê³„ì‚°ì‹ ì¶”ê°€ (1í–‰ì— ë‚˜ì˜¤ë„ë¡)</strong>
          <br><br>
          <table class="requirement-table-inline">
            <thead>
              <tr>
                <th>êµ¬ë¶„</th>
                <th>ì£¼ê°„</th>
                <th>ì•¼ê°„</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>ì´ ì••ì¶œ ì‹œê°„</td>
                <td>ê³„ì‚°ì‹ í‘œì‹œ</td>
                <td>ê³„ì‚°ì‹ í‘œì‹œ</td>
              </tr>
            </tbody>
          </table>
        </div>
      </td>
      <td>
        <select class="status-select status-complete" onchange="updateRequirementStatus(3, this.value)">
          <option value="complete" selected>ì™„ë£Œ</option>
          <option value="incomplete">ë¯¸ì™„ë£Œ</option>
          <option value="impossible">ê°œë°œë¶ˆê°€</option>
        </select>
      </td>
      <td>10/2</td>
      <td>10/16</td>
      <td>SCM ìš”ì²­ì‚¬í•­ ì •ë¦¬.pdf</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬<br>ë ˆì´ì•„ì›ƒ ìˆ˜ì •</td>
      <td>
        <div class="requirement-detail">
          <strong>ì—‘ì…€ê³¼ ë™ì¼í•˜ê²Œ ë¶ˆí•„ìš”í•œ ì—´ ìˆ¨ê¹€ ê¸°ëŠ¥ ì¶”ê°€</strong>
        </div>
      </td>
      <td>
        <select class="status-select status-impossible" onchange="updateRequirementStatus(4, this.value)">
          <option value="complete">ì™„ë£Œ</option>
          <option value="incomplete">ë¯¸ì™„ë£Œ</option>
          <option value="impossible" selected>ê°œë°œë¶ˆê°€</option>
        </select>
      </td>
      <td>10/2</td>
      <td></td>
      <td>SCM ìš”ì²­ì‚¬í•­ ì •ë¦¬.pdf</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬<br>ë°ì´í„° ê²€ì¦</td>
      <td>
        <div class="requirement-detail">
          <strong>ìŠ¤í™ ë° ì••ì¶œì†ë„ ë°ì´í„° ê²€ì¦ í•„ìš” (ì˜ëª»ëœ ë°ì´í„°ë¥¼ ì‚¬ìš© ì¤‘ìœ¼ë¡œ ì¶”ì¸¡)</strong>
        </div>
      </td>
      <td>
        <select class="status-select status-incomplete" onchange="updateRequirementStatus(5, this.value)">
          <option value="complete">ì™„ë£Œ</option>
          <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
          <option value="impossible">ê°œë°œë¶ˆê°€</option>
        </select>
      </td>
      <td>10/2</td>
      <td></td>
      <td>SCM ìš”ì²­ì‚¬í•­ ì •ë¦¬.pdf</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬<br>ì¬ê³  ì •ë³´</td>
      <td>
        <div class="requirement-detail">
          <strong>í˜‘ë ¥ì‚¬ ì¬ê³ ì— SCM ì¬ê³ ì™€ SAP ì¬ê³ ë¥¼ ë‘˜ ë‹¤ ë³¼ ìˆ˜ ìˆë„ë¡ ë³€ê²½ ìš”ì²­</strong>
        </div>
      </td>
      <td>
        <select class="status-select status-incomplete" onchange="updateRequirementStatus(6, this.value)">
          <option value="complete">ì™„ë£Œ</option>
          <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
          <option value="impossible">ê°œë°œë¶ˆê°€</option>
        </select>
      </td>
      <td>10/2</td>
      <td></td>
      <td>SCM ìš”ì²­ì‚¬í•­ ì •ë¦¬.pdf</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ë³µìˆ˜ ìì¬ ì¡°íšŒ<br>ê¸°ëŠ¥ ì¶”ê°€</td>
      <td>
        <div class="requirement-detail">
          <strong>SAPì™€ ë™ì¼í•˜ê²Œ ë³µìˆ˜ ìì¬ ì—…ë¡œë“œ í›„ ì¡°íšŒ ê¸°ëŠ¥ êµ¬í˜„</strong>
        </div>
      </td>
      <td>
        <select class="status-select status-impossible" onchange="updateRequirementStatus(7, this.value)">
          <option value="complete">ì™„ë£Œ</option>
          <option value="incomplete">ë¯¸ì™„ë£Œ</option>
          <option value="impossible" selected>ê°œë°œë¶ˆê°€</option>
        </select>
      </td>
      <td>10/2</td>
      <td></td>
      <td>SCM ìš”ì²­ì‚¬í•­ ì •ë¦¬.pdf</td>
    </tr>
    <tr>
      <td>8</td>
      <td>ë¬¼ë¥˜ì •ë³´ ì˜ì—…ì°½ê³ <br>ë°ì´í„° ì ê²€</td>
      <td>
        <div class="requirement-detail">
          <strong>ê°’ì´ - ë¡œ ë‚˜ì˜¤ëŠ” ì˜¤ë¥˜ê°€ ìˆìŒ</strong>
        </div>
      </td>
      <td>
        <select class="status-select status-incomplete" onchange="updateRequirementStatus(8, this.value)">
          <option value="complete">ì™„ë£Œ</option>
          <option value="incomplete" selected>ë¯¸ì™„ë£Œ</option>
          <option value="impossible">ê°œë°œë¶ˆê°€</option>
        </select>
      </td>
      <td>10/2</td>
      <td></td>
      <td>SCM ìš”ì²­ì‚¬í•­ ì •ë¦¬.pdf</td>
    </tr>
  </tbody>
</table>

<script>
function updateRequirementStatus(reqId, status) {
    const select = event.target;
    select.className = 'status-select status-' + status;
    
    // localStorageì— ìƒíƒœ ì €ì¥
    const requirementStatuses = JSON.parse(localStorage.getItem('requirementStatuses') || '{}');
    requirementStatuses[reqId] = status;
    localStorage.setItem('requirementStatuses', JSON.stringify(requirementStatuses));
}

function updateDevStatus(devId, status) {
    const select = event.target;
    select.className = 'dev-status-select ' + status;
    
    // localStorageì— ìƒíƒœ ì €ì¥
    const devStatuses = JSON.parse(localStorage.getItem('devStatuses') || '{}');
    devStatuses[devId] = status;
    localStorage.setItem('devStatuses', JSON.stringify(devStatuses));
}

// BEFORE/AFTER í† ê¸€ í•¨ìˆ˜
function toggleBeforeAfter(devId) {
    const container = document.getElementById('before-after-' + devId);
    const li = container?.closest('li');
    if (container && li) {
        const isActive = container.classList.toggle('active');
        li.classList.toggle('expanded', isActive);
        // ì´ë¯¸ì§€ ë³µì›
        if (isActive) {
            restoreImages(devId);
        }
    }
}

// ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
function handleImageUpload(devId, type, input) {
    const file = input.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const imageUrl = e.target.result;
            displayImage(devId, type, imageUrl);
            saveImage(devId, type, imageUrl);
        };
        reader.readAsDataURL(file);
    }
}

// í´ë¦½ë³´ë“œì—ì„œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸° ì²˜ë¦¬
function handlePasteImage(devId, type, event) {
    event.preventDefault();
    const items = event.clipboardData.items;
    
    for (let i = 0; i < items.length; i++) {
        if (items[i].type.indexOf('image') !== -1) {
            const blob = items[i].getAsFile();
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageUrl = e.target.result;
                displayImage(devId, type, imageUrl);
                saveImage(devId, type, imageUrl);
            };
            reader.readAsDataURL(blob);
            break;
        }
    }
}

// íŒŒì¼ ì…ë ¥ íŠ¸ë¦¬ê±° (ë¦°í„° ì˜¤ë¥˜ ë°©ì§€ìš©)
function triggerFileInput(fileId) {
    const input = document.getElementById(fileId);
    if (input) input.click();
}

// ì´ë¯¸ì§€ ì‚­ì œ
function deleteImage(devId, type) {
    const fileInput = document.getElementById(`file-${type}-${devId}`);
    if (!fileInput) return;
    
    const uploadArea = fileInput.parentElement;
    const placeholder = document.getElementById(`placeholder-${type}-${devId}`);
    const existingImg = uploadArea.querySelector('img');
    
    if (existingImg) {
        existingImg.remove();
    }
    
    // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
    fileInput.value = '';
    
    // localStorageì—ì„œ ì´ë¯¸ì§€ ì œê±°
    const images = JSON.parse(localStorage.getItem('devImages') || '{}');
    if (images[devId] && images[devId][type]) {
        delete images[devId][type];
        localStorage.setItem('devImages', JSON.stringify(images));
    }
    
    // embedded ë³€ìˆ˜ì—ì„œë„ ì œê±°
    if (typeof embeddedDevImages !== 'undefined' && embeddedDevImages[devId] && embeddedDevImages[devId][type]) {
        delete embeddedDevImages[devId][type];
        updateEmbeddedImagesInHTML();
    }
    
    uploadArea.classList.remove('has-image');
    if (placeholder) {
        placeholder.style.display = 'block';
    }
}

// ì´ë¯¸ì§€ í‘œì‹œ
function displayImage(devId, type, imageUrl) {
    const fileInput = document.getElementById(`file-${type}-${devId}`);
    if (!fileInput) return;
    
    const uploadArea = fileInput.parentElement;
    const placeholder = document.getElementById(`placeholder-${type}-${devId}`);
    
    // ê¸°ì¡´ ì´ë¯¸ì§€ ì œê±°
    const existingImg = uploadArea.querySelector('img');
    if (existingImg) {
        existingImg.remove();
    }
    
    // ìƒˆ ì´ë¯¸ì§€ ì¶”ê°€
    const img = document.createElement('img');
    img.src = imageUrl;
    img.style.cursor = 'pointer';
    // ë‹¨ì¼ í´ë¦­ì€ í¬ì»¤ìŠ¤ë¥¼ ì£¼ê¸°ë§Œ í•¨ (uploadAreaì˜ í´ë¦­ ì´ë²¤íŠ¸ê°€ ì²˜ë¦¬)
    img.onclick = function(e) {
        e.stopPropagation();
        // í¬ì»¤ìŠ¤ë¥¼ uploadAreaì— ì£¼ê¸°
        uploadArea.focus();
    };
    // ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ - ì´ë¯¸ì§€ í™•ëŒ€
    img.ondblclick = function(e) {
        e.stopPropagation();
        e.preventDefault();
        showImageModal(imageUrl);
    };
    // ìš°í´ë¦­ ì´ë²¤íŠ¸ - ì´ë¯¸ì§€ ì‚­ì œ
    img.oncontextmenu = function(e) {
        e.preventDefault();
        e.stopPropagation();
        if (confirm('ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            deleteImage(devId, type);
        }
        return false;
    };
    uploadArea.appendChild(img);
    uploadArea.classList.add('has-image');
    if (placeholder) {
        placeholder.style.display = 'none';
    }
}

// í˜ì´ì§€ì— í‘œì‹œëœ ëª¨ë“  ê¸°ì¡´ ì´ë¯¸ì§€ë¥¼ Base64ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
function saveAllExistingImages() {
    try {
        // localStorageì—ì„œ ëª¨ë“  ì´ë¯¸ì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const storedImages = JSON.parse(localStorage.getItem('devImages') || '{}');
        
        // embeddedDevImagesì—ì„œë„ ê°€ì ¸ì˜¤ê¸° (HTML íŒŒì¼ ë‚´ë¶€ ë°ì´í„°)
        let embeddedImages = {};
        if (typeof embeddedDevImages !== 'undefined' && embeddedDevImages && Object.keys(embeddedDevImages).length > 0) {
            embeddedImages = embeddedDevImages;
        }
        
        // ë‘ ì†ŒìŠ¤ë¥¼ ë³‘í•© (embeddedê°€ ìš°ì„ )
        const allImages = { ...storedImages, ...embeddedImages };
        
        // ëª¨ë“  file input ìš”ì†Œ ì°¾ê¸° (file-as-is-* ë˜ëŠ” file-to-be-*)
        const fileInputs = document.querySelectorAll('input[id^="file-as-is-"], input[id^="file-to-be-"]');
        
        let savedCount = 0;
        const promises = [];
        const processedKeys = new Set(); // ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€
        
        // 1. localStorageì˜ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ embeddedDevImagesì— ë¬´ì¡°ê±´ ë³µì‚¬
        // localStorageì— ì €ì¥ëœ ëª¨ë“  ì´ë¯¸ì§€ëŠ” embeddedDevImagesì—ë„ í¬í•¨ë˜ì–´ì•¼ í•¨
        Object.keys(storedImages).forEach(devId => {
            if (storedImages[devId]) {
                // embeddedDevImages ë³€ìˆ˜ ì´ˆê¸°í™”
                if (typeof embeddedDevImages === 'undefined') {
                    embeddedDevImages = {};
                }
                if (!embeddedDevImages[devId]) {
                    embeddedDevImages[devId] = {};
                }
                
                // as-is ì´ë¯¸ì§€ ì²˜ë¦¬
                if (storedImages[devId]['as-is']) {
                    const key = `${devId}-as-is`;
                    if (!processedKeys.has(key)) {
                        processedKeys.add(key);
                        const base64 = storedImages[devId]['as-is'];
                        // ì´ë¯¸ Base64ì¸ì§€ í™•ì¸
                        if (base64.startsWith('data:image/')) {
                            // ë¬´ì¡°ê±´ embeddedDevImagesì— ë³µì‚¬ (ë®ì–´ì“°ê¸°)
                            embeddedDevImages[devId]['as-is'] = base64;
                            savedCount++;
                        }
                    }
                }
                
                // to-be ì´ë¯¸ì§€ ì²˜ë¦¬
                if (storedImages[devId]['to-be']) {
                    const key = `${devId}-to-be`;
                    if (!processedKeys.has(key)) {
                        processedKeys.add(key);
                        const base64 = storedImages[devId]['to-be'];
                        // ì´ë¯¸ Base64ì¸ì§€ í™•ì¸
                        if (base64.startsWith('data:image/')) {
                            // ë¬´ì¡°ê±´ embeddedDevImagesì— ë³µì‚¬ (ë®ì–´ì“°ê¸°)
                            embeddedDevImages[devId]['to-be'] = base64;
                            savedCount++;
                        }
                    }
                }
            }
        });
        
        // embeddedDevImagesì˜ ì´ë¯¸ì§€ë„ í™•ì¸ (HTML íŒŒì¼ì— ì´ë¯¸ í¬í•¨ëœ ì´ë¯¸ì§€)
        Object.keys(embeddedImages).forEach(devId => {
            if (embeddedImages[devId]) {
                if (!embeddedDevImages[devId]) {
                    embeddedDevImages[devId] = {};
                }
                
                // as-is ì´ë¯¸ì§€ ì²˜ë¦¬
                if (embeddedImages[devId]['as-is']) {
                    const key = `${devId}-as-is`;
                    if (!processedKeys.has(key)) {
                        processedKeys.add(key);
                        const base64 = embeddedImages[devId]['as-is'];
                        if (base64.startsWith('data:image/')) {
                            embeddedDevImages[devId]['as-is'] = base64;
                            savedCount++;
                        }
                    }
                }
                
                // to-be ì´ë¯¸ì§€ ì²˜ë¦¬
                if (embeddedImages[devId]['to-be']) {
                    const key = `${devId}-to-be`;
                    if (!processedKeys.has(key)) {
                        processedKeys.add(key);
                        const base64 = embeddedImages[devId]['to-be'];
                        if (base64.startsWith('data:image/')) {
                            embeddedDevImages[devId]['to-be'] = base64;
                            savedCount++;
                        }
                    }
                }
            }
        });
        
        // 2. DOMì— í‘œì‹œëœ ì´ë¯¸ì§€ë“¤ë„ í™•ì¸ (Blob URLì´ë‚˜ ì™¸ë¶€ URLì¸ ê²½ìš° ë³€í™˜)
        fileInputs.forEach(fileInput => {
            const id = fileInput.id;
            // devIdì™€ type ì¶”ì¶œ
            let devId, type;
            if (id.startsWith('file-as-is-')) {
                devId = id.replace('file-as-is-', '');
                type = 'as-is';
            } else if (id.startsWith('file-to-be-')) {
                devId = id.replace('file-to-be-', '');
                type = 'to-be';
            } else {
                return; // íŒ¨í„´ì— ë§ì§€ ì•Šìœ¼ë©´ ê±´ë„ˆë›°ê¸°
            }
            
            const key = `${devId}-${type}`;
            if (processedKeys.has(key)) {
                return; // ì´ë¯¸ ì²˜ë¦¬í–ˆìœ¼ë©´ ê±´ë„ˆë›°ê¸°
            }
            
            // ë¶€ëª¨ ìš”ì†Œì—ì„œ img íƒœê·¸ ì°¾ê¸°
            const uploadArea = fileInput.parentElement;
            if (!uploadArea) return;
            
            const img = uploadArea.querySelector('img');
            if (!img || !img.src) return;
            
            // ì´ë¯¸ì§€ ë³€í™˜ Promise ìƒì„±
            let imagePromise;
            
            // ì´ë¯¸ Base64 ë°ì´í„°ì¸ì§€ í™•ì¸
            if (img.src.startsWith('data:image/')) {
                // ì´ë¯¸ Base64ì´ë©´ ê·¸ëŒ€ë¡œ ì €ì¥
                imagePromise = Promise.resolve(img.src).then(base64 => {
                    if (typeof embeddedDevImages === 'undefined' || 
                        !embeddedDevImages[devId] || 
                        !embeddedDevImages[devId][type] ||
                        embeddedDevImages[devId][type] !== base64) {
                        saveImage(devId, type, base64);
                        savedCount++;
                        return true;
                    }
                    return false;
                });
            } else if (img.src.startsWith('blob:')) {
                // Blob URLì¸ ê²½ìš° Base64ë¡œ ë³€í™˜
                imagePromise = fetch(img.src)
                    .then(response => {
                        if (!response.ok) throw new Error('Fetch failed');
                        return response.blob();
                    })
                    .then(blob => {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onloadend = () => resolve(reader.result);
                            reader.onerror = reject;
                            reader.readAsDataURL(blob);
                        });
                    })
                    .then(base64 => {
                        if (typeof embeddedDevImages === 'undefined' || 
                            !embeddedDevImages[devId] || 
                            !embeddedDevImages[devId][type] ||
                            embeddedDevImages[devId][type] !== base64) {
                            saveImage(devId, type, base64);
                            savedCount++;
                            return true;
                        }
                        return false;
                    })
                    .catch(err => {
                        console.warn(`ì´ë¯¸ì§€ ë³€í™˜ ì‹¤íŒ¨ (${devId}, ${type}):`, err);
                        return false;
                    });
            } else if (img.src.startsWith('http://') || img.src.startsWith('https://')) {
                // ì™¸ë¶€ URLì¸ ê²½ìš° Base64ë¡œ ë³€í™˜ (CORS ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìŒ)
                imagePromise = fetch(img.src)
                    .then(response => {
                        if (!response.ok) throw new Error('Fetch failed');
                        return response.blob();
                    })
                    .then(blob => {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onloadend = () => resolve(reader.result);
                            reader.onerror = reject;
                            reader.readAsDataURL(blob);
                        });
                    })
                    .then(base64 => {
                        if (typeof embeddedDevImages === 'undefined' || 
                            !embeddedDevImages[devId] || 
                            !embeddedDevImages[devId][type] ||
                            embeddedDevImages[devId][type] !== base64) {
                            saveImage(devId, type, base64);
                            savedCount++;
                            return true;
                        }
                        return false;
                    })
                    .catch(err => {
                        console.warn(`ì´ë¯¸ì§€ ë³€í™˜ ì‹¤íŒ¨ (${devId}, ${type}):`, err);
                        return false;
                    });
            } else {
                // ì²˜ë¦¬í•  ìˆ˜ ì—†ëŠ” ì´ë¯¸ì§€ íƒ€ì…
                return;
            }
            
            if (imagePromise) {
                promises.push(imagePromise);
            }
        });
        
        // ëª¨ë“  ì´ë¯¸ì§€ ì²˜ë¦¬ ì™„ë£Œ í›„ ìµœì¢… ì €ì¥
        Promise.all(promises).then(() => {
            if (savedCount > 0) {
                console.log(`ê¸°ì¡´ ì´ë¯¸ì§€ ${savedCount}ê°œê°€ localStorageì™€ embeddedDevImagesì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                console.log('ì´ë¯¸ì§€ëŠ” localStorageì— ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œë„ ì´ë¯¸ì§€ë¥¼ ë³´ë ¤ë©´ HTML íŒŒì¼ì— ì´ë¯¸ì§€ë¥¼ í¬í•¨ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.');
                console.log('HTML íŒŒì¼ì— ì´ë¯¸ì§€ë¥¼ í¬í•¨ì‹œí‚¤ë ¤ë©´ ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ saveHTMLWithImages() í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.');
            } else {
                console.log('ì €ì¥í•  ìƒˆë¡œìš´ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.');
            }
            // ìë™ ë‹¤ìš´ë¡œë“œëŠ” í•˜ì§€ ì•ŠìŒ
        }).catch(error => {
            console.error('ì´ë¯¸ì§€ ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
        });
    } catch (error) {
        console.error('ê¸°ì¡´ ì´ë¯¸ì§€ ì €ì¥ ì¤‘ ì˜¤ë¥˜:', error);
    }
}

// ì´ë¯¸ì§€ ì €ì¥
function saveImage(devId, type, imageUrl) {
    // localStorageì— ì €ì¥
    const images = JSON.parse(localStorage.getItem('devImages') || '{}');
    if (!images[devId]) {
        images[devId] = {};
    }
    images[devId][type] = imageUrl;
    localStorage.setItem('devImages', JSON.stringify(images));
    
    // HTML íŒŒì¼ ë‚´ë¶€ embedded ë³€ìˆ˜ì—ë„ ì €ì¥ (íŒŒì¼ì„ ì˜®ê²¨ë„ ì´ë¯¸ì§€ ìœ ì§€)
    if (typeof embeddedDevImages === 'undefined') {
        embeddedDevImages = {};
    }
    if (!embeddedDevImages[devId]) {
        embeddedDevImages[devId] = {};
    }
    embeddedDevImages[devId][type] = imageUrl;
    
    // embedded ë³€ìˆ˜ ì—…ë°ì´íŠ¸
    updateEmbeddedImagesInHTML();
    
    // ì´ë¯¸ì§€ ë°ì´í„° ë³€ê²½ í”Œë˜ê·¸ ì„¤ì •
    if (typeof window.imageDataChanged !== 'undefined') {
        window.imageDataChanged = true;
    }
    
    // HTML íŒŒì¼ì— ìë™ìœ¼ë¡œ ì´ë¯¸ì§€ ì €ì¥ (ë¹„í™œì„±í™”ë¨ - ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ì €ì¥í•  ë•Œë§Œ ë‹¤ìš´ë¡œë“œ)
    // ìë™ ì €ì¥ ê¸°ëŠ¥ì€ ì˜ë„ì¹˜ ì•Šì€ ë‹¤ìš´ë¡œë“œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.
    // ì €ì¥ì´ í•„ìš”í•œ ê²½ìš° ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ saveHTMLWithImages() í•¨ìˆ˜ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•˜ì„¸ìš”.
    /*
    if (window.autoSaveTimeout) {
        clearTimeout(window.autoSaveTimeout);
    }
    window.autoSaveTimeout = setTimeout(() => {
        if (typeof window.saveHTMLWithImages === 'function') {
            window.saveHTMLWithImages(true); // ìë™ ì €ì¥ ëª¨ë“œ (ì•Œë¦¼ ì—†ìŒ)
        }
    }, 2000);
    */
}

// ì´ë¯¸ì§€ ë³µì›
function restoreImages(devId) {
    // ë¨¼ì € embedded ë³€ìˆ˜ì—ì„œ í™•ì¸ (HTML íŒŒì¼ ë‚´ë¶€ ë°ì´í„° ìš°ì„ )
    let images = {};
    if (typeof embeddedDevImages !== 'undefined' && embeddedDevImages && Object.keys(embeddedDevImages).length > 0) {
        images = embeddedDevImages;
    } else {
        // embedded ë°ì´í„°ê°€ ì—†ìœ¼ë©´ localStorageì—ì„œ ê°€ì ¸ì˜¤ê¸°
        images = JSON.parse(localStorage.getItem('devImages') || '{}');
    }
    
    if (images[devId]) {
        // ìš”ì†Œê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ í›„ ë³µì›
        const asIsInput = document.getElementById(`file-as-is-${devId}`);
        const toBeInput = document.getElementById(`file-to-be-${devId}`);
        
        if (images[devId]['as-is'] && asIsInput) {
            // ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ì–´ DOMì´ ì™„ì „íˆ ì¤€ë¹„ëœ í›„ ë³µì›
            setTimeout(() => {
                displayImage(devId, 'as-is', images[devId]['as-is']);
            }, 10);
        }
        if (images[devId]['to-be'] && toBeInput) {
            setTimeout(() => {
                displayImage(devId, 'to-be', images[devId]['to-be']);
            }, 10);
        }
    }
}

// ì´ë¯¸ì§€ ëª¨ë‹¬ í‘œì‹œ
function showImageModal(imageUrl) {
    let modal = document.getElementById('image-modal');
    if (!modal) {
        modal = document.createElement('div');
        modal.id = 'image-modal';
        modal.className = 'image-modal';
        const img = document.createElement('img');
        img.src = '';
        img.alt = 'ì›ë³¸ ì´ë¯¸ì§€';
        img.onclick = function(e) {
            e.stopPropagation();
        };
        const closeBtn = document.createElement('span');
        closeBtn.className = 'close-btn';
        closeBtn.innerHTML = '&times;';
        modal.appendChild(closeBtn);
        modal.appendChild(img);
        modal.onclick = function(e) {
            if (e.target === modal || e.target.classList.contains('close-btn')) {
                closeImageModal();
            }
        };
        document.body.appendChild(modal);
    }
    modal.querySelector('img').src = imageUrl;
    modal.classList.add('active');
}

// ì´ë¯¸ì§€ ëª¨ë‹¬ ë‹«ê¸°
function closeImageModal() {
    const modal = document.getElementById('image-modal');
    if (modal) {
        modal.classList.remove('active');
    }
}

// ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeImageModal();
    }
});

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ìƒíƒœ ë³µì›
document.addEventListener('DOMContentLoaded', function() {
    const requirementStatuses = JSON.parse(localStorage.getItem('requirementStatuses') || '{}');
    Object.keys(requirementStatuses).forEach(reqId => {
        const select = document.querySelector(`select[onchange*="updateRequirementStatus(${reqId}"]`);
        if (select) {
            select.value = requirementStatuses[reqId];
            select.className = 'status-select status-' + requirementStatuses[reqId];
        }
    });
    
    // ê°œë°œ ìƒíƒœ ë³µì›
    const devStatuses = JSON.parse(localStorage.getItem('devStatuses') || '{}');
    Object.keys(devStatuses).forEach(devId => {
        const select = document.querySelector(`select[onchange*="updateDevStatus('${devId}'"]`);
        if (select) {
            select.value = devStatuses[devId];
            select.className = 'dev-status-select ' + devStatuses[devId];
        }
    });
    
    // ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜ì˜ ëª¨ë“  í•­ëª©ì— í† ê¸€ ë²„íŠ¼ ì¶”ê°€
    addToggleButtonsToExtrusionItems();
    
    // ê³ ë¬´ ì‚¬ìš© ê³„íš ì„¹ì…˜ì˜ h5 ì œëª©ì— í† ê¸€ ê¸°ëŠ¥ ì¶”ê°€
    addToggleToRubberPlanH5();
    
    // ì €ì¥ëœ ì´ë¯¸ì§€ ë³µì›
    restoreAllImages();
    
    // localStorageì˜ ì´ë¯¸ì§€ë¥¼ embeddedDevImages ë³€ìˆ˜ì— ë³µì‚¬ (HTML íŒŒì¼ì— í¬í•¨ë˜ì–´ ìˆë„ë¡)
    // ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜ì˜ ë™ì  ìš”ì†Œ ìƒì„± ì™„ë£Œë¥¼ ê¸°ë‹¤ë¦¼
    setTimeout(() => {
        // localStorageì˜ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ embeddedDevImagesì— ë¬´ì¡°ê±´ ë³µì‚¬
        const storedImages = JSON.parse(localStorage.getItem('devImages') || '{}');
        if (Object.keys(storedImages).length > 0) {
            // embeddedDevImages ë³€ìˆ˜ ì´ˆê¸°í™”
            if (typeof embeddedDevImages === 'undefined') {
                embeddedDevImages = {};
            }
            
            // localStorageì˜ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ embeddedDevImagesì— ë³µì‚¬ (ë®ì–´ì“°ê¸°)
            Object.keys(storedImages).forEach(devId => {
                if (!embeddedDevImages[devId]) {
                    embeddedDevImages[devId] = {};
                }
                // as-is ì´ë¯¸ì§€ ë³µì‚¬
                if (storedImages[devId]['as-is']) {
                    embeddedDevImages[devId]['as-is'] = storedImages[devId]['as-is'];
                }
                // to-be ì´ë¯¸ì§€ ë³µì‚¬
                if (storedImages[devId]['to-be']) {
                    embeddedDevImages[devId]['to-be'] = storedImages[devId]['to-be'];
                }
            });
            console.log('localStorageì˜ ëª¨ë“  ì´ë¯¸ì§€ê°€ embeddedDevImages ë³€ìˆ˜ì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤:', Object.keys(storedImages));
        }
        
        // ê¸°ì¡´ ì´ë¯¸ì§€ë“¤ ìë™ ì €ì¥ (Blob URL ë“±ì„ Base64ë¡œ ë³€í™˜)
        // ì´ í•¨ìˆ˜ë„ localStorageì˜ ì´ë¯¸ì§€ë¥¼ embeddedDevImagesì— ë³µì‚¬í•¨
        saveAllExistingImages();
    }, 3000); // ì´ë¯¸ì§€ ë³µì› ë° ë™ì  ìš”ì†Œ ìƒì„± í›„ ì‹¤í–‰
});

// ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜ì˜ ëª¨ë“  í•­ëª©ì— í† ê¸€ ë²„íŠ¼ ì¶”ê°€
function addToggleButtonsToExtrusionItems() {
    // ëª¨ë“  requirement-sectionì„ ìˆœíšŒí•˜ë©´ì„œ "ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬" ì„¹ì…˜ ì°¾ê¸°
    const allSections = document.querySelectorAll('.requirement-section');
    let targetSection = null;
    
    for (let section of allSections) {
        const h4 = section.querySelector('h4');
        if (h4 && h4.textContent.includes('ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬')) {
            targetSection = section;
            break;
        }
    }
    
    if (!targetSection) {
        console.log('ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
    }
    
    // ìº˜ë¦°ë” ì—°ë™ í•­ëª©ì˜ ê¸°ì¡´ í† ê¸€ ì œê±°
    const calendarDevIds = ['extrusion-calendar-sync-bidirectional', 'extrusion-calendar-sync-dragdrop', 'extrusion-calendar-sync-realtime'];
    calendarDevIds.forEach(devId => {
        const select = targetSection.querySelector(`select[onchange*="updateDevStatus('${devId}'"]`);
        if (select) {
            const li = select.closest('li');
            if (li) {
                // í† ê¸€ ì•„ì´ì½˜ ì œê±°
                const toggleIcon = li.querySelector('.toggle-icon');
                if (toggleIcon) toggleIcon.remove();
                // item-text span ì œê±°
                const itemText = li.querySelector('.item-text');
                if (itemText) {
                    const text = itemText.textContent;
                    itemText.replaceWith(document.createTextNode(text + ' '));
                }
                // before-after-container ì œê±°
                const container = li.querySelector(`#before-after-${devId}`);
                if (container) container.remove();
                // í´ë˜ìŠ¤ ì œê±°
                li.classList.remove('has-toggle', 'expanded');
                // í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” ì œê±°í•  ìˆ˜ ì—†ì§€ë§Œ, í† ê¸€ ê¸°ëŠ¥ì€ ì‘ë™í•˜ì§€ ì•Šë„ë¡ í•¨
            }
        }
    });
    
    // before-after-containerê°€ ì´ë¯¸ ìˆëŠ” í•­ëª©ë„ ì²˜ë¦¬ (extrusion-quantity-time-total)
    const existingContainer = targetSection.querySelector('#before-after-extrusion-quantity-time-total');
    if (existingContainer) {
        const li = existingContainer.closest('li');
        if (li && !li.classList.contains('has-toggle')) {
            const select = li.querySelector('select[onchange*="updateDevStatus"]');
            if (select) {
                const onchangeAttr = select.getAttribute('onchange');
                const match = onchangeAttr.match(/updateDevStatus\('([^']+)'/);
                if (match && match[1] === 'extrusion-quantity-time-total') {
                    li.classList.add('has-toggle');
                    const toggleIcon = document.createElement('span');
                    toggleIcon.className = 'toggle-icon';
                    li.insertBefore(toggleIcon, li.firstChild);
                    
                    const textNodes = [];
                    let node = li.firstChild;
                    while (node) {
                        if (node === toggleIcon) {
                            node = node.nextSibling;
                            continue;
                        }
                        if (node === select) {
                            break;
                        }
                        if (node.nodeType === Node.TEXT_NODE) {
                            const text = node.textContent.trim();
                            if (text) {
                                textNodes.push(node);
                            }
                        }
                        node = node.nextSibling;
                    }
                    
                    if (textNodes.length > 0) {
                        const textSpan = document.createElement('span');
                        textSpan.className = 'item-text';
                        let textContent = '';
                        textNodes.forEach(textNode => {
                            textContent += textNode.textContent.trim() + ' ';
                            textNode.remove();
                        });
                        if (textContent.trim()) {
                            textSpan.textContent = textContent.trim();
                            toggleIcon.parentNode.insertBefore(textSpan, toggleIcon.nextSibling);
                        }
                    }
                    
                    li.addEventListener('click', function(e) {
                        if (e.target === select || select.contains(e.target)) {
                            return;
                        }
                        toggleBeforeAfter('extrusion-quantity-time-total');
                    });
                    
                    // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                    setTimeout(() => {
                        const asIsArea = document.getElementById('upload-area-as-is-extrusion-quantity-time-total');
                        const toBeArea = document.getElementById('upload-area-to-be-extrusion-quantity-time-total');
                        
                        if (asIsArea && !asIsArea.hasAttribute('data-listener-added')) {
                            asIsArea.setAttribute('data-listener-added', 'true');
                            asIsArea.addEventListener('paste', function(e) {
                                handlePasteImage('extrusion-quantity-time-total', 'as-is', e);
                            });
                            asIsArea.addEventListener('click', function(e) {
                                if (e.target.classList.contains('upload-btn')) {
                                    return;
                                }
                                if (asIsArea.classList.contains('has-image')) {
                                    if (e.target.tagName === 'IMG') {
                                        e.stopPropagation();
                                        asIsArea.focus();
                                        return;
                                    }
                                    e.preventDefault();
                                    e.stopPropagation();
                                    asIsArea.focus();
                                    return;
                                }
                                e.preventDefault();
                                e.stopPropagation();
                                asIsArea.focus();
                            });
                            asIsArea.addEventListener('contextmenu', function(e) {
                                if (asIsArea.classList.contains('has-image') && e.target.tagName === 'IMG') {
                                    return;
                                }
                                e.preventDefault();
                            });
                        }
                        
                        if (toBeArea && !toBeArea.hasAttribute('data-listener-added')) {
                            toBeArea.setAttribute('data-listener-added', 'true');
                            toBeArea.addEventListener('paste', function(e) {
                                handlePasteImage('extrusion-quantity-time-total', 'to-be', e);
                            });
                            toBeArea.addEventListener('click', function(e) {
                                if (e.target.classList.contains('upload-btn')) {
                                    return;
                                }
                                if (toBeArea.classList.contains('has-image')) {
                                    if (e.target.tagName === 'IMG') {
                                        e.stopPropagation();
                                        toBeArea.focus();
                                        return;
                                    }
                                    e.preventDefault();
                                    e.stopPropagation();
                                    toBeArea.focus();
                                    return;
                                }
                                e.preventDefault();
                                e.stopPropagation();
                                toBeArea.focus();
                            });
                            toBeArea.addEventListener('contextmenu', function(e) {
                                if (toBeArea.classList.contains('has-image') && e.target.tagName === 'IMG') {
                                    return;
                                }
                                e.preventDefault();
                            });
                        }
                    }, 100);
                }
            }
        }
    }
    
    const allSelects = targetSection.querySelectorAll('select[onchange*="updateDevStatus"]');
    console.log(`ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜ì—ì„œ ${allSelects.length}ê°œì˜ select ìš”ì†Œë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.`);
    
    allSelects.forEach(select => {
        const onchangeAttr = select.getAttribute('onchange');
        const match = onchangeAttr.match(/updateDevStatus\('([^']+)'/);
        if (match) {
            const devId = match[1];
            
            // ìº˜ë¦°ë” ì—°ë™ 3ê°œ í•­ëª©ì€ í† ê¸€ ê¸°ëŠ¥ ì œì™¸
            if (devId === 'extrusion-calendar-sync-bidirectional' || 
                devId === 'extrusion-calendar-sync-dragdrop' || 
                devId === 'extrusion-calendar-sync-realtime') {
                return;
            }
            
            const li = select.closest('li');
            
            if (!li) {
                console.log(`devId ${devId}ì— ëŒ€í•œ li ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
                return;
            }
            
            // ì´ë¯¸ í† ê¸€ì´ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ ìŠ¤í‚µ
            if (li.classList.contains('has-toggle')) {
                return;
            }
            
            // liì— í† ê¸€ í´ë˜ìŠ¤ ì¶”ê°€
            li.classList.add('has-toggle');
            
            // liì˜ ì²« ë²ˆì§¸ í…ìŠ¤íŠ¸ ë…¸ë“œë¥¼ ì°¾ì•„ì„œ í† ê¸€ ì•„ì´ì½˜ ì¶”ê°€
            const toggleIcon = document.createElement('span');
            toggleIcon.className = 'toggle-icon';
            
            // liì˜ ì‹œì‘ ë¶€ë¶„ì— í† ê¸€ ì•„ì´ì½˜ ì¶”ê°€
            li.insertBefore(toggleIcon, li.firstChild);
            
            // liì˜ í…ìŠ¤íŠ¸ ë¶€ë¶„ì„ ì°¾ì•„ì„œ spanìœ¼ë¡œ ë˜í•‘ (select ì œì™¸)
            const textNodes = [];
            let node = li.firstChild;
            while (node) {
                if (node === toggleIcon) {
                    node = node.nextSibling;
                    continue;
                }
                if (node === select) {
                    break;
                }
                if (node.nodeType === Node.TEXT_NODE) {
                    const text = node.textContent.trim();
                    if (text) {
                        textNodes.push(node);
                    }
                }
                node = node.nextSibling;
            }
            
            // í…ìŠ¤íŠ¸ ë…¸ë“œê°€ ìˆìœ¼ë©´ spanìœ¼ë¡œ ë˜í•‘
            if (textNodes.length > 0) {
                const textSpan = document.createElement('span');
                textSpan.className = 'item-text';
                let textContent = '';
                textNodes.forEach(textNode => {
                    textContent += textNode.textContent.trim() + ' ';
                    textNode.remove();
                });
                if (textContent.trim()) {
                    textSpan.textContent = textContent.trim();
                    // í† ê¸€ ì•„ì´ì½˜ ë‹¤ìŒì— í…ìŠ¤íŠ¸ ì¶”ê°€
                    toggleIcon.parentNode.insertBefore(textSpan, toggleIcon.nextSibling);
                }
            }
            
            // li í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ (selectëŠ” ì œì™¸)
            li.addEventListener('click', function(e) {
                // selectë‚˜ ê·¸ í•˜ìœ„ ìš”ì†Œë¥¼ í´ë¦­í•œ ê²½ìš°ëŠ” ë¬´ì‹œ
                if (e.target === select || select.contains(e.target)) {
                    return;
                }
                toggleBeforeAfter(devId);
            });
            
            // BEFORE/AFTER ì»¨í…Œì´ë„ˆ ì¶”ê°€
            const container = document.createElement('div');
            container.id = 'before-after-' + devId;
            container.className = 'before-after-container';
            container.innerHTML = `
                <div class="image-comparison">
                    <div class="image-upload-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h6 style="margin: 0;">AS IS</h6>
                            <button class="upload-btn" onclick="const input = document.getElementById('file-as-is-${devId}'); if (input) input.click();">íŒŒì¼ ì„ íƒ</button>
                        </div>
                        <div class="image-upload-area" tabindex="0">
                            <input type="file" id="file-as-is-${devId}" accept="image/*" onchange="handleImageUpload('${devId}', 'as-is', this)">
                            <div class="upload-placeholder" id="placeholder-as-is-${devId}">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                        </div>
                    </div>
                    <div class="image-upload-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h6 style="margin: 0;">TO BE</h6>
                            <button class="upload-btn" onclick="const input = document.getElementById('file-to-be-${devId}'); if (input) input.click();">íŒŒì¼ ì„ íƒ</button>
                        </div>
                        <div class="image-upload-area" tabindex="0">
                            <input type="file" id="file-to-be-${devId}" accept="image/*" onchange="handleImageUpload('${devId}', 'to-be', this)">
                            <div class="upload-placeholder" id="placeholder-to-be-${devId}">Ctrl+Vë¡œ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°<br><small>(ìš°í´ë¦­: ì‚­ì œ)</small></div>
                        </div>
                    </div>
                </div>
            `;
            li.appendChild(container);
            
            // í´ë¦½ë³´ë“œ ë¶™ì—¬ë„£ê¸° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            setTimeout(() => {
                const asIsArea = container.querySelector(`#file-as-is-${devId}`)?.parentElement;
                const toBeArea = container.querySelector(`#file-to-be-${devId}`)?.parentElement;
                
                if (asIsArea) {
                    // ë¶™ì—¬ë„£ê¸° ì´ë²¤íŠ¸
                    asIsArea.addEventListener('paste', function(e) {
                        handlePasteImage(devId, 'as-is', e);
                    });
                    
                    // í´ë¦­ ì´ë²¤íŠ¸ - í¬ì»¤ìŠ¤ë§Œ (íŒŒì¼ ì„ íƒ ì°½ì´ ì—´ë¦¬ì§€ ì•ŠìŒ)
                    asIsArea.addEventListener('click', function(e) {
                        // íŒŒì¼ ì„ íƒ ë²„íŠ¼ì„ í´ë¦­í•œ ê²½ìš°ëŠ” ë¬´ì‹œ (ë²„íŠ¼ ìì²´ì˜ onclickì´ ì²˜ë¦¬)
                        if (e.target.classList.contains('upload-btn')) {
                            return;
                        }
                        // ì´ë¯¸ì§€ê°€ ìˆëŠ” ê²½ìš°
                        if (asIsArea.classList.contains('has-image')) {
                            // ì´ë¯¸ì§€ ìì²´ë¥¼ í´ë¦­í•œ ê²½ìš°ëŠ” ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ìœ„í•´ ì²˜ë¦¬
                            if (e.target.tagName === 'IMG') {
                                // ë‹¨ì¼ í´ë¦­ì€ í¬ì»¤ìŠ¤ë¥¼ ì£¼ê³ , ë”ë¸”í´ë¦­ì€ í™•ëŒ€
                                e.stopPropagation();
                                asIsArea.focus();
                                return;
                            }
                            // ì´ë¯¸ì§€ ì˜ì—­ì„ í´ë¦­í•œ ê²½ìš° - í¬ì»¤ìŠ¤ë§Œ ì£¼ê¸°
                            e.preventDefault();
                            e.stopPropagation();
                            asIsArea.focus();
                            return;
                        }
                        // ì´ë¯¸ì§€ê°€ ì—†ëŠ” ê²½ìš° - í¬ì»¤ìŠ¤ë§Œ ì£¼ê³  íŒŒì¼ ì„ íƒ ì°½ì€ ì—´ì§€ ì•ŠìŒ
                        e.preventDefault();
                        e.stopPropagation();
                        asIsArea.focus();
                    });
                    
                    // ìš°í´ë¦­ ì´ë²¤íŠ¸ - ì´ë¯¸ì§€ê°€ ìˆì„ ë•Œë§Œ ì‚­ì œ ê°€ëŠ¥
                    asIsArea.addEventListener('contextmenu', function(e) {
                        if (asIsArea.classList.contains('has-image') && e.target.tagName === 'IMG') {
                            // ì´ë¯¸ì§€ì˜ oncontextmenuê°€ ì²˜ë¦¬í•˜ë„ë¡ í•¨
                            return;
                        }
                        // ì´ë¯¸ì§€ê°€ ì—†ê±°ë‚˜ ì´ë¯¸ì§€ê°€ ì•„ë‹Œ ì˜ì—­ì„ ìš°í´ë¦­í•œ ê²½ìš°ëŠ” ê¸°ë³¸ ë™ì‘ ë°©ì§€
                        e.preventDefault();
                    });
                }
                
                if (toBeArea) {
                    // ë¶™ì—¬ë„£ê¸° ì´ë²¤íŠ¸
                    toBeArea.addEventListener('paste', function(e) {
                        handlePasteImage(devId, 'to-be', e);
                    });
                    
                    // í´ë¦­ ì´ë²¤íŠ¸ - í¬ì»¤ìŠ¤ë§Œ (íŒŒì¼ ì„ íƒ ì°½ì´ ì—´ë¦¬ì§€ ì•ŠìŒ)
                    toBeArea.addEventListener('click', function(e) {
                        // íŒŒì¼ ì„ íƒ ë²„íŠ¼ì„ í´ë¦­í•œ ê²½ìš°ëŠ” ë¬´ì‹œ (ë²„íŠ¼ ìì²´ì˜ onclickì´ ì²˜ë¦¬)
                        if (e.target.classList.contains('upload-btn')) {
                            return;
                        }
                        // ì´ë¯¸ì§€ê°€ ìˆëŠ” ê²½ìš°
                        if (toBeArea.classList.contains('has-image')) {
                            // ì´ë¯¸ì§€ ìì²´ë¥¼ í´ë¦­í•œ ê²½ìš°ëŠ” ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ìœ„í•´ ì²˜ë¦¬
                            if (e.target.tagName === 'IMG') {
                                // ë‹¨ì¼ í´ë¦­ì€ í¬ì»¤ìŠ¤ë¥¼ ì£¼ê³ , ë”ë¸”í´ë¦­ì€ í™•ëŒ€
                                e.stopPropagation();
                                toBeArea.focus();
                                return;
                            }
                            // ì´ë¯¸ì§€ ì˜ì—­ì„ í´ë¦­í•œ ê²½ìš° - í¬ì»¤ìŠ¤ë§Œ ì£¼ê¸°
                            e.preventDefault();
                            e.stopPropagation();
                            toBeArea.focus();
                            return;
                        }
                        // ì´ë¯¸ì§€ê°€ ì—†ëŠ” ê²½ìš° - í¬ì»¤ìŠ¤ë§Œ ì£¼ê³  íŒŒì¼ ì„ íƒ ì°½ì€ ì—´ì§€ ì•ŠìŒ
                        e.preventDefault();
                        e.stopPropagation();
                        toBeArea.focus();
                    });
                    
                    // ìš°í´ë¦­ ì´ë²¤íŠ¸ - ì´ë¯¸ì§€ê°€ ìˆì„ ë•Œë§Œ ì‚­ì œ ê°€ëŠ¥
                    toBeArea.addEventListener('contextmenu', function(e) {
                        if (toBeArea.classList.contains('has-image') && e.target.tagName === 'IMG') {
                            // ì´ë¯¸ì§€ì˜ oncontextmenuê°€ ì²˜ë¦¬í•˜ë„ë¡ í•¨
                            return;
                        }
                        // ì´ë¯¸ì§€ê°€ ì—†ê±°ë‚˜ ì´ë¯¸ì§€ê°€ ì•„ë‹Œ ì˜ì—­ì„ ìš°í´ë¦­í•œ ê²½ìš°ëŠ” ê¸°ë³¸ ë™ì‘ ë°©ì§€
                        e.preventDefault();
                    });
                }
            }, 0);
        }
    });
    
    console.log('í† ê¸€ ë²„íŠ¼ ì¶”ê°€ ì™„ë£Œ');
}

// ê³ ë¬´ ì‚¬ìš© ê³„íš ì„¹ì…˜ì˜ h5 ì œëª©ì— í† ê¸€ ê¸°ëŠ¥ ì¶”ê°€
function addToggleToRubberPlanH5() {
    const toggleableH5s = document.querySelectorAll('.toggleable-h5');
    
    toggleableH5s.forEach(h5 => {
        const toggleId = h5.getAttribute('data-toggle-id');
        if (!toggleId) return;
        
        const content = document.getElementById('content-' + toggleId);
        if (!content) return;
        
        // localStorageì—ì„œ í† ê¸€ ìƒíƒœ í™•ì¸
        const toggleStates = JSON.parse(localStorage.getItem('rubberPlanToggleStates') || '{}');
        const isExpanded = toggleStates[toggleId] !== false; // ê¸°ë³¸ê°’ì€ true (ì—´ë¦¼)
        
        if (isExpanded) {
            h5.classList.add('expanded');
            content.classList.add('active');
        }
        
        // h5 í´ë¦­ ì´ë²¤íŠ¸
        h5.addEventListener('click', function(e) {
            // selectë¥¼ í´ë¦­í•œ ê²½ìš°ëŠ” ë¬´ì‹œ
            if (e.target.tagName === 'SELECT' || e.target.closest('select')) {
                return;
            }
            
            const isActive = content.classList.toggle('active');
            h5.classList.toggle('expanded', isActive);
            
            // localStorageì— ìƒíƒœ ì €ì¥
            const toggleStates = JSON.parse(localStorage.getItem('rubberPlanToggleStates') || '{}');
            toggleStates[toggleId] = isActive;
            localStorage.setItem('rubberPlanToggleStates', JSON.stringify(toggleStates));
            
            // rubber-inventory-hoist ì„¹ì…˜ì´ ì—´ë¦´ ë•Œ í…Œì´ë¸” ì´ˆê¸°í™”
            if (toggleId === 'rubber-inventory-hoist' && isActive) {
                setTimeout(() => {
                    initializeRubberInventoryTable();
                }, 100);
            }
        });
        
        // ì´ˆê¸° ë¡œë“œ ì‹œ rubber-inventory-hoist ì„¹ì…˜ì´ ì—´ë ¤ìˆìœ¼ë©´ ì´ˆê¸°í™”
        if (toggleId === 'rubber-inventory-hoist' && content.classList.contains('active')) {
            setTimeout(() => {
                initializeRubberInventoryTable();
            }, 100);
        }
    });
    
    // ê³ ë¬´ ì‚¬ìš© ê³„íš í† ê¸€ë“¤ì˜ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    setupRubberPlanImageEventListeners();
}

// ê³ ë¬´ ì‚¬ìš© ê³„íš í† ê¸€ë“¤ì˜ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
function setupRubberPlanImageEventListeners() {
    const devIds = ['rubber-plan-loading', 'rubber-list-change', 'rubber-inventory-hoist', 'extrusion-calendar-sync-realtime', 'extrusion-quantity-time-total'];
    
    devIds.forEach(devId => {
        setTimeout(() => {
            const asIsArea = document.getElementById(`upload-area-as-is-${devId}`);
            const toBeArea = document.getElementById(`upload-area-to-be-${devId}`);
            
            if (asIsArea && !asIsArea.hasAttribute('data-listener-added')) {
                asIsArea.setAttribute('data-listener-added', 'true');
                
                // ë¶™ì—¬ë„£ê¸° ì´ë²¤íŠ¸
                asIsArea.addEventListener('paste', function(e) {
                    handlePasteImage(devId, 'as-is', e);
                });
                
                // í´ë¦­ ì´ë²¤íŠ¸ - í¬ì»¤ìŠ¤ë§Œ (íŒŒì¼ ì„ íƒ ì°½ì´ ì—´ë¦¬ì§€ ì•ŠìŒ)
                asIsArea.addEventListener('click', function(e) {
                    if (e.target.classList.contains('upload-btn')) {
                        return;
                    }
                    if (asIsArea.classList.contains('has-image')) {
                        if (e.target.tagName === 'IMG') {
                            e.stopPropagation();
                            asIsArea.focus();
                            return;
                        }
                        e.preventDefault();
                        e.stopPropagation();
                        asIsArea.focus();
                        return;
                    }
                    e.preventDefault();
                    e.stopPropagation();
                    asIsArea.focus();
                });
                
                // ìš°í´ë¦­ ì´ë²¤íŠ¸ - ì´ë¯¸ì§€ê°€ ìˆì„ ë•Œë§Œ ì‚­ì œ ê°€ëŠ¥
                asIsArea.addEventListener('contextmenu', function(e) {
                    if (asIsArea.classList.contains('has-image') && e.target.tagName === 'IMG') {
                        return;
                    }
                    e.preventDefault();
                });
            }
            
            if (toBeArea && !toBeArea.hasAttribute('data-listener-added')) {
                toBeArea.setAttribute('data-listener-added', 'true');
                
                // ë¶™ì—¬ë„£ê¸° ì´ë²¤íŠ¸
                toBeArea.addEventListener('paste', function(e) {
                    handlePasteImage(devId, 'to-be', e);
                });
                
                // í´ë¦­ ì´ë²¤íŠ¸ - í¬ì»¤ìŠ¤ë§Œ (íŒŒì¼ ì„ íƒ ì°½ì´ ì—´ë¦¬ì§€ ì•ŠìŒ)
                toBeArea.addEventListener('click', function(e) {
                    if (e.target.classList.contains('upload-btn')) {
                        return;
                    }
                    if (toBeArea.classList.contains('has-image')) {
                        if (e.target.tagName === 'IMG') {
                            e.stopPropagation();
                            toBeArea.focus();
                            return;
                        }
                        e.preventDefault();
                        e.stopPropagation();
                        toBeArea.focus();
                        return;
                    }
                    e.preventDefault();
                    e.stopPropagation();
                    toBeArea.focus();
                });
                
                // ìš°í´ë¦­ ì´ë²¤íŠ¸ - ì´ë¯¸ì§€ê°€ ìˆì„ ë•Œë§Œ ì‚­ì œ ê°€ëŠ¥
                toBeArea.addEventListener('contextmenu', function(e) {
                    if (toBeArea.classList.contains('has-image') && e.target.tagName === 'IMG') {
                        return;
                    }
                    e.preventDefault();
                });
            }
        }, 100);
    });
}

// ëª¨ë“  ì´ë¯¸ì§€ ë³µì›
// ê³ ë¬´ ì¬ê³  í‘œ í•©ê³„ í† ê¸€ í•¨ìˆ˜
let rubberInventorySummaryMode = false; // false: ì „ì²´ ë³´ê¸°, true: í•©ê³„ë§Œ ë³´ê¸°

// ê³ ë¬´ ì¬ê³  í‘œ ì´ˆê¸° ìƒíƒœ ì„¤ì •
function initializeRubberInventoryTable() {
    const table = document.getElementById('rubber-inventory-table');
    if (!table) return;
    
    // ì „ì²´ ë³´ê¸° ëª¨ë“œë¡œ ì´ˆê¸°í™”
    rubberInventorySummaryMode = false;
    const button = document.getElementById('toggle-rubber-inventory-summary');
    if (button) {
        button.textContent = 'í•©ê³„ë§Œ ë³´ê¸°';
    }
    
    const rows = table.querySelectorAll('tbody tr');
    rows.forEach(row => {
        const isSummaryRow = row.classList.contains('summary-row');
        row.style.display = '';
        
        if (isSummaryRow) {
            // í•©ê³„ í–‰ì˜ ë°°ê²½ìƒ‰ì„ íšŒìƒ‰ìœ¼ë¡œ ì„¤ì •
            row.style.backgroundColor = '#e8e8e8';
            
            // í•©ê³„ í–‰ì˜ ì²« 4ê°œ ì»¬ëŸ¼(No, ìì¬ë²ˆí˜¸, ë°°í•©ë²ˆí˜¸, ë“±ë¡ ì•½ì–´)ì˜ ê°’ë§Œ ìˆ¨ê¸°ê¸°
            const cells = row.querySelectorAll('td');
            if (cells.length >= 4) {
                // ì›ë³¸ ë°ì´í„°ë¥¼ data ì†ì„±ì— ì €ì¥
                if (!cells[0].hasAttribute('data-original-text')) {
                    cells[0].setAttribute('data-original-text', cells[0].textContent);
                    cells[1].setAttribute('data-original-text', cells[1].textContent);
                    cells[2].setAttribute('data-original-text', cells[2].textContent);
                    cells[3].setAttribute('data-original-text', cells[3].textContent);
                }
                // ê°’ë§Œ ìˆ¨ê¸°ê¸° (ì…€ì€ ìœ ì§€)
                cells[0].textContent = '';
                cells[1].textContent = '';
                cells[2].textContent = '';
                cells[3].textContent = '';
            }
        }
    });
}

function toggleRubberInventorySummary() {
    const table = document.getElementById('rubber-inventory-table');
    const button = document.getElementById('toggle-rubber-inventory-summary');
    
    if (!table || !button) return;
    
    rubberInventorySummaryMode = !rubberInventorySummaryMode;
    const rows = table.querySelectorAll('tbody tr');
    
    rows.forEach(row => {
        const isSummaryRow = row.classList.contains('summary-row');
        const rowNumber = row.getAttribute('data-row-number');
        const isYellowRow = rowNumber === '12'; // No. 12ëŠ” ë…¸ë€ìƒ‰ ìœ ì§€
        
        if (rubberInventorySummaryMode) {
            // í•©ê³„ë§Œ ë³´ê¸° ëª¨ë“œ: í•©ê³„ í–‰(summary-row í´ë˜ìŠ¤)ë§Œ í‘œì‹œ
            if (isSummaryRow) {
                row.style.display = '';
                // í•©ê³„ë§Œ ë³´ê¸° ëª¨ë“œì—ì„œëŠ” ëª¨ë“  ì…€ì˜ ì›ë³¸ ê°’ ë³µì›
                const cells = row.querySelectorAll('td');
                if (cells.length >= 4) {
                    // ì €ì¥ëœ ì›ë³¸ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë³µì›
                    if (cells[0].hasAttribute('data-original-text')) {
                        cells[0].textContent = cells[0].getAttribute('data-original-text');
                        cells[1].textContent = cells[1].getAttribute('data-original-text');
                        cells[2].textContent = cells[2].getAttribute('data-original-text');
                        cells[3].textContent = cells[3].getAttribute('data-original-text');
                    }
                }
                // No. 12ëŠ” ë…¸ë€ìƒ‰ ìœ ì§€, ë‚˜ë¨¸ì§€ëŠ” í°ìƒ‰
                if (isYellowRow) {
                    row.style.backgroundColor = '#fff3cd';
                } else {
                    row.style.backgroundColor = '';
                }
            } else {
                row.style.display = 'none';
            }
            button.textContent = 'ì „ì²´ ë³´ê¸°';
        } else {
            // ì „ì²´ ë³´ê¸° ëª¨ë“œ: ëª¨ë“  í–‰ í‘œì‹œ
            row.style.display = '';
            // í•©ê³„ í–‰ì˜ ë°°ê²½ìƒ‰ ë³µì› (ì „ì²´ ë³´ê¸° ëª¨ë“œì—ì„œëŠ” ëª¨ë“  í•©ê³„ í–‰ì„ íšŒìƒ‰ìœ¼ë¡œ)
            if (isSummaryRow) {
                row.style.backgroundColor = '#e8e8e8';
                // í•©ê³„ í–‰ì˜ ì²« 4ê°œ ì»¬ëŸ¼(No, ìì¬ë²ˆí˜¸, ë°°í•©ë²ˆí˜¸, ë“±ë¡ ì•½ì–´)ì˜ ê°’ë§Œ ìˆ¨ê¸°ê¸°
                const cells = row.querySelectorAll('td');
                if (cells.length >= 4) {
                    // ì›ë³¸ ë°ì´í„°ë¥¼ data ì†ì„±ì— ì €ì¥ (ì•„ì§ ì €ì¥ë˜ì§€ ì•Šì€ ê²½ìš°ë§Œ)
                    if (!cells[0].hasAttribute('data-original-text')) {
                        cells[0].setAttribute('data-original-text', cells[0].textContent);
                        cells[1].setAttribute('data-original-text', cells[1].textContent);
                        cells[2].setAttribute('data-original-text', cells[2].textContent);
                        cells[3].setAttribute('data-original-text', cells[3].textContent);
                    }
                    // ê°’ë§Œ ìˆ¨ê¸°ê¸° (ì…€ì€ ìœ ì§€)
                    cells[0].textContent = '';
                    cells[1].textContent = '';
                    cells[2].textContent = '';
                    cells[3].textContent = '';
                }
            } else {
                // ì¼ë°˜ í–‰ì€ ê·¸ëŒ€ë¡œ ìœ ì§€
            }
            button.textContent = 'í•©ê³„ë§Œ ë³´ê¸°';
        }
    });
}

function restoreAllImages() {
    try {
        // ë¨¼ì € embedded ë³€ìˆ˜ì—ì„œ í™•ì¸ (HTML íŒŒì¼ ë‚´ë¶€ ë°ì´í„° ìš°ì„ )
        let images = {};
        if (typeof embeddedDevImages !== 'undefined' && embeddedDevImages && Object.keys(embeddedDevImages).length > 0) {
            images = embeddedDevImages;
            // embedded ë°ì´í„°ë¥¼ localStorageì—ë„ ë™ê¸°í™”
            localStorage.setItem('devImages', JSON.stringify(images));
        } else {
            // embedded ë°ì´í„°ê°€ ì—†ìœ¼ë©´ localStorageì—ì„œ ê°€ì ¸ì˜¤ê¸°
            images = JSON.parse(localStorage.getItem('devImages') || '{}');
            // localStorage ë°ì´í„°ë¥¼ embedded ë³€ìˆ˜ì—ë„ ë™ê¸°í™”
            if (Object.keys(images).length > 0) {
                embeddedDevImages = images;
            }
        }
        
        if (!images || Object.keys(images).length === 0) {
            return;
        }
        
        // ëª¨ë“  devIdì— ëŒ€í•´ ì´ë¯¸ì§€ ë³µì› ì‹œë„
        Object.keys(images).forEach(devId => {
            restoreImages(devId);
        });
        
        // ì¶”ê°€ë¡œ ì•½ê°„ì˜ ì§€ì—° í›„ í•œ ë²ˆ ë” ì‹œë„ (ë™ì  ìš”ì†Œê°€ ëŠ¦ê²Œ ìƒì„±ë˜ëŠ” ê²½ìš° ëŒ€ë¹„)
        setTimeout(() => {
            Object.keys(images).forEach(devId => {
                restoreImages(devId);
            });
        }, 100);
    } catch (e) {
        console.error('ì´ë¯¸ì§€ ë³µì› ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
    }
}

// ê³ ë¬´ ì¬ê³  í‘œ í•©ê³„ í† ê¸€ í•¨ìˆ˜
</script>
<div class="chart-container" id="calendar-container">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
    <h4 style="margin: 0;">ê°œë°œ ì¼ì • ìº˜ë¦°ë”</h4>
    <button class="week-nav-btn" onclick="openDevModal()" style="background: var(--accent);">+ ê°œë°œ ì¶”ê°€</button>
  </div>
  <div id="calendar-wrapper">
    <div class="calendar-header">
      <button id="prev-month" class="calendar-nav-btn">â†</button>
      <h4 id="calendar-month-year"></h4>
      <button id="next-month" class="calendar-nav-btn">â†’</button>
    </div>
    <div id="calendar-grid"></div>
  </div>
</div>
    <button class="back-button" onclick="showHome()">â† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°</button>
</div>





    </div>



    <script>

        // Market Report Generator - JavaScript Functions



function showSection(sectionId) {

    const targetSection = document.getElementById(sectionId);

    if (!targetSection) {

        console.error(`Section ${sectionId} not found`);

        alert(`í•´ë‹¹ ì„¹ì…˜(${sectionId})ì€ ì•„ì§ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.`);

        return;

    }



    document.querySelectorAll(".content-section").forEach(section => {

        section.classList.remove("active");

    });

    document.getElementById("home").style.display = "none";

    targetSection.classList.add("active");

    window.scrollTo(0, 0);

}



function showHome() {

    document.querySelectorAll(".content-section").forEach(section => {

        section.classList.remove("active");

    });

    document.getElementById("home").style.display = "block";

    window.scrollTo(0, 0);

}



// Initialize charts when document is loaded

document.addEventListener('DOMContentLoaded', function() {

    // Chart.js defaults for consistent visuals
    if (window.Chart) {
        Chart.defaults.font.family = "'Noto Sans KR','Segoe UI',Tahoma,Geneva,Verdana,sans-serif";
        Chart.defaults.color = '#495057';
        Chart.defaults.plugins.legend.labels.boxWidth = 12;
        Chart.defaults.elements.line.tension = 0.25;
        Chart.defaults.datasets.line.borderWidth = 2;
        Chart.defaults.animation.duration = 600;
    }

    // Auto-initialize all charts
    initializeCharts();

});



function initializeCharts() {

    // This function will be called to initialize all Chart.js charts

    // Individual chart configurations will be inserted by the generator

}



// Chart creation helper function

function createChart(canvasId, config) {

    const ctx = document.getElementById(canvasId);

    if (ctx) {

        return new Chart(ctx, config);

    }

    return null;

}



// Utility function to format numbers

function formatNumber(num, decimals = 0) {

    return num.toLocaleString('ko-KR', {

        minimumFractionDigits: decimals,

        maximumFractionDigits: decimals

    });

}



// Utility function to format currency

function formatCurrency(amount, currency = 'USD') {

    const symbols = {

        'USD': '$',

        'KRW': 'â‚©',

        'EUR': 'â‚¬',

        'JPY': 'Â¥'

    };



    const symbol = symbols[currency] || currency;



    if (amount >= 1000000000) {

        return symbol + (amount / 1000000000).toFixed(2) + 'B';

    } else if (amount >= 1000000) {

        return symbol + (amount / 1000000).toFixed(2) + 'M';

    } else if (amount >= 1000) {

        return symbol + (amount / 1000).toFixed(2) + 'K';

    }

    return symbol + amount.toFixed(2);

}



// === GENERATED CHART SCRIPTS START ===

// === GENERATED CHART SCRIPTS END ===


// Weekly Production Plan Data (ì´ˆê¸° ë°ì´í„°)
const initialProductionData = {
    '1í˜¸': {
        '12/1-ì£¼': [
            { name: 'ë¹„ê°€ë™', quantity: '', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'ì°¬ë„¬', quantity: '5,000', note: '' },
            { name: 'NQ5 FRT ì°¬ë„¬', quantity: '20,000', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'ë¹„ê°€ë™', quantity: '', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'YB CUV RR D M', quantity: '2,400', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'NX4e RR CHNL M', quantity: '6,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'SG2 RR CHNL M', quantity: '6,000', note: '' },
            { name: 'SP2 FRT/RR B M', quantity: '3,000', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'SP2 FRT/RR B M', quantity: '7,000', note: '' },
            { name: 'PU A M', quantity: '3,000', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'YB A M', quantity: '6,000', note: '' },
            { name: 'YB G/RUN FRT/RR B', quantity: '4,800', note: '' }
        ],
        '12/4-ì•¼': [],
        '12/5-ì£¼': [
            { name: 'DE FRT B', quantity: '500', note: '' },
            { name: 'IG PE G/RUN RR D', quantity: '200', note: '' }
        ],
        '12/5-ì•¼': []
    },
    '2í˜¸': {
        '12/1-ì£¼': [],
        '12/1-ì•¼': [
            { name: 'SX2 FRT B', quantity: '8,000', note: '' },
            { name: 'SX2 RR B', quantity: '8,000', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'SX2 FRT B', quantity: '8,000', note: '' },
            { name: 'SX2 RR B', quantity: '8,000', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'SX2 FRT B', quantity: '8,000', note: '' },
            { name: 'SX2 RR B', quantity: '8,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'SX2 FRT B', quantity: '8,000', note: '' },
            { name: 'SX2 RR B', quantity: '8,000', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'SX2 FRT B', quantity: '11,000', note: '' },
            { name: 'SX2 RR B', quantity: '11,000', note: '' }
        ],
        '12/4-ì£¼': [],
        '12/4-ì•¼': [],
        '12/5-ì£¼': [],
        '12/5-ì•¼': []
    },
    '3í˜¸': {
        '12/1-ì£¼': [
            { name: 'SX3 RR RH(4)', quantity: '2,000', note: '' },
            { name: 'SX2 FRT RH(2)', quantity: '1,000', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'SX2 FRT LH (1)', quantity: '1,500', note: '' },
            { name: 'SX2 RR LH (3)', quantity: '1,500', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'SX2 FRT RH(2)', quantity: '1,500', note: '' },
            { name: 'SX3 RR RH(4)', quantity: '1,500', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'SX2 FRT LH (1)', quantity: '1,000', note: '' },
            { name: 'SX2 RR LH (3)', quantity: '2,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'SX2 FRT RH(2)', quantity: '1,500', note: '' },
            { name: 'SX3 RR RH(4)', quantity: '1,500', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'SX2 FRT LH (1)', quantity: '1,500', note: '' },
            { name: 'SX2 RR LH (3)', quantity: '1,500', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'SX2 FRT RH(2)', quantity: '1,500', note: '' },
            { name: 'SX3 RR RH(4)', quantity: '1,500', note: '' }
        ],
        '12/4-ì•¼': [
            { name: 'SX2 FRT LH (1)', quantity: '1,500', note: '' },
            { name: 'JOINT', quantity: '', note: '' }
        ],
        '12/5-ì£¼': [],
        '12/5-ì•¼': [
            { name: 'SX2 RR LH (3)', quantity: '1,500', note: '' },
            { name: 'JOINT', quantity: '', note: '' }
        ]
    },
    '4í˜¸': {
        '12/1-ì£¼': [
            { name: 'LX3 G/RUN FRT B', quantity: '7,200', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'LX3 G/RUN C1', quantity: '5,000', note: '' },
            { name: 'LX3 G/RUN RR C2', quantity: '12,000', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'MX5 G/RUN FRT E PP', quantity: '5,000', note: '' },
            { name: 'MX5 G/RUN RR E PP', quantity: '5,000', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'TAM DRIP/SEAL A-1,2,3', quantity: '1,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'TAM PART\'G/SEAL A-1,2', quantity: '1,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'TAM D/SEAL RR RH', quantity: '2,000', note: '' },
            { name: 'TAM B/SIDE FRT RH', quantity: '4,800', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'TAM B/SIDE FRT RH', quantity: '4,800', note: '' },
            { name: 'TAM L/SEAL FR A', quantity: '2,000', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'MX5 G/RUN FRT B PP', quantity: '5,000', note: '' },
            { name: 'MX5 G/RUN RR B PP', quantity: '5,000', note: '' }
        ],
        '12/4-ì•¼': [
            { name: 'SW1 C PC', quantity: '5,000', note: '' },
            { name: 'SW1 E M', quantity: '2,400', note: '' }
        ],
        '12/5-ì£¼': [
            { name: 'LX3 C1 M', quantity: '3,000', note: '' }
        ],
        '12/5-ì•¼': []
    },
    '5í˜¸': {
        '12/1-ì£¼': [
            { name: 'ê°œë°œ 08:30~09:30', quantity: '1ì‹œê°„', note: '' },
            { name: 'RG3 B/SIDE FRT', quantity: '2,800', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'RG3 B/SIDE RR', quantity: '2,800', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'ê°œë°œ 08:30~10:00', quantity: '1.5ì‹œê°„', note: '' },
            { name: 'LX3 RR LH (3)', quantity: '1,500', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'LX3 FRT LH (1)', quantity: '1,000', note: '' },
            { name: 'LX3 FRT RH (2)', quantity: '2,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'LX3 RR LH (3)', quantity: '1,500', note: '' },
            { name: 'LX3 RR RH (4)', quantity: '1,500', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'LX3 FRT LH (1)', quantity: '2,000', note: '' },
            { name: 'LX3 FRT RH (2)', quantity: '1,000', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'LX3 RR LH (3)', quantity: '1,500', note: '' },
            { name: 'LX3 RR RH (4)', quantity: '1,500', note: '' }
        ],
        '12/4-ì•¼': [
            { name: 'RG3 RR PC', quantity: '1,600', note: '' },
            { name: 'DH RR PC', quantity: '400', note: '' }
        ],
        '12/5-ì£¼': [
            { name: 'ë¹„ê°€ë™', quantity: '', note: '' }
        ],
        '12/5-ì•¼': []
    },
    '6í˜¸': {
        '12/1-ì£¼': [
            { name: 'DL3 B/SIDE FRT LH', quantity: '1,800', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'DL3 B/SIDE FRT LH', quantity: '1,800', note: '' },
            { name: 'DL3 B/SIDE RR RH', quantity: '1,200', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'DL3 B/SIDE FRT RH', quantity: '2,400', note: '' },
            { name: 'DL3 B/SIDE RR RH', quantity: '600', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'DL3 B/SIDE RR RH', quantity: '3,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'DL3 B/SIDE RR LH', quantity: '3,600', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'TAM B/SIDE FRT LH', quantity: '1,200', note: '' },
            { name: 'TAM B/SIDE RR LH', quantity: '1,200', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'CM B/SIDE FRT(ì— ë³´)', quantity: '200', note: '' },
            { name: 'DM B/SIDE FRT', quantity: '400', note: '' }
        ],
        '12/4-ì•¼': [
            { name: 'HM B/SIDE RR (9P)', quantity: '400', note: '' }
        ],
        '12/5-ì£¼': [],
        '12/5-ì•¼': []
    },
    '7í˜¸': {
        '12/1-ì£¼': [
            { name: 'ê°œë°œ 08:30~11:00', quantity: '2.5ì‹œê°„', note: '' },
            { name: 'DN8 G/RUN RR "C"', quantity: '6,000', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'DN8 FRT B', quantity: '3,000', note: '' },
            { name: 'DN8 FRT A', quantity: '5,000', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'ê°œë°œ 08:30~11:00', quantity: '2.5ì‹œê°„', note: '' },
            { name: 'DN8 D', quantity: '6,000', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'CN7 C', quantity: '10,000', note: '' },
            { name: 'DN8 F', quantity: '6,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'ê°œë°œ 08:30~11:00', quantity: '2.5ì‹œê°„', note: '' },
            { name: 'DL 3 A', quantity: '5,000', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'NQ5 G/RUN FRT/RR B', quantity: '6,000', note: '' },
            { name: 'DN8 D', quantity: '6,000', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'ê°œë°œ 08:30~12:30', quantity: '4ì‹œê°„', note: '' },
            { name: 'DN8 B', quantity: '1,500', note: '' }
        ],
        '12/4-ì•¼': [
            { name: 'DN8 C', quantity: '6,000', note: '' },
            { name: 'DN8 F', quantity: '6,000', note: '' }
        ],
        '12/5-ì£¼': [
            { name: 'DL3 FRT B', quantity: '2,000', note: '' }
        ],
        '12/5-ì•¼': []
    },
    '8í˜¸': {
        '12/1-ì£¼': [
            { name: 'SX2 D/SIDE FRT A', quantity: '5,000', note: '' },
            { name: 'SX2 D/SIDE RR A', quantity: '5,000', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'SX2 D/SIDE RR A', quantity: '4,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'DL3 PE D/SIDE RR F', quantity: '8,000', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'DL3 PE D/SIDE FRT A', quantity: '8,000', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'ê°œë°œ 17:00~19:00', quantity: '2ì‹œê°„', note: '' },
            { name: 'LX3 F C/SEAL', quantity: '12,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'RG3 D/SIDE', quantity: '14,000', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'DL 3 B', quantity: '14,000', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'ê°œë°œ 13:30~15:00', quantity: '1.5ì‹œê°„', note: '' },
            { name: 'J100 HOOD A', quantity: '4,000', note: '' }
        ],
        '12/4-ì•¼': [
            { name: 'DL 3 B', quantity: '14,000', note: '' }
        ],
        '12/5-ì£¼': [
            { name: 'SX2 D/S RR A', quantity: '2,000', note: '' }
        ],
        '12/5-ì•¼': []
    },
    '9í˜¸': {
        '12/1-ì£¼': [
            { name: 'NEa G/RUN FRT B', quantity: '2,000', note: '' },
            { name: 'NEa G/RUN RR B-1', quantity: '2,000', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'ë¹„ê°€ë™', quantity: '', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'X100 FRT/RR B', quantity: '3,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' }
        ],
        '12/2-ì•¼': [
            { name: 'SW1 G/RUN FRT B', quantity: '5,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'LX3 FRT E M', quantity: '7,200', note: '' },
            { name: 'CM B', quantity: '200', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'Nea FRT E PC', quantity: '2,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'NEA RR D PC', quantity: '2,000', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'YB E M', quantity: '2,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'EU B', quantity: '1,000', note: '' }
        ],
        '12/4-ì•¼': [
            { name: 'TK1 FRT A PC', quantity: '2,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'TK1 RR A PC', quantity: '2,000', note: '' }
        ],
        '12/5-ì£¼': [
            { name: 'ë¹„ê°€ë™', quantity: '', note: '' }
        ],
        '12/5-ì•¼': []
    },
    '10í˜¸': {
        '12/1-ì£¼': [
            { name: 'SW1 G/RUN FRT A', quantity: '5,000', note: '' },
            { name: 'HR CHNL A-1', quantity: '9,000', note: '' }
        ],
        '12/1-ì•¼': [],
        '12/2-ì£¼': [],
        '12/2-ì•¼': [
            { name: 'ê°œë°œ 13:30~15:00', quantity: '1.5ì‹œê°„', note: '' },
            { name: 'DN8 E', quantity: '5,000', note: '' }
        ],
        '12/3-ì£¼': [],
        '12/3-ì•¼': [
            { name: 'SP2 CHNL', quantity: '10,000', note: '' }
        ],
        '12/4-ì£¼': [],
        '12/4-ì•¼': [],
        '12/5-ì£¼': [],
        '12/5-ì•¼': []
    },
    '11í˜¸': {
        '12/1-ì£¼': [
            { name: 'SG2 G/RUN RR D', quantity: '5,000', note: '' }
        ],
        '12/1-ì•¼': [],
        '12/2-ì£¼': [
            { name: 'DL3 (C/SEAL)', quantity: '8,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'DL3 (P/SEAL)', quantity: '8,000', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'NQ5 G/RUN FRT A', quantity: '4,050', note: '' },
            { name: 'NQ5 G/RUN RR A', quantity: '5,400', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'CN7 A M', quantity: '7,000', note: '' },
            { name: 'CN7 G/RUN FRT E M', quantity: '5,000', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'CN7 A M', quantity: '10,000', note: '' },
            { name: 'RG3 L/SEAL FRT A', quantity: '4,000', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'CN7 A M', quantity: '5,000', note: '' },
            { name: 'ë¹„ê°€ë™', quantity: '', note: '' }
        ],
        '12/4-ì•¼': [
            { name: 'SG2 G/RUN RR B', quantity: '3,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'SG2 G/RUN FRT E', quantity: '3,600', note: '' }
        ],
        '12/5-ì£¼': [],
        '12/5-ì•¼': []
    },
    '12í˜¸': {
        '12/1-ì£¼': [
            { name: 'LX3 G/RUN FRT A-1', quantity: '10,000', note: '' }
        ],
        '12/1-ì•¼': [
            { name: 'LX3 G/RUN RR A-3', quantity: '7,000', note: '' }
        ],
        '12/2-ì£¼': [
            { name: 'LX3 G/RUN RR A-3', quantity: '5,000', note: '' },
            { name: 'MX5 G/RUN RR A-1', quantity: '3,000', note: '' }
        ],
        '12/2-ì•¼': [
            { name: 'ê°œë°œ 08:30~09:30', quantity: '1ì‹œê°„', note: '' },
            { name: 'MX5 G/RUN FRT A-2', quantity: '7,000', note: '' }
        ],
        '12/3-ì£¼': [
            { name: 'IG PE FRT A', quantity: '300', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' },
            { name: 'QL G/RUN FRT/RR A', quantity: '500', note: '' }
        ],
        '12/3-ì•¼': [
            { name: 'SP2 A', quantity: '8,000', note: '' }
        ],
        '12/4-ì£¼': [
            { name: 'SP2 RR D', quantity: '2,000', note: '' },
            { name: '', quantity: '', note: 'ì¤‘ì‹ëŒ€ì‘' }
        ],
        '12/4-ì•¼': [],
        '12/5-ì£¼': [],
        '12/5-ì•¼': []
    }
};

// localStorageì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
function loadProductionData() {
    const saved = localStorage.getItem('productionData');
    if (saved) {
        try {
            return JSON.parse(saved);
        } catch (e) {
            console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', e);
            // localStorage íŒŒì‹± ì‹¤íŒ¨ ì‹œ embedded ë°ì´í„° ë˜ëŠ” ì´ˆê¸° ë°ì´í„° ì‚¬ìš©
            if (typeof embeddedProductionData !== 'undefined') {
                return JSON.parse(JSON.stringify(embeddedProductionData));
            }
            return JSON.parse(JSON.stringify(initialProductionData));
        }
    }
    // localStorageê°€ ë¹„ì–´ìˆìœ¼ë©´ embedded ë°ì´í„° ì‚¬ìš©
    if (typeof embeddedProductionData !== 'undefined') {
        return JSON.parse(JSON.stringify(embeddedProductionData));
    }
    return JSON.parse(JSON.stringify(initialProductionData));
}

// localStorageì— ë°ì´í„° ì €ì¥
function saveProductionData() {
    try {
        localStorage.setItem('productionData', JSON.stringify(currentWeekData));
    } catch (e) {
        console.error('ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', e);
    }
}

let currentWeekData = loadProductionData();
let draggedWorkItem = null;
let draggedFromCell = null;

function sortWorkItems(items) {
    // ê°œë°œ í•­ëª©ì„ ë§¨ ë’¤ë¡œ ì •ë ¬
    const devItems = [];
    const otherItems = [];
    
    items.forEach(item => {
        if (item.name && item.name.includes('ê°œë°œ')) {
            devItems.push(item);
        } else {
            otherItems.push(item);
        }
    });
    
    return [...otherItems, ...devItems];
}

function renderProductionTable() {
    const tbody = document.getElementById('production-tbody');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    
    // ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„°ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¡œë“œ
    if (!extrusionPlanData || extrusionPlanData.length === 0) {
        loadExtrusionPlanData().then(() => {
            renderProductionTable();
        });
        return;
    }
    
    // ì‘ì—…ì¥ë³„ë¡œ ê·¸ë£¹í™”
    const workplaceGroups = {};
    extrusionPlanData.forEach(item => {
        if (!item.workplace) return;
        if (!workplaceGroups[item.workplace]) {
            workplaceGroups[item.workplace] = [];
        }
        workplaceGroups[item.workplace].push(item);
    });
    
    // ì‘ì—…ì¥ ì •ë ¬ (ì••ì¶œ#01 ~ ì••ì¶œ#12)
    const sortedWorkplaces = Object.keys(workplaceGroups).sort((a, b) => {
        const numA = parseInt(a.replace('ì••ì¶œ#', '')) || 0;
        const numB = parseInt(b.replace('ì••ì¶œ#', '')) || 0;
        return numA - numB;
    });
    
    const dates = ['12/1', '12/2', '12/3', '12/4', '12/5'];
    const shiftMap = { 'day': 'ì£¼', 'night': 'ì•¼' };
    
    sortedWorkplaces.forEach(workplace => {
        const row = document.createElement('tr');
        
        // í˜¸ê¸°ëª… (ì••ì¶œ#01 -> 1í˜¸)
        const machineNum = parseInt(workplace.replace('ì••ì¶œ#', '')) || 0;
        const machineCell = document.createElement('td');
        machineCell.className = 'machine-cell';
        machineCell.textContent = `${machineNum}í˜¸`;
        row.appendChild(machineCell);
        
        // ê° ë‚ ì§œì˜ ì£¼/ì•¼ ì…€
        dates.forEach(date => {
            // ì£¼ê°„ ì…€
            const dayCell = document.createElement('td');
            dayCell.className = 'shift-cell day-shift-bg';
            dayCell.dataset.workplace = workplace;
            dayCell.dataset.date = date;
            dayCell.dataset.shift = 'ì£¼';
            
            // í•´ë‹¹ ì‘ì—…ì¥, ë‚ ì§œ, ì£¼ê°„ì˜ ë°ì´í„° ì°¾ê¸°
            const dayItems = [];
            workplaceGroups[workplace].forEach(item => {
                if (item.productionQuantity && item.productionQuantity[date] && item.productionQuantity[date].day > 0) {
                    const unit = (item.unit === 'ST') ? 'PC' : item.unit;
                    dayItems.push({
                        name: item.materialDetail,
                        quantity: item.productionQuantity[date].day.toLocaleString(),
                        unit: unit,
                        materialNum: item.materialNum,
                        shift: 'day',
                        originalDate: date
                    });
                }
            });
            
            if (dayItems.length === 0) {
                    const emptyDiv = document.createElement('div');
                    emptyDiv.className = 'empty-cell';
                dayCell.appendChild(emptyDiv);
                } else {
                dayItems.forEach((item, index) => {
                    const workDiv = createExtrusionWorkItemForWeeklyTable(item, workplace, date, 'day', index);
                    dayCell.appendChild(workDiv);
                    });
                }
                
                // ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
            dayCell.addEventListener('dragover', handleExtrusionProductionDragOver);
            dayCell.addEventListener('drop', handleExtrusionProductionDrop);
            dayCell.addEventListener('dragleave', handleExtrusionProductionDragLeave);
            
            row.appendChild(dayCell);
            
            // ì•¼ê°„ ì…€
            const nightCell = document.createElement('td');
            nightCell.className = 'shift-cell night-shift-bg';
            nightCell.dataset.workplace = workplace;
            nightCell.dataset.date = date;
            nightCell.dataset.shift = 'ì•¼';
            
            // í•´ë‹¹ ì‘ì—…ì¥, ë‚ ì§œ, ì•¼ê°„ì˜ ë°ì´í„° ì°¾ê¸°
            const nightItems = [];
            workplaceGroups[workplace].forEach(item => {
                if (item.productionQuantity && item.productionQuantity[date] && item.productionQuantity[date].night > 0) {
                    const unit = (item.unit === 'ST') ? 'PC' : item.unit;
                    nightItems.push({
                        name: item.materialDetail,
                        quantity: item.productionQuantity[date].night.toLocaleString(),
                        unit: unit,
                        materialNum: item.materialNum,
                        shift: 'night',
                        originalDate: date
                    });
                }
            });
            
            if (nightItems.length === 0) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'empty-cell';
                nightCell.appendChild(emptyDiv);
            } else {
                nightItems.forEach((item, index) => {
                    const workDiv = createExtrusionWorkItemForWeeklyTable(item, workplace, date, 'night', index);
                    nightCell.appendChild(workDiv);
                });
            }
            
            // ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
            nightCell.addEventListener('dragover', handleExtrusionProductionDragOver);
            nightCell.addEventListener('drop', handleExtrusionProductionDrop);
            nightCell.addEventListener('dragleave', handleExtrusionProductionDragLeave);
            
            row.appendChild(nightCell);
        });
        
        tbody.appendChild(row);
    });
}

function createWorkItemElement(item, machine, cellKey, index) {
    const workDiv = document.createElement('div');
    
    // ëª¨ë“  í•­ëª©ì„ ë“œë˜ê·¸ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •
    workDiv.className = 'work-item';
    workDiv.draggable = true;
    workDiv.dataset.machine = machine;
    workDiv.dataset.cellKey = cellKey;
    workDiv.dataset.index = index;
    
    // ë…¸íŠ¸ë§Œ ìˆëŠ” ê²½ìš° (ì˜ˆ: ì¤‘ì‹ëŒ€ì‘)
    if (!item.name && !item.quantity && item.note) {
        workDiv.style.borderLeft = '3px solid #e74c3c';
        const noteSpan = document.createElement('span');
        noteSpan.className = 'work-item-note';
        noteSpan.textContent = item.note;
        noteSpan.style.display = 'inline';
        noteSpan.style.fontStyle = 'normal';
        workDiv.appendChild(noteSpan);
        workDiv.title = item.note;
    } else {
        // ê°œë°œ í•­ëª©ì¸ì§€ ì²´í¬
        const isDevelopment = item.name && item.name.includes('ê°œë°œ');
        const isIdle = item.name && (item.name === 'ë¹„ê°€ë™' || item.name.includes('ë¹„ê°€ë™'));
        
        if (isDevelopment) {
            workDiv.style.borderLeft = '3px solid #2980b9';
            workDiv.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
            workDiv.style.color = '#ffffff';
            workDiv.style.cursor = 'pointer';
            
            // ê°œë°œ í•­ëª© í´ë¦­ ì‹œ ì‹œì‘ì‹œê°„ ì„¤ì •
            workDiv.addEventListener('click', function(e) {
                e.stopPropagation();
                openStartTimeModal(machine, cellKey, index, item);
            });
        } else if (isIdle) {
            workDiv.style.borderLeft = '3px solid #95a5a6';
            workDiv.style.background = 'linear-gradient(135deg, #ecf0f1, #d5d8dc)';
        }
        
        // ì´ë¦„ê³¼ ìˆ˜ëŸ‰ì„ í•œ ì¤„ë¡œ í‘œì‹œ
        let text = '';
        if (item.name) {
            const nameSpan = document.createElement('span');
            nameSpan.className = 'work-item-name';
            nameSpan.textContent = item.name;
            if (isDevelopment) {
                nameSpan.style.color = '#ffffff';
            }
            workDiv.appendChild(nameSpan);
            text += item.name;
        }
        
        if (item.quantity) {
            const quantitySpan = document.createElement('span');
            quantitySpan.className = 'work-item-quantity';
            quantitySpan.textContent = item.quantity;
            if (isDevelopment) {
                quantitySpan.style.color = '#ffffff';
            }
            workDiv.appendChild(quantitySpan);
            text += ' ' + item.quantity;
        }
        
        // title ì†ì„±ìœ¼ë¡œ ì „ì²´ í…ìŠ¤íŠ¸ í‘œì‹œ (í˜¸ë²„ ì‹œ)
        workDiv.title = text;
        
        if (item.note) {
            const noteDiv = document.createElement('div');
            noteDiv.className = 'work-item-note';
            noteDiv.textContent = item.note;
            workDiv.appendChild(noteDiv);
        }
    }
    
    // ë“œë˜ê·¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
    workDiv.addEventListener('dragstart', handleProductionDragStart);
    workDiv.addEventListener('dragend', handleProductionDragEnd);
    
    return workDiv;
}

function handleProductionDragStart(e) {
    const workItem = e.target;
    draggedWorkItem = {
        machine: workItem.dataset.machine,
        cellKey: workItem.dataset.cellKey,
        index: parseInt(workItem.dataset.index),
        data: currentWeekData[workItem.dataset.machine][workItem.dataset.cellKey][workItem.dataset.index]
    };
    draggedFromCell = workItem.parentElement;
    
    workItem.classList.add('dragging');
    e.dataTransfer.effectAllowed = 'move';
}

function handleProductionDragEnd(e) {
    e.target.classList.remove('dragging');
    document.querySelectorAll('.shift-cell').forEach(cell => {
        cell.classList.remove('drag-over');
    });
}

function handleProductionDragOver(e) {
    e.preventDefault();
    e.dataTransfer.dropEffect = 'move';
    
    const cell = e.currentTarget;
    if (cell.classList.contains('shift-cell')) {
        cell.classList.add('drag-over');
    }
    return false;
}

function handleProductionDragLeave(e) {
    e.currentTarget.classList.remove('drag-over');
}

function handleProductionDrop(e) {
    e.stopPropagation();
    e.preventDefault();
    
    const targetCell = e.currentTarget;
    targetCell.classList.remove('drag-over');
    
    if (!draggedWorkItem) return false;
    
    const targetMachine = targetCell.dataset.machine;
    const targetCellKey = targetCell.dataset.cellKey;
    
    // ê°™ì€ í˜¸ê¸° ë‚´ì—ì„œë§Œ ì´ë™ ê°€ëŠ¥
    if (draggedWorkItem.machine !== targetMachine) {
        alert('ê°™ì€ í˜¸ê¸° ë‚´ì—ì„œë§Œ ì‘ì—…ì„ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        return false;
    }
    
    // ì›ë˜ ìœ„ì¹˜ì—ì„œ ì œê±°
    const fromArray = currentWeekData[draggedWorkItem.machine][draggedWorkItem.cellKey];
    const movedItem = fromArray.splice(draggedWorkItem.index, 1)[0];
    
    // ìƒˆ ìœ„ì¹˜ì— ì¶”ê°€ (ë§¨ ë’¤)
    if (!currentWeekData[targetMachine][targetCellKey]) {
        currentWeekData[targetMachine][targetCellKey] = [];
    }
    currentWeekData[targetMachine][targetCellKey].push(movedItem);
    
    // ë°ì´í„° ì €ì¥
    saveProductionData();
    
    // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
    renderProductionTable();
    
    
    draggedWorkItem = null;
    draggedFromCell = null;
    return false;
}

// work-itemì— ì§ì ‘ ë“œë¡­í•˜ëŠ” ê²½ìš°ì˜ í•¸ë“¤ëŸ¬
function handleWorkItemDragOver(e) {
    e.preventDefault();
    e.stopPropagation();
    e.dataTransfer.dropEffect = 'move';
    
    const workItem = e.currentTarget;
    
    // ë“œë˜ê·¸ ì¤‘ì¸ í•­ëª©ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ í•˜ì´ë¼ì´íŠ¸
    if (!workItem.classList.contains('dragging')) {
        // ë§ˆìš°ìŠ¤ ìœ„ì¹˜ì— ë”°ë¼ ìœ„/ì•„ë˜ í‘œì‹œ
        const rect = workItem.getBoundingClientRect();
        const midpoint = rect.top + rect.height / 2;
        
        if (e.clientY < midpoint) {
            workItem.style.borderTop = '2px solid var(--primary-500)';
            workItem.style.borderBottom = '';
            workItem.dataset.dropPosition = 'before';
        } else {
            workItem.style.borderTop = '';
            workItem.style.borderBottom = '2px solid var(--primary-500)';
            workItem.dataset.dropPosition = 'after';
        }
    }
    
    return false;
}

function handleWorkItemDragLeave(e) {
    const workItem = e.currentTarget;
    workItem.style.borderTop = '';
    workItem.style.borderBottom = '';
    delete workItem.dataset.dropPosition;
}

function handleWorkItemDrop(e) {
    e.stopPropagation();
    e.preventDefault();
    
    const targetWorkItem = e.currentTarget;
    targetWorkItem.style.borderTop = '';
    targetWorkItem.style.borderBottom = '';
    
    if (!draggedWorkItem) return false;
    
    const targetMachine = targetWorkItem.dataset.machine;
    const targetCellKey = targetWorkItem.dataset.cellKey;
    const targetIndex = parseInt(targetWorkItem.dataset.index);
    const dropPosition = targetWorkItem.dataset.dropPosition || 'after';
    
    delete targetWorkItem.dataset.dropPosition;
    
    // ê°™ì€ í˜¸ê¸° ë‚´ì—ì„œë§Œ ì´ë™ ê°€ëŠ¥
    if (draggedWorkItem.machine !== targetMachine) {
        alert('ê°™ì€ í˜¸ê¸° ë‚´ì—ì„œë§Œ ì‘ì—…ì„ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        return false;
    }
    
    // ì›ë˜ ìœ„ì¹˜ì—ì„œ ì œê±°
    const fromArray = currentWeekData[draggedWorkItem.machine][draggedWorkItem.cellKey];
    const movedItem = fromArray.splice(draggedWorkItem.index, 1)[0];
    
    // ìƒˆ ìœ„ì¹˜ ê³„ì‚°
    if (!currentWeekData[targetMachine][targetCellKey]) {
        currentWeekData[targetMachine][targetCellKey] = [];
    }
    
    const toArray = currentWeekData[targetMachine][targetCellKey];
    
    // ê°™ì€ ì…€ ë‚´ì—ì„œ ì´ë™í•˜ëŠ” ê²½ìš° ì¸ë±ìŠ¤ ì¡°ì •
    let insertIndex = targetIndex;
    if (draggedWorkItem.cellKey === targetCellKey && draggedWorkItem.index < targetIndex) {
        insertIndex--;
    }
    
    // ìœ„/ì•„ë˜ ìœ„ì¹˜ì— ë”°ë¼ ì‚½ì…
    if (dropPosition === 'before') {
        toArray.splice(insertIndex, 0, movedItem);
    } else {
        toArray.splice(insertIndex + 1, 0, movedItem);
    }
    
    // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
    renderProductionTable();
    
    
    draggedWorkItem = null;
    draggedFromCell = null;
    return false;
}

function changeWeek(direction) {
    // ì£¼ì°¨ ë³€ê²½ ë¡œì§ (í˜„ì¬ëŠ” ë”ë¯¸)
    alert('ì£¼ì°¨ ë³€ê²½ ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
}

// ê°œë°œ ì¶”ê°€ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
let dateRowCount = 0;

function openDevModal() {
    const modal = document.getElementById('dev-modal');
    modal.classList.add('active');
    
    // ì²« ë²ˆì§¸ ë‚ ì§œ í–‰ ì¶”ê°€
    dateRowCount = 0;
    document.getElementById('date-rows-container').innerHTML = '';
    addDateRow();
}

function closeDevModal() {
    const modal = document.getElementById('dev-modal');
    modal.classList.remove('active');
    
    // í¼ ì´ˆê¸°í™”
    document.getElementById('dev-machine').value = '1í˜¸';
    document.getElementById('dev-section').value = '';
    document.getElementById('date-rows-container').innerHTML = '';
    dateRowCount = 0;
}

function addDateRow() {
    const container = document.getElementById('date-rows-container');
    const rowId = `date-row-${dateRowCount}`;
    
    // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
    const today = new Date();
    const year = today.getFullYear();
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const day = String(today.getDate()).padStart(2, '0');
    const todayStr = `${year}-${month}-${day}`;
    
    const rowHTML = `
        <div class="date-row" id="${rowId}">
            <div class="date-row-field">
                <label>ë‚ ì§œ</label>
                <input type="date" class="date-input" value="${todayStr}">
            </div>
            <div class="date-row-field">
                <label>í•„ìš” ì‹œê°„</label>
                <input type="number" class="hours-input" placeholder="ì˜ˆ: 3 ë˜ëŠ” 1.5" step="0.5" min="0.5">
            </div>
            <div class="date-row-field">
                <label>ì‹œì‘ ì‹œê°„ (ì„ íƒ)</label>
                <div style="display: flex; gap: 5px; align-items: center;">
                    <input type="number" class="start-hour-input" placeholder="08" min="0" max="23" style="width: 50px; text-align: center; padding: 8px 4px;">
                    <span>:</span>
                    <input type="number" class="start-minute-input" placeholder="30" min="0" max="59" step="5" style="width: 50px; text-align: center; padding: 8px 4px;">
                </div>
            </div>
            <button type="button" class="remove-date-btn" onclick="removeDateRow('${rowId}')">ì‚­ì œ</button>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', rowHTML);
    dateRowCount++;
}

function removeDateRow(rowId) {
    const row = document.getElementById(rowId);
    if (row) {
        row.remove();
    }
    
    // ìµœì†Œ 1ê°œëŠ” ë‚¨ê¸°ê¸°
    const container = document.getElementById('date-rows-container');
    if (container.children.length === 0) {
        addDateRow();
    }
}

// ì••ì¶œ ìƒì‚°ê³„íšìš© ê°œë°œ ì¶”ê°€ ëª¨ë‹¬ ì—´ê¸°
// ì¤‘ì‹ëŒ€ì‘ ì¶”ê°€ ëª¨ë‹¬ ì—´ê¸°
function openExtrusionLunchBreakModal() {
    const modal = document.getElementById('lunch-break-modal');
    modal.classList.add('active');
}

function closeLunchBreakModal() {
    const modal = document.getElementById('lunch-break-modal');
    modal.classList.remove('active');
    
    // í¼ ì´ˆê¸°í™”
    document.querySelectorAll('.lunch-workplace-checkbox').forEach(cb => {
        cb.checked = false;
    });
    document.getElementById('lunch-date').value = '12/1';
    document.getElementById('lunch-shift').value = 'day';
    document.getElementById('lunch-type').value = 'ì¤‘ì‹ëŒ€ì‘';
}

// ì¤‘ì‹ëŒ€ì‘ ëª¨ë‹¬ ì—´ ë•Œ ì²´í¬ë°•ìŠ¤ ìµœëŒ€ 3ê°œ ì œí•œ ì„¤ì •
document.addEventListener('DOMContentLoaded', function() {
    const checkboxes = document.querySelectorAll('.lunch-workplace-checkbox');
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
            const checked = document.querySelectorAll('.lunch-workplace-checkbox:checked');
            if (checked.length > 3) {
                this.checked = false;
                alert('ì‘ì—…ì¥ì€ ìµœëŒ€ 3ê°œê¹Œì§€ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        });
    });
});

function addLunchBreakItem() {
    const checkedBoxes = document.querySelectorAll('.lunch-workplace-checkbox:checked');
    const date = document.getElementById('lunch-date').value;
    const shift = document.getElementById('lunch-shift').value;
    const lunchType = document.getElementById('lunch-type').value;
    
    // ì‘ì—…ì¥ ì„ íƒ í™•ì¸
    if (checkedBoxes.length === 0) {
        alert('ìµœì†Œ 1ê°œ ì´ìƒì˜ ì‘ì—…ì¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
    }
    
    if (checkedBoxes.length > 3) {
        alert('ì‘ì—…ì¥ì€ ìµœëŒ€ 3ê°œê¹Œì§€ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        return;
    }
    
    // ì„ íƒëœ ëª¨ë“  ì‘ì—…ì¥ì— ëŒ€í•´ ì¤‘ì‹ëŒ€ì‘ ì¶”ê°€
    const shiftKey = shift === 'day' ? 'day' : 'night';
    let addedCount = 0;
    
    checkedBoxes.forEach(checkbox => {
        const workplace = checkbox.value;
        
        // ë°ì´í„° êµ¬ì¡° ì´ˆê¸°í™”
        if (!extrusionLunchBreakData[workplace]) {
            extrusionLunchBreakData[workplace] = {};
        }
        if (!extrusionLunchBreakData[workplace][date]) {
            extrusionLunchBreakData[workplace][date] = { day: [], night: [] };
        }
        
        // ì¤‘ì‹ëŒ€ì‘ í•­ëª© ì¶”ê°€
        extrusionLunchBreakData[workplace][date][shiftKey].push(lunchType);
        addedCount++;
    });
    
    // ë°ì´í„° ì €ì¥
    saveExtrusionLunchBreakData();
    
    // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
    renderExtrusionPlanProductionTable();
    
    // ëª¨ë‹¬ ë‹«ê¸°
    closeLunchBreakModal();
    
    alert(`${addedCount}ê°œ ì‘ì—…ì¥ì— ì¤‘ì‹ëŒ€ì‘ í•­ëª©ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
}

function removeLunchBreakItem(workplace, date, shift, index) {
    const shiftKey = shift === 'day' ? 'day' : 'night';
    
    if (extrusionLunchBreakData[workplace] && 
        extrusionLunchBreakData[workplace][date] && 
        extrusionLunchBreakData[workplace][date][shiftKey]) {
        extrusionLunchBreakData[workplace][date][shiftKey].splice(index, 1);
        
        // ë¹ˆ ë°°ì—´ì´ë©´ ë‚ ì§œ ê°ì²´ ì •ë¦¬
        if (extrusionLunchBreakData[workplace][date][shiftKey].length === 0) {
            delete extrusionLunchBreakData[workplace][date][shiftKey];
        }
        
        // ë‚ ì§œ ê°ì²´ê°€ ë¹„ì–´ìˆìœ¼ë©´ ì œê±°
        if (Object.keys(extrusionLunchBreakData[workplace][date]).length === 0) {
            delete extrusionLunchBreakData[workplace][date];
        }
        
        // ì‘ì—…ì¥ ê°ì²´ê°€ ë¹„ì–´ìˆìœ¼ë©´ ì œê±°
        if (Object.keys(extrusionLunchBreakData[workplace]).length === 0) {
            delete extrusionLunchBreakData[workplace];
        }
        
        // ë°ì´í„° ì €ì¥
        saveExtrusionLunchBreakData();
        
        // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
        renderExtrusionPlanProductionTable();
    }
}

function openExtrusionDevModal() {
    const modal = document.getElementById('dev-modal');
    modal.classList.add('active');
    modal.dataset.mode = 'extrusion'; // ì••ì¶œ ìƒì‚°ê³„íš ëª¨ë“œ í‘œì‹œ
    
    // ì²« ë²ˆì§¸ ë‚ ì§œ í–‰ ì¶”ê°€
    dateRowCount = 0;
    document.getElementById('date-rows-container').innerHTML = '';
    addDateRow();
}

function addDevWork() {
    const machine = document.getElementById('dev-machine').value;
    const section = document.getElementById('dev-section').value;
    const modal = document.getElementById('dev-modal');
    const isExtrusionMode = modal.dataset.mode === 'extrusion';
    
    // ìœ íš¨ì„± ê²€ì‚¬
    if (!machine || !section) {
        alert('í˜¸ê¸°ì™€ ê°œë°œ ë‹¨ë©´ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
    }
    
    // ëª¨ë“  ë‚ ì§œ í–‰ ìˆ˜ì§‘
    const dateRows = document.querySelectorAll('.date-row');
    const devDates = [];
    
    dateRows.forEach(row => {
        const dateInput = row.querySelector('.date-input').value;
        const hours = row.querySelector('.hours-input').value;
        const startHour = row.querySelector('.start-hour-input').value;
        const startMinute = row.querySelector('.start-minute-input').value;
        
        let startTime = '';
        if (startHour && startMinute) {
            startTime = `${String(startHour).padStart(2, '0')}:${String(startMinute).padStart(2, '0')}`;
        }
        
        if (dateInput && hours) {
            devDates.push({ dateInput, hours, startTime });
        }
    });
    
    if (devDates.length === 0) {
        alert('ìµœì†Œ í•˜ë‚˜ì˜ ë‚ ì§œì™€ ì‹œê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
    }
    
    if (isExtrusionMode) {
        // ì••ì¶œ ìƒì‚°ê³„íšìš© ê°œë°œ ì¶”ê°€
        const machineNum = parseInt(machine.replace('í˜¸', '')) || 0;
        const workplaceKey = `ì••ì¶œ#${String(machineNum).padStart(2, '0')}`;
        
        devDates.forEach(({ dateInput, hours, startTime }) => {
            const dateParts = dateInput.split('-');
            const year = parseInt(dateParts[0]);
            const month = parseInt(dateParts[1]);
            const day = parseInt(dateParts[2]);
            const dateKey = `${month}/${day}`;
            
            let timeText = '';
            if (startTime) {
                const endTime = calculateEndTime(startTime, parseFloat(hours));
                timeText = `${startTime}~${endTime}`;
            } else {
                timeText = `${hours}ì‹œê°„`;
            }
            
            // ê°œë°œ ë°ì´í„° êµ¬ì¡° ì´ˆê¸°í™”
            if (!extrusionDevData[workplaceKey]) {
                extrusionDevData[workplaceKey] = {};
            }
            if (!extrusionDevData[workplaceKey][dateKey]) {
                extrusionDevData[workplaceKey][dateKey] = { day: [], night: [] };
            }
            
            // ê°œë°œ í•­ëª© ì¶”ê°€ (ì£¼ê°„ì—ë§Œ ì¶”ê°€, í•„ìš”ì‹œ ì•¼ê°„ë„ ì§€ì› ê°€ëŠ¥)
            extrusionDevData[workplaceKey][dateKey].day.push({
                section: section,
                timeText: timeText
            });
            
            // ì••ì¶œ ìƒì‚°ê³„íš ìº˜ë¦°ë” ë°ì´í„°ì— ì¶”ê°€
            const calendarDateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            const calendarEventDetail = `${workplaceKey} ${section} ê°œë°œ ${timeText}`;
            
            // calendarDataì— ì¶”ê°€ (extractCalendarDataFromTableì—ì„œ ì‚¬ìš©)
            calendarData.push({
                date: calendarDateStr,
                detail: calendarEventDetail,
                type: 'development',
                workplace: workplaceKey
            });
        });
        
        // ê°œë°œ ë°ì´í„° ì €ì¥
        saveExtrusionDevData();
        
        // ì••ì¶œ ìƒì‚°ê³„íš í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
        renderExtrusionPlanProductionTable();
        
        // ì••ì¶œ ìƒì‚°ê³„íš ìº˜ë¦°ë” ë‹¤ì‹œ ë Œë”ë§
        if (document.getElementById('extrusion-plan-calendar-grid')) {
            renderExtrusionPlanCalendar();
        }
        
        // ëª¨ë‹¬ ë‹«ê¸°
        closeDevModal();
        delete modal.dataset.mode;
        
        alert(`${machine}ì— ${devDates.length}ê°œì˜ ê°œë°œ ì‘ì—…ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\nìº˜ë¦°ë”ì—ë„ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        return;
    }
    
    // ê¸°ì¡´ ì£¼ê°„ ìƒì‚°ê³„íšìš© ê°œë°œ ì¶”ê°€ ë¡œì§
    devDates.forEach(({ dateInput, hours, startTime }) => {
        // ë‚ ì§œ íŒŒì‹±
        const dateParts = dateInput.split('-');
        const year = parseInt(dateParts[0]);
        const month = parseInt(dateParts[1]);
        const day = parseInt(dateParts[2]);
        const dateKey = `${month}/${day}`;
        
        // ì‹œê°„ í…ìŠ¤íŠ¸ ìƒì„±
        let timeText = '';
        if (startTime) {
            const endTime = calculateEndTime(startTime, parseFloat(hours));
            timeText = `${startTime}~${endTime}`;
        } else {
            timeText = `${hours}ì‹œê°„`;
        }
        
        // ê°œë°œ ì‘ì—… í•­ëª© ìƒì„±
        const devItem = {
            name: `ê°œë°œ ${timeText}`,
            quantity: section,
            note: '',
            devHours: parseFloat(hours),
            devStartTime: startTime || ''
        };
        
        // ì£¼ê°„ ì…€ì— ì¶”ê°€
        const cellKey = `${dateKey}-ì£¼`;
        
        // í•´ë‹¹ í˜¸ê¸°ì™€ ë‚ ì§œê°€ ë°ì´í„°ì— ì—†ìœ¼ë©´ ìƒì„±
        if (!currentWeekData[machine]) {
            currentWeekData[machine] = {};
        }
        if (!currentWeekData[machine][cellKey]) {
            currentWeekData[machine][cellKey] = [];
        }
        
        // ë§¨ ë’¤ì— ì¶”ê°€ (ê°œë°œì€ í•­ìƒ ì œì¼ ë§ˆì§€ë§‰)
        currentWeekData[machine][cellKey].push(devItem);
        
        // ìº˜ë¦°ë”ì—ë„ ì¶”ê°€
        const calendarDateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        const calendarEventDetail = `${machine} ${section} ê°œë°œ ${timeText}`;
        
        calendarData.push({
            date: calendarDateStr,
            detail: calendarEventDetail
        });
    });
    
    // ë°ì´í„° ì €ì¥
    saveProductionData();
    
    // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
    renderProductionTable();
    
    // ìº˜ë¦°ë”ê°€ ì—´ë ¤ìˆìœ¼ë©´ ë‹¤ì‹œ ë Œë”ë§
    if (document.getElementById('segments')?.classList.contains('active')) {
        renderCalendar();
    }
    
    // ëª¨ë‹¬ ë‹«ê¸°
    closeDevModal();
    
    alert(`${machine}ì— ${devDates.length}ê°œì˜ ê°œë°œ ì‘ì—…ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\nìº˜ë¦°ë”ì—ë„ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
}

function calculateEndTime(startTime, hours) {
    // ì‹œì‘ ì‹œê°„ì„ ì‹œì™€ ë¶„ìœ¼ë¡œ ë¶„ë¦¬
    const [startHour, startMinute] = startTime.split(':').map(Number);
    
    // ì´ ë¶„ìœ¼ë¡œ ë³€í™˜
    let totalMinutes = startHour * 60 + startMinute;
    
    // í•„ìš” ì‹œê°„ì„ ë¶„ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì¶”ê°€
    totalMinutes += hours * 60;
    
    // ë‹¤ì‹œ ì‹œì™€ ë¶„ìœ¼ë¡œ ë³€í™˜
    const endHour = Math.floor(totalMinutes / 60);
    const endMinute = totalMinutes % 60;
    
    // í¬ë§·íŒ…
    return `${String(endHour).padStart(2, '0')}:${String(endMinute).padStart(2, '0')}`;
}

// ì‹œì‘ì‹œê°„ ì„¤ì • ëª¨ë‹¬ ê´€ë ¨ ë³€ìˆ˜
let currentDevItem = null;

function openStartTimeModal(machine, cellKey, index, item) {
    const modal = document.getElementById('start-time-modal');
    modal.classList.add('active');
    
    // í˜„ì¬ í¸ì§‘ ì¤‘ì¸ í•­ëª© ì €ì¥
    currentDevItem = { machine, cellKey, index, item };
    
    // ê°œë°œ ì •ë³´ í‘œì‹œ
    const infoDisplay = document.getElementById('dev-info-display');
    const datePart = cellKey.split('-')[0]; // "12/2"
    infoDisplay.innerHTML = `
        <div><strong>í˜¸ê¸°:</strong> ${machine}</div>
        <div><strong>ë‚ ì§œ:</strong> ${datePart}</div>
        <div><strong>ë‹¨ë©´:</strong> ${item.quantity || 'ë¯¸ì •'}</div>
        <div><strong>í•„ìš” ì‹œê°„:</strong> ${item.devHours || 'ë¯¸ì •'}ì‹œê°„</div>
    `;
    
    // ê¸°ì¡´ ì‹œì‘ì‹œê°„ì´ ìˆìœ¼ë©´ ì„¤ì •
    if (item.devStartTime) {
        const [hour, minute] = item.devStartTime.split(':');
        document.getElementById('set-start-hour').value = hour;
        document.getElementById('set-start-minute').value = minute;
    } else {
        document.getElementById('set-start-hour').value = '';
        document.getElementById('set-start-minute').value = '';
    }
}

function closeStartTimeModal() {
    const modal = document.getElementById('start-time-modal');
    modal.classList.remove('active');
    currentDevItem = null;
    document.getElementById('set-start-hour').value = '';
    document.getElementById('set-start-minute').value = '';
}

function confirmStartTime() {
    if (!currentDevItem) return;
    
    const startHour = document.getElementById('set-start-hour').value;
    const startMinute = document.getElementById('set-start-minute').value;
    
    if (!startHour || !startMinute) {
        alert('ì‹œì‘ ì‹œê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì‹œì™€ ë¶„ ëª¨ë‘ ì…ë ¥)');
        return;
    }
    
    const startTime = `${String(startHour).padStart(2, '0')}:${String(startMinute).padStart(2, '0')}`;
    
    const { machine, cellKey, index, item } = currentDevItem;
    
    // ì¢…ë£Œ ì‹œê°„ ê³„ì‚°
    const endTime = calculateEndTime(startTime, item.devHours);
    
    // í•­ëª© ì—…ë°ì´íŠ¸
    const updatedItem = {
        ...item,
        name: `ê°œë°œ ${startTime}~${endTime}`,
        devStartTime: startTime
    };
    
    // ë°ì´í„° ì—…ë°ì´íŠ¸
    currentWeekData[machine][cellKey][index] = updatedItem;
    
    // ìº˜ë¦°ë” ë°ì´í„°ë„ ì—…ë°ì´íŠ¸
    const datePart = cellKey.split('-')[0]; // "12/2"
    const [month, day] = datePart.split('/');
    const year = new Date().getFullYear();
    const calendarDateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    
    // ê¸°ì¡´ ìº˜ë¦°ë” í•­ëª© ì°¾ì•„ì„œ ì—…ë°ì´íŠ¸
    const calendarEventDetail = `${machine} ${item.quantity} ê°œë°œ ${startTime}~${endTime}`;
    const existingEventIndex = calendarData.findIndex(e => 
        e.date === calendarDateStr && 
        e.detail.includes(machine) && 
        e.detail.includes(item.quantity) &&
        e.detail.includes('ê°œë°œ')
    );
    
    if (existingEventIndex !== -1) {
        calendarData[existingEventIndex].detail = calendarEventDetail;
    }
    
    // ë°ì´í„° ì €ì¥
    saveProductionData();
    
    // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
    renderProductionTable();
    
    // ìº˜ë¦°ë”ê°€ ì—´ë ¤ìˆìœ¼ë©´ ë‹¤ì‹œ ë Œë”ë§
    if (document.getElementById('segments')?.classList.contains('active')) {
        renderCalendar();
    }
    
    
    closeStartTimeModal();
    alert('ì‹œì‘ ì‹œê°„ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
}

// ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
window.onclick = function(event) {
    const devModal = document.getElementById('dev-modal');
    const startTimeModal = document.getElementById('start-time-modal');
    const lunchBreakModal = document.getElementById('lunch-break-modal');
    
    if (event.target === devModal) {
        closeDevModal();
    }
    if (event.target === startTimeModal) {
        closeStartTimeModal();
    }
    if (event.target === lunchBreakModal) {
        closeLunchBreakModal();
    }
}

// Calendar functionality
let calendarData = [];
let currentCalendarDate = new Date();

function parseDate(dateStr) {
    if (!dateStr || dateStr.trim() === '') return null;
    const parts = dateStr.split('/');
    if (parts.length !== 2) return null;
    const month = parseInt(parts[0], 10);
    const day = parseInt(parts[1], 10);
    const year = new Date().getFullYear();
    return new Date(year, month - 1, day);
}

function extractCalendarDataFromTable() {
    calendarData = [];
    const segmentsSection = document.getElementById('segments');
    if (!segmentsSection) return;
    
    const table = segmentsSection.querySelector('table tbody');
    if (!table) return;
    
    const rows = table.querySelectorAll('tr');
    rows.forEach((row, index) => {
        const cells = row.querySelectorAll('td');
        if (cells.length >= 6) {
            const detailCell = cells[2]; // ìƒì„¸ ë‚´ìš©
            const completionDateCell = cells[5]; // ì™„ë£Œì¼
            
            // innerHTMLê³¼ textContent ëª¨ë‘ í™•ì¸í•˜ì—¬ ì •ê·œí™”
            const detailHTML = detailCell ? detailCell.innerHTML.trim() : '';
            const detailText = detailCell ? detailCell.textContent.trim() : '';
            const detail = normalizeText(detailHTML || detailText);
            
            const completionDate = completionDateCell ? completionDateCell.textContent.trim() : '';
            
            if (detail && completionDate) {
                // ê°œë°œê³¼ ì¤‘ì‹ëŒ€ì‘ë§Œ í•„í„°ë§
                const detailUpper = detail.toUpperCase();
                if (detailUpper.includes('ê°œë°œ') || detailUpper.includes('ì¤‘ì‹ëŒ€ì‘')) {
                const date = parseDate(completionDate);
                if (date) {
                    calendarData.push({
                        date: formatDateForCalendar(date),
                        detail: detail,
                            rowIndex: index, // í…Œì´ë¸” í–‰ ì¸ë±ìŠ¤ ì €ì¥
                            type: 'requirement' // ìš”ì²­ì‚¬í•­ íƒ€ì…
                    });
                    }
                }
            }
        }
    });
    
    // ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„° ì¶”ê°€
    addExtrusionDataToCalendar();
}

// ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„°ë¥¼ ìº˜ë¦°ë”ì— ì¶”ê°€ (ì „ì²´ ë°ì´í„° ì‚¬ìš©)
function addExtrusionDataToCalendar() {
    if (!extrusionPlanData || extrusionPlanData.length === 0) return;
    
    // í•„í„°ë§ëœ ë°ì´í„°ê°€ ì•„ë‹Œ ì „ì²´ ë°ì´í„°ë¥¼ ì‚¬ìš©
    extrusionPlanData.forEach(item => {
        if (!item.productionQuantity) return;
        
        Object.keys(item.productionQuantity).forEach(dateStr => {
            // dateStr í˜•ì‹: "12/1"
            const [month, day] = dateStr.split('/');
            const year = 2024; // ê³ ì •
            const date = new Date(year, parseInt(month) - 1, parseInt(day));
            const calendarDateStr = formatDateForCalendar(date);
            
            const pq = item.productionQuantity[dateStr];
            
            // ì£¼ê°„ ìˆ˜ëŸ‰
            if (pq.day > 0) {
                calendarData.push({
                    date: calendarDateStr,
                    detail: `${item.materialDetail}/${item.unit}/${pq.day.toLocaleString()}`,
                    type: 'extrusion',
                    materialNum: item.materialNum,
                    shift: 'day',
                    originalDate: dateStr,
                    materialDetail: item.materialDetail,
                    unit: item.unit,
                    quantity: pq.day
                });
            }
            
            // ì•¼ê°„ ìˆ˜ëŸ‰
            if (pq.night > 0) {
                calendarData.push({
                    date: calendarDateStr,
                    detail: `${item.materialDetail}/${item.unit}/${pq.night.toLocaleString()}`,
                    type: 'extrusion',
                    materialNum: item.materialNum,
                    shift: 'night',
                    originalDate: dateStr,
                    materialDetail: item.materialDetail,
                    unit: item.unit,
                    quantity: pq.night
                });
            }
        });
    });
}

function normalizeText(text) {
    // <br> íƒœê·¸ë¥¼ ê³µë°±ìœ¼ë¡œ ë³€í™˜í•˜ê³ , ì—°ì†ëœ ê³µë°±ì„ í•˜ë‚˜ë¡œ ë§Œë“¦
    return text.replace(/<br\s*\/?>/gi, ' ').replace(/\s+/g, ' ').trim();
}

function updateTableCompletionDate(detail, newDate) {
    const segmentsSection = document.getElementById('segments');
    if (!segmentsSection) return false;
    
    const table = segmentsSection.querySelector('table tbody');
    if (!table) return false;
    
    const rows = table.querySelectorAll('tr');
    const normalizedDetail = normalizeText(detail);
    
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length >= 6) {
            const detailCell = cells[2]; // ìƒì„¸ ë‚´ìš©
            const completionDateCell = cells[5]; // ì™„ë£Œì¼
            
            // innerHTMLê³¼ textContent ëª¨ë‘ í™•ì¸
            const rowDetailHTML = detailCell ? detailCell.innerHTML.trim() : '';
            const rowDetailText = detailCell ? detailCell.textContent.trim() : '';
            const normalizedRowDetail = normalizeText(rowDetailHTML || rowDetailText);
            
            // ìƒì„¸ ë‚´ìš©ì´ ì¼ì¹˜í•˜ëŠ” í–‰ ì°¾ê¸° (ì •ê·œí™”ëœ í…ìŠ¤íŠ¸ë¡œ ë¹„êµ)
            if (normalizedRowDetail === normalizedDetail) {
                const month = newDate.getMonth() + 1;
                const day = newDate.getDate();
                const newDateStr = `${month}/${day}`;
                completionDateCell.textContent = newDateStr;
                return true;
            }
        }
    });
    return false;
}

function formatDateForCalendar(date) {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
}

// í•œêµ­ ê³µíœ´ì¼ ëª©ë¡ (2024ë…„ ê¸°ì¤€, í•„ìš”ì‹œ í™•ì¥ ê°€ëŠ¥)
function getHolidays(year) {
    const holidays = {
        '2024-01-01': 'ì‹ ì •',
        '2024-03-01': 'ì‚¼ì¼ì ˆ',
        '2024-05-05': 'ì–´ë¦°ì´ë‚ ',
        '2024-06-06': 'í˜„ì¶©ì¼',
        '2024-08-15': 'ê´‘ë³µì ˆ',
        '2024-10-03': 'ê°œì²œì ˆ',
        '2024-10-09': 'í•œê¸€ë‚ ',
        '2024-12-25': 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤',
        '2025-01-01': 'ì‹ ì •',
        '2025-03-01': 'ì‚¼ì¼ì ˆ',
        '2025-05-05': 'ì–´ë¦°ì´ë‚ ',
        '2025-06-06': 'í˜„ì¶©ì¼',
        '2025-08-15': 'ê´‘ë³µì ˆ',
        '2025-10-03': 'ê°œì²œì ˆ',
        '2025-10-09': 'í•œê¸€ë‚ ',
        '2025-12-25': 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤'
    };
    return holidays;
}

function isHoliday(date) {
    const dateStr = formatDateForCalendar(date);
    const holidays = getHolidays(date.getFullYear());
    return holidays[dateStr] || null;
}

function renderCalendar() {
    const container = document.getElementById('calendar-grid');
    const monthYearEl = document.getElementById('calendar-month-year');
    
    if (!container) return;
    
    const year = currentCalendarDate.getFullYear();
    const month = currentCalendarDate.getMonth();
    
    // Update month/year header
    const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
    monthYearEl.textContent = `${year}ë…„ ${monthNames[month]}`;
    
    // Clear container
    container.innerHTML = '';
    
    // Add day headers
    const dayHeaders = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
    dayHeaders.forEach((day, index) => {
        const header = document.createElement('div');
        header.className = 'calendar-day-header';
        if (index === 0) header.classList.add('sunday');
        if (index === 6) header.classList.add('saturday');
        header.textContent = day;
        container.appendChild(header);
    });
    
    // Get first day of month and number of days
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();
    const startingDayOfWeek = firstDay.getDay();
    
    // Add empty cells for days before month starts
    const prevMonth = month === 0 ? 11 : month - 1;
    const prevYear = month === 0 ? year - 1 : year;
    const prevMonthLastDay = new Date(prevYear, prevMonth + 1, 0).getDate();
    
    for (let i = 0; i < startingDayOfWeek; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day other-month';
        const prevDay = prevMonthLastDay - startingDayOfWeek + i + 1;
        const prevDate = new Date(prevYear, prevMonth, prevDay);
        const prevDateStr = formatDateForCalendar(prevDate);
        emptyDay.dataset.date = prevDateStr;
        
        // ì´ì „ ì›” ë‚ ì§œì—ë„ ì´ë²¤íŠ¸ í‘œì‹œ
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = prevDay;
        emptyDay.appendChild(dayNumber);
        
        // ì´ì „ ì›” ë‚ ì§œì˜ ì´ë²¤íŠ¸ í‘œì‹œ
        addCalendarEventToDayHelper(emptyDay, prevDateStr);
        
        // ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ (ë‹¤ë¥¸ ì›”ë„ ë“œë¡­ ê°€ëŠ¥í•˜ê²Œ)
        emptyDay.addEventListener('dragover', handleDragOver);
        emptyDay.addEventListener('drop', handleDrop);
        emptyDay.addEventListener('dragleave', handleDragLeave);
        
        container.appendChild(emptyDay);
    }
    
    // Add days of month
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    for (let day = 1; day <= daysInMonth; day++) {
        const dayEl = document.createElement('div');
        const currentDate = new Date(year, month, day);
        const dateStr = formatDateForCalendar(currentDate);
        const dayOfWeek = currentDate.getDay();
        
        dayEl.className = 'calendar-day';
        dayEl.dataset.date = dateStr;
        
        // í† ìš”ì¼/ì¼ìš”ì¼ í´ë˜ìŠ¤ ì¶”ê°€
        if (dayOfWeek === 0) dayEl.classList.add('sunday');
        if (dayOfWeek === 6) dayEl.classList.add('saturday');
        
        // ê³µíœ´ì¼ ì²´í¬
        const holidayName = isHoliday(currentDate);
        if (holidayName) {
            dayEl.classList.add('holiday');
        }
        
        if (currentDate.getTime() === today.getTime()) {
            dayEl.classList.add('calendar-today');
        }
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = day;
        dayEl.appendChild(dayNumber);
        
        // ê³µíœ´ì¼ ë¼ë²¨ ì¶”ê°€
        if (holidayName) {
            const holidayLabel = document.createElement('div');
            holidayLabel.className = 'calendar-holiday-label';
            holidayLabel.textContent = holidayName;
            dayEl.appendChild(holidayLabel);
        }
        
        // Add events for this date
        calendarData.forEach(event => {
            if (event.date === dateStr) {
                const eventEl = document.createElement('div');
                eventEl.className = 'calendar-event';
                eventEl.draggable = true;
                
                // ì••ì¶œ ìƒì‚°ê³„íš í•­ëª©ì¸ì§€ í™•ì¸
                if (event.type === 'extrusion') {
                    const unit = (event.unit === 'ST') ? 'PC' : event.unit;
                    eventEl.textContent = `${event.materialDetail}/${unit}/${event.quantity.toLocaleString()}`;
                    eventEl.dataset.materialNum = event.materialNum;
                    eventEl.dataset.shift = event.shift;
                    eventEl.dataset.originalDate = event.originalDate; // "12/1" í˜•ì‹
                    eventEl.dataset.type = 'extrusion';
                    eventEl.dataset.quantity = event.quantity;
                    eventEl.dataset.materialDetail = event.materialDetail;
                    eventEl.dataset.unit = unit;
                    
                    // ë”ë¸”í´ë¦­ìœ¼ë¡œ ìˆ˜ëŸ‰ í¸ì§‘
                    eventEl.addEventListener('dblclick', function() {
                        editExtrusionCalendarQuantity(eventEl);
                    });
                } else {
                eventEl.textContent = event.detail.length > 30 ? event.detail.substring(0, 30) + '...' : event.detail;
                    eventEl.dataset.type = event.type || 'segment';
                }
                
                eventEl.title = event.detail || `${event.materialDetail} (${event.unit}) ${event.quantity}`;
                eventEl.dataset.detail = event.detail || `${event.materialDetail} (${event.unit}) ${event.quantity}`;
                eventEl.dataset.originalDate = event.date;
                
                // ë“œë˜ê·¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
                eventEl.addEventListener('dragstart', handleDragStart);
                eventEl.addEventListener('dragend', handleDragEnd);
                
                // ìš°í´ë¦­ ì‚­ì œ ê¸°ëŠ¥
                eventEl.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    if (confirm('ì´ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        deleteCalendarEvent(eventEl);
                    }
                    return false;
                });
                
                dayEl.appendChild(eventEl);
            }
        });
        
        // ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        dayEl.addEventListener('dragover', handleDragOver);
        dayEl.addEventListener('drop', handleDrop);
        dayEl.addEventListener('dragleave', handleDragLeave);
        
        container.appendChild(dayEl);
    }
    
    // Add empty cells for days after month ends
    const totalCells = container.children.length;
    const totalDayCells = totalCells - 7; // í—¤ë” 7ì¹¸ ì œì™¸
    const remainingCells = 35 - totalDayCells; // 5 weeks * 7 days = 35ì¹¸
    const nextMonth = month === 11 ? 0 : month + 1;
    const nextYear = month === 11 ? year + 1 : year;
    
    for (let i = 0; i < remainingCells; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day other-month';
        const nextDay = i + 1;
        const nextDate = new Date(nextYear, nextMonth, nextDay);
        const nextDateStr = formatDateForCalendar(nextDate);
        emptyDay.dataset.date = nextDateStr;
        
        // ë‹¤ìŒ ì›” ë‚ ì§œì—ë„ ë‚ ì§œ ë²ˆí˜¸ í‘œì‹œ
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = nextDay;
        emptyDay.appendChild(dayNumber);
        
        // ë‹¤ìŒ ì›” ë‚ ì§œì˜ ì´ë²¤íŠ¸ í‘œì‹œ
        addCalendarEventToDayHelper(emptyDay, nextDateStr);
        
        // ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ (ë‹¤ë¥¸ ì›”ë„ ë“œë¡­ ê°€ëŠ¥í•˜ê²Œ)
        emptyDay.addEventListener('dragover', handleDragOver);
        emptyDay.addEventListener('drop', handleDrop);
        emptyDay.addEventListener('dragleave', handleDragLeave);
        
        container.appendChild(emptyDay);
    }
}

// ì´ì „/ë‹¤ìŒ ì›” ë‚ ì§œì— ìº˜ë¦°ë” ì´ë²¤íŠ¸ ì¶”ê°€í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
function addCalendarEventToDayHelper(dayEl, dateStr) {
        calendarData.forEach(event => {
        if (event.date === dateStr) {
                const eventEl = document.createElement('div');
                eventEl.className = 'calendar-event';
                eventEl.draggable = true;
            
            // ì••ì¶œ ìƒì‚°ê³„íš í•­ëª©ì¸ì§€ í™•ì¸
            if (event.type === 'extrusion') {
                const unit = (event.unit === 'ST') ? 'PC' : event.unit;
                eventEl.textContent = `${event.materialDetail}/${unit}/${event.quantity.toLocaleString()}`;
                eventEl.dataset.materialNum = event.materialNum;
                eventEl.dataset.shift = event.shift;
                eventEl.dataset.originalDate = event.originalDate; // "12/1" í˜•ì‹
                eventEl.dataset.type = 'extrusion';
                eventEl.dataset.quantity = event.quantity;
                eventEl.dataset.materialDetail = event.materialDetail;
                eventEl.dataset.unit = unit;
                
                // ë”ë¸”í´ë¦­ìœ¼ë¡œ ìˆ˜ëŸ‰ í¸ì§‘
                eventEl.addEventListener('dblclick', function() {
                    editExtrusionCalendarQuantity(eventEl);
                });
            } else {
                eventEl.textContent = event.detail.length > 30 ? event.detail.substring(0, 30) + '...' : event.detail;
                eventEl.dataset.type = event.type || 'segment';
            }
            
            eventEl.title = event.detail || `${event.materialDetail} (${event.unit}) ${event.quantity}`;
            eventEl.dataset.detail = event.detail || `${event.materialDetail} (${event.unit}) ${event.quantity}`;
                eventEl.dataset.originalDate = event.date;
                
            // ë“œë˜ê·¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
                eventEl.addEventListener('dragstart', handleDragStart);
                eventEl.addEventListener('dragend', handleDragEnd);
                
            // ìš°í´ë¦­ ì‚­ì œ ê¸°ëŠ¥
            eventEl.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                if (confirm('ì´ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    deleteCalendarEvent(eventEl);
                }
                return false;
            });
            
            dayEl.appendChild(eventEl);
        }
    });
}

// Initialize calendar and production table when sections are shown
const originalShowSection = showSection;
showSection = function(sectionId) {
    originalShowSection(sectionId);
    if (sectionId === 'segments') {
        setTimeout(() => {
            extractCalendarDataFromTable();
            renderCalendar();
        }, 100);
    } else if (sectionId === 'weekly-plan') {
        setTimeout(async () => {
            await loadExtrusionPlanData();
            renderProductionTable();
        }, 100);
    } else if (sectionId === 'extrusion-plan') {
        // ë©”ì¸ í…Œì´ë¸”ë§Œ ì´ˆê¸°ì— ìˆ¨ê¹€ (ì¡°íšŒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ í‘œì‹œë¨)
        const mainTableContainer = document.getElementById('extrusion-plan-main-table-container');
        if (mainTableContainer) {
            mainTableContainer.style.display = 'none';
        }
        
        // í† ê¸€ ë²„íŠ¼ ì¶”ê°€ (ì••ì¶œìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜)
        setTimeout(function() {
            addToggleButtonsToExtrusionItems();
    
    // ê³ ë¬´ ì‚¬ìš© ê³„íš ì„¹ì…˜ì˜ h5 ì œëª©ì— í† ê¸€ ê¸°ëŠ¥ ì¶”ê°€
    addToggleToRubberPlanH5();
        }, 200);
        
        // ì£¼ê°„ìƒì‚°ê³„íš í…Œì´ë¸”ì€ ì´ˆê¸°ì— í‘œì‹œí•˜ê³  ë°ì´í„° ë¡œë“œ
        setTimeout(async () => {
            // ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„°ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¨¼ì € ë¡œë“œ
            if (!extrusionPlanData || extrusionPlanData.length === 0) {
            await loadExtrusionPlanData();
            }
            // ì£¼ê°„ìƒì‚°ê³„íš í…Œì´ë¸” ë Œë”ë§
            renderExtrusionPlanProductionTable();
        }, 100);
    }
};

// Drag and Drop handlers
let draggedEvent = null;

function handleDragStart(e) {
    draggedEvent = {
        detail: e.target.dataset.detail,
        originalDate: e.target.dataset.originalDate,
        element: e.target,
        type: e.target.dataset.type, // 'extrusion' or 'requirement'
        materialNum: e.target.dataset.materialNum,
        shift: e.target.dataset.shift,
        originalPlanDate: e.target.dataset.originalDate // "12/1" í˜•ì‹
    };
    e.target.classList.add('dragging');
    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/html', e.target.outerHTML);
}

function handleDragEnd(e) {
    e.target.classList.remove('dragging');
    // ëª¨ë“  ë‚ ì§œ ì…€ì—ì„œ drag-over í´ë˜ìŠ¤ ì œê±°
    document.querySelectorAll('.calendar-day').forEach(day => {
        day.classList.remove('drag-over');
    });
}

function handleDragOver(e) {
    if (e.preventDefault) {
        e.preventDefault();
    }
    e.dataTransfer.dropEffect = 'move';
    
    // ë“œë˜ê·¸ ì¤‘ì¸ ë‚ ì§œ ì…€ì— ìŠ¤íƒ€ì¼ ì ìš© (ë‹¤ë¥¸ ì›”ë„ í¬í•¨)
    const dayEl = e.currentTarget;
    if (dayEl.classList.contains('calendar-day')) {
        dayEl.classList.add('drag-over');
    }
    return false;
}

function handleDragLeave(e) {
    e.currentTarget.classList.remove('drag-over');
}

function handleDrop(e) {
    if (e.stopPropagation) {
        e.stopPropagation();
    }
    
    e.preventDefault();
    
    const dayEl = e.currentTarget;
    if (!dayEl.classList.contains('calendar-day')) {
        return false;
    }
    
    dayEl.classList.remove('drag-over');
    
    if (!draggedEvent) return false;
    
    // ë‚ ì§œ ì¶”ì¶œ - dataset.dateë¥¼ ìš°ì„  ì‚¬ìš©, ì—†ìœ¼ë©´ í˜„ì¬ ì›” ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°
    let newDate;
    if (dayEl.dataset.date) {
        // ë‹¤ë¥¸ ì›”ì˜ ë‚ ì§œì¸ ê²½ìš°
        const dateParts = dayEl.dataset.date.split('-');
        newDate = new Date(parseInt(dateParts[0]), parseInt(dateParts[1]) - 1, parseInt(dateParts[2]));
    } else {
        // í˜„ì¬ ì›”ì˜ ë‚ ì§œì¸ ê²½ìš°
        const dayNumber = parseInt(dayEl.querySelector('.calendar-day-number')?.textContent);
        if (!dayNumber) return false;
        const year = currentCalendarDate.getFullYear();
        const month = currentCalendarDate.getMonth();
        newDate = new Date(year, month, dayNumber);
    }
    
    const newDateStr = formatDateForCalendar(newDate);
    
    // ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„°ì¸ ê²½ìš°
    if (draggedEvent.type === 'extrusion' && draggedEvent.materialNum) {
        const month = newDate.getMonth() + 1;
        const day = newDate.getDate();
        const newPlanDate = `${month}/${day}`;
        
        // ìƒì‚°ê³„íš ë°ì´í„° ì—…ë°ì´íŠ¸
        const item = extrusionPlanData.find(i => i.materialNum === draggedEvent.materialNum);
        if (item && item.productionQuantity) {
            // ê¸°ì¡´ ë‚ ì§œì—ì„œ ìˆ˜ëŸ‰ ì œê±°
            const oldDate = draggedEvent.originalPlanDate || draggedEvent.originalDate;
            if (item.productionQuantity[oldDate]) {
                item.productionQuantity[oldDate][draggedEvent.shift] = 0;
            }
            
            // ìƒˆ ë‚ ì§œì— ìˆ˜ëŸ‰ ì¶”ê°€
            const quantity = parseInt(draggedEvent.element.dataset.quantity) || 0;
            if (!item.productionQuantity[newPlanDate]) {
                item.productionQuantity[newPlanDate] = { day: 0, night: 0 };
            }
            item.productionQuantity[newPlanDate][draggedEvent.shift] = quantity;
            
            // filteredExtrusionPlanDataë„ ì—…ë°ì´íŠ¸
            const filteredItem = filteredExtrusionPlanData.find(i => i.materialNum === draggedEvent.materialNum);
            if (filteredItem && filteredItem.productionQuantity) {
                if (filteredItem.productionQuantity[oldDate]) {
                    filteredItem.productionQuantity[oldDate][draggedEvent.shift] = 0;
                }
                if (!filteredItem.productionQuantity[newPlanDate]) {
                    filteredItem.productionQuantity[newPlanDate] = { day: 0, night: 0 };
                }
                filteredItem.productionQuantity[newPlanDate][draggedEvent.shift] = quantity;
            }
            
            // ìƒì‚°ê³„íš ê´€ë¦¬ í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
            renderExtrusionPlanTable();
        }
    
    // calendarData ì—…ë°ì´íŠ¸
        const eventIndex = calendarData.findIndex(e => 
            e.type === 'extrusion' && 
            e.materialNum === draggedEvent.materialNum && 
            e.shift === draggedEvent.shift &&
            e.originalDate === oldDate
        );
        if (eventIndex !== -1) {
            calendarData[eventIndex].date = newDateStr;
            const newMonth = newDate.getMonth() + 1;
            const newDay = newDate.getDate();
            calendarData[eventIndex].originalDate = `${newMonth}/${newDay}`;
        }
    } else {
        // ìš”ì²­ì‚¬í•­ì¸ ê²½ìš°
    const eventIndex = calendarData.findIndex(e => e.detail === draggedEvent.detail);
    if (eventIndex !== -1) {
        calendarData[eventIndex].date = newDateStr;
    }
    
    // í…Œì´ë¸” ì—…ë°ì´íŠ¸
    updateTableCompletionDate(draggedEvent.detail, newDate);
    }
    
    // ë‹¤ë¥¸ ì›”ë¡œ ì´ë™í•œ ê²½ìš° í•´ë‹¹ ì›”ë¡œ ìº˜ë¦°ë” ì´ë™
    if (dayEl.classList.contains('other-month')) {
        currentCalendarDate = new Date(newDate.getFullYear(), newDate.getMonth(), 1);
    }
    
    // ìº˜ë¦°ë” ë‹¤ì‹œ ë Œë”ë§
    renderCalendar();
    
    draggedEvent = null;
    return false;
}

// Calendar navigation
document.addEventListener('DOMContentLoaded', function() {
    const prevBtn = document.getElementById('prev-month');
    const nextBtn = document.getElementById('next-month');
    
    if (prevBtn) {
        prevBtn.addEventListener('click', () => {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
            renderCalendar();
        });
    }
    
    if (nextBtn) {
        nextBtn.addEventListener('click', () => {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
            renderCalendar();
        });
    }
    
    // Initialize calendar if segments section is visible
    if (document.getElementById('segments')?.classList.contains('active')) {
        renderCalendar();
    }
    
});

// ì••ì¶œ ìƒì‚°ê³„íš ê´€ë¦¬ ë°ì´í„°
let extrusionPlanData = [];
let filteredExtrusionPlanData = []; // í•„í„°ë§ëœ ë°ì´í„°
let currentExtrusionSort = { column: null, direction: 'asc' };
let currentExtrusionCalendarDate = new Date(2024, 11, 1); // 2024ë…„ 12ì›”

// ì¤‘ì‹ëŒ€ì‘ ë°ì´í„° ì €ì¥ êµ¬ì¡°: { 'ì••ì¶œ#01': { '12/1': { 'day': ['ì¤‘ì‹ëŒ€ì‘'], 'night': [] }, ... }, ... }
let extrusionLunchBreakData = {};

// ì¤‘ì‹ëŒ€ì‘ ë°ì´í„° ë¡œë“œ (localStorageì—ì„œ)
function loadExtrusionLunchBreakData() {
    const saved = localStorage.getItem('extrusionLunchBreakData');
    if (saved) {
        try {
            extrusionLunchBreakData = JSON.parse(saved);
        } catch (e) {
            console.error('ì¤‘ì‹ëŒ€ì‘ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', e);
            // localStorage íŒŒì‹± ì‹¤íŒ¨ ì‹œ embedded ë°ì´í„° ì‚¬ìš©
            if (typeof embeddedExtrusionLunchBreakData !== 'undefined') {
                extrusionLunchBreakData = JSON.parse(JSON.stringify(embeddedExtrusionLunchBreakData));
            } else {
            extrusionLunchBreakData = {};
            }
        }
    } else {
        // localStorageê°€ ë¹„ì–´ìˆìœ¼ë©´ embedded ë°ì´í„° ì‚¬ìš©
        if (typeof embeddedExtrusionLunchBreakData !== 'undefined') {
            extrusionLunchBreakData = JSON.parse(JSON.stringify(embeddedExtrusionLunchBreakData));
        }
    }
}

// ì¤‘ì‹ëŒ€ì‘ ë°ì´í„° ì €ì¥ (localStorageì—)
function saveExtrusionLunchBreakData() {
    try {
        localStorage.setItem('extrusionLunchBreakData', JSON.stringify(extrusionLunchBreakData));
    } catch (e) {
        console.error('ì¤‘ì‹ëŒ€ì‘ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', e);
    }
}

// ì´ˆê¸° ë¡œë“œ
loadExtrusionLunchBreakData();

// ê°œë°œ ë°ì´í„° ì €ì¥ êµ¬ì¡°: { 'ì••ì¶œ#01': { '12/1': { 'day': [{ section: 'ë‹¨ë©´ëª…', timeText: '3ì‹œê°„' }], 'night': [] }, ... }, ... }
let extrusionDevData = {};

// í•­ëª© ìˆœì„œ ì •ë³´ ì €ì¥ (workplace -> date -> shift -> [itemKeys])
let extrusionItemOrder = {};

// ê°œë°œ ë°ì´í„° ë¡œë“œ (localStorageì—ì„œ)
function loadExtrusionDevData() {
    const saved = localStorage.getItem('extrusionDevData');
    if (saved) {
        try {
            extrusionDevData = JSON.parse(saved);
        } catch (e) {
            console.error('ê°œë°œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', e);
            // localStorage íŒŒì‹± ì‹¤íŒ¨ ì‹œ embedded ë°ì´í„° ì‚¬ìš©
            if (typeof embeddedExtrusionDevData !== 'undefined') {
                extrusionDevData = JSON.parse(JSON.stringify(embeddedExtrusionDevData));
            } else {
                extrusionDevData = {};
            }
        }
    } else {
        // localStorageê°€ ë¹„ì–´ìˆìœ¼ë©´ embedded ë°ì´í„° ì‚¬ìš©
        if (typeof embeddedExtrusionDevData !== 'undefined') {
            extrusionDevData = JSON.parse(JSON.stringify(embeddedExtrusionDevData));
        }
    }
}

// ê°œë°œ ë°ì´í„° ì €ì¥ (localStorageì—)
function saveExtrusionDevData() {
    try {
        localStorage.setItem('extrusionDevData', JSON.stringify(extrusionDevData));
    } catch (e) {
        console.error('ê°œë°œ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', e);
    }
}

// ìˆœì„œ ì •ë³´ ë¡œë“œ
function loadExtrusionItemOrder() {
    const saved = localStorage.getItem('extrusionItemOrder');
    if (saved) {
        try {
            extrusionItemOrder = JSON.parse(saved);
        } catch (e) {
            console.error('ìˆœì„œ ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:', e);
            extrusionItemOrder = {};
        }
    }
}

// ì´ˆê¸° ë¡œë“œ
loadExtrusionDevData();
loadExtrusionItemOrder();

// ì—‘ì…€ íŒŒì¼ì—ì„œ ë°ì´í„° ë¡œë“œ (ì²˜ë¦¬ëœ íŒŒì¼)
async function loadExtrusionPlanData() {
    try {
        // ë¨¼ì € fetch ì‹œë„
        const response = await fetch('extrusion_plan_data.json');
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        const data = await response.json();
        if (Array.isArray(data) && data.length > 0) {
            extrusionPlanData = data;
            filteredExtrusionPlanData = data; // ì´ˆê¸° í•„í„°ë§
            console.log(`ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„° ë¡œë“œ ì™„ë£Œ: ${extrusionPlanData.length}ê°œ í–‰`);
        } else {
            console.warn('ë°ì´í„°ê°€ ë¹„ì–´ìˆê±°ë‚˜ ë°°ì—´ì´ ì•„ë‹™ë‹ˆë‹¤.');
            extrusionPlanData = [];
            filteredExtrusionPlanData = [];
        }
    } catch (error) {
        console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
        console.error('ì—ëŸ¬ ìƒì„¸:', error.message);
        // ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œì—ì„œëŠ” fetchê°€ ì‹¤íŒ¨í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, 
        // ìŠ¤í¬ë¦½íŠ¸ íƒœê·¸ë¡œ JSONì„ ì§ì ‘ í¬í•¨í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
        extrusionPlanData = [];
    }
}

// ì••ì¶œ ìƒì‚°ê³„íš í…Œì´ë¸” ë Œë”ë§
function renderExtrusionPlanTable() {
    const tbody = document.getElementById('extrusion-plan-tbody');
    if (!tbody) {
        console.error('extrusion-plan-tbody ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
    }
    
    tbody.innerHTML = '';
    
    // í•„í„°ë§ëœ ë°ì´í„° ì‚¬ìš©
    const dataToRender = filteredExtrusionPlanData.length > 0 ? filteredExtrusionPlanData : extrusionPlanData;
    console.log('ë Œë”ë§ ì‹œì‘. ë°ì´í„° ê°œìˆ˜:', dataToRender ? dataToRender.length : 0);
    
    if (!dataToRender || dataToRender.length === 0) {
        const row = document.createElement('tr');
        const cell = document.createElement('td');
        cell.colSpan = 18;
        cell.style.padding = '20px';
        cell.style.textAlign = 'center';
        cell.textContent = 'ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
        row.appendChild(cell);
        tbody.appendChild(row);
        return;
    }
    
    const dates = ['12/1', '12/2', '12/3', '12/4', '12/5'];
    
    dataToRender.forEach((item, index) => {
        const row = document.createElement('tr');
        
        // No.
        const noCell = document.createElement('td');
        noCell.style.padding = '10px';
        noCell.style.border = '1px solid var(--border)';
        noCell.style.textAlign = 'center';
        noCell.style.position = 'sticky';
        noCell.style.left = '0';
        noCell.style.background = 'var(--surface)';
        noCell.style.zIndex = '5';
        noCell.textContent = index + 1;
        row.appendChild(noCell);
        
        // êµ¬ë¶„
        const categoryCell = document.createElement('td');
        categoryCell.style.padding = '10px';
        categoryCell.style.border = '1px solid var(--border)';
        categoryCell.style.textAlign = 'center';
        categoryCell.style.position = 'sticky';
        categoryCell.style.left = '35px';
        categoryCell.style.background = 'var(--surface)';
        categoryCell.style.zIndex = '5';
        categoryCell.textContent = item.category || '';
        row.appendChild(categoryCell);
        
        // ì‘ì—…ì¥
        const workplaceCell = document.createElement('td');
        workplaceCell.style.padding = '10px';
        workplaceCell.style.border = '1px solid var(--border)';
        workplaceCell.style.textAlign = 'center';
        workplaceCell.style.position = 'sticky';
        workplaceCell.style.left = '100px';
        workplaceCell.style.background = 'var(--surface)';
        workplaceCell.style.zIndex = '5';
        workplaceCell.textContent = item.workplace || '';
        row.appendChild(workplaceCell);
        
        // ì°¨ì¢…
        const vehicleCell = document.createElement('td');
        vehicleCell.style.padding = '10px';
        vehicleCell.style.border = '1px solid var(--border)';
        vehicleCell.style.textAlign = 'center';
        vehicleCell.textContent = item.vehicleType || '';
        row.appendChild(vehicleCell);
        
        // ìì¬ë²ˆí˜¸
        const materialNumCell = document.createElement('td');
        materialNumCell.style.padding = '10px';
        materialNumCell.style.border = '1px solid var(--border)';
        materialNumCell.style.textAlign = 'center';
        materialNumCell.textContent = item.materialNum || '';
        row.appendChild(materialNumCell);
        
        // ìì¬ë‚´ì—­
        const materialDetailCell = document.createElement('td');
        materialDetailCell.style.padding = '10px';
        materialDetailCell.style.border = '1px solid var(--border)';
        materialDetailCell.style.textAlign = 'left';
        materialDetailCell.textContent = item.materialDetail || '';
        row.appendChild(materialDetailCell);
        
        // í’ˆëª©ë²ˆí˜¸
        const itemNumCell = document.createElement('td');
        itemNumCell.style.padding = '10px';
        itemNumCell.style.border = '1px solid var(--border)';
        itemNumCell.style.textAlign = 'center';
        itemNumCell.textContent = item.itemNum || '';
        row.appendChild(itemNumCell);
        
        // ì—…ì²´ëª…
        const companyCell = document.createElement('td');
        companyCell.style.padding = '10px';
        companyCell.style.border = '1px solid var(--border)';
        companyCell.style.textAlign = 'center';
        companyCell.textContent = item.companyName || '';
        row.appendChild(companyCell);
        
        // ë‹¨ìœ„ (ST -> PC ë³€í™˜)
        const unitCell = document.createElement('td');
        unitCell.style.padding = '10px';
        unitCell.style.border = '1px solid var(--border)';
        unitCell.style.textAlign = 'center';
        unitCell.textContent = (item.unit === 'ST') ? 'PC' : (item.unit || '');
        row.appendChild(unitCell);
        
        // ì••ì¶œìˆ˜ëŸ‰ (ë‚ ì§œë³„ ì£¼/ì•¼ê°„)
        dates.forEach(date => {
            // ì£¼ê°„
            const dayCell = document.createElement('td');
            dayCell.style.padding = '8px';
            dayCell.style.border = '1px solid var(--border)';
            dayCell.style.textAlign = 'center';
            dayCell.style.background = 'linear-gradient(180deg, #fffef8, #fffdf0)';
            dayCell.contentEditable = 'true';
            dayCell.dataset.date = date;
            dayCell.dataset.shift = 'day';
            dayCell.dataset.materialNum = item.materialNum;
            const dayValue = item.productionQuantity && item.productionQuantity[date] && item.productionQuantity[date].day ? item.productionQuantity[date].day : 0;
            dayCell.textContent = dayValue > 0 ? dayValue.toLocaleString() : '';
            dayCell.addEventListener('blur', function() {
                const newValue = this.textContent.trim();
                updateExtrusionQuantity(item.materialNum, date, 'day', newValue);
                // ìº˜ë¦°ë” ì—…ë°ì´íŠ¸
                if (document.getElementById('extrusion-plan-calendar-grid')) {
                    renderExtrusionPlanCalendar();
                }
            });
            row.appendChild(dayCell);
            
            // ì•¼ê°„
            const nightCell = document.createElement('td');
            nightCell.style.padding = '8px';
            nightCell.style.border = '1px solid var(--border)';
            nightCell.style.textAlign = 'center';
            nightCell.style.background = 'linear-gradient(180deg, #f8f8ff, #f0f0ff)';
            nightCell.contentEditable = 'true';
            nightCell.dataset.date = date;
            nightCell.dataset.shift = 'night';
            nightCell.dataset.materialNum = item.materialNum;
            const nightValue = item.productionQuantity && item.productionQuantity[date] && item.productionQuantity[date].night ? item.productionQuantity[date].night : 0;
            nightCell.textContent = nightValue > 0 ? nightValue.toLocaleString() : '';
            nightCell.addEventListener('blur', function() {
                const newValue = this.textContent.trim();
                updateExtrusionQuantity(item.materialNum, date, 'night', newValue);
                // ìº˜ë¦°ë” ì—…ë°ì´íŠ¸
                if (document.getElementById('extrusion-plan-calendar-grid')) {
                    renderExtrusionPlanCalendar();
                }
            });
            row.appendChild(nightCell);
        });
        
        tbody.appendChild(row);
    });
}

// ì••ì¶œ ìƒì‚°ê³„íš ê²€ìƒ‰ ë° í•„í„°ë§
async function searchExtrusionPlan() {
    // ë°ì´í„°ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¨¼ì € ë¡œë“œ
    if (!extrusionPlanData || extrusionPlanData.length === 0) {
        await loadExtrusionPlanData();
    }
    
    const materialNum = document.getElementById('extrusion-material-num').value.trim();
    const itemNum = document.getElementById('extrusion-item-num').value.trim();
    const vehicleType = document.getElementById('extrusion-vehicle-type').value.trim();
    const workplaceFilter = document.getElementById('extrusion-workplace-filter').value;
    const companyFilter = document.getElementById('extrusion-company-filter').value;
    
    // í•„í„°ë§ ë¡œì§
    filteredExtrusionPlanData = extrusionPlanData.filter(item => {
        if (materialNum && !item.materialNum.includes(materialNum)) return false;
        if (itemNum && !item.itemNum.includes(itemNum)) return false;
        if (vehicleType && !item.vehicleType.includes(vehicleType)) return false;
        if (workplaceFilter !== 'ì „ì²´' && item.workplace !== workplaceFilter) return false;
        if (companyFilter !== 'ì „ì²´' && item.companyName !== companyFilter) return false;
        return true;
    });
    
    // ë©”ì¸ í…Œì´ë¸” ì˜ì—­ë§Œ í‘œì‹œ (ì£¼ê°„ìƒì‚°ê³„íš í…Œì´ë¸”ì€ ì´ë¯¸ í‘œì‹œë˜ì–´ ìˆìŒ)
    const mainTableContainer = document.getElementById('extrusion-plan-main-table-container');
    if (mainTableContainer) {
        mainTableContainer.style.display = 'block';
    }
    
    renderExtrusionPlanTable();
    renderExtrusionPlanProductionTable();
}

// í…Œì´ë¸” ì •ë ¬
function sortExtrusionTable(column) {
    if (currentExtrusionSort.column === column) {
        // ê°™ì€ ì»¬ëŸ¼ì„ ë‹¤ì‹œ í´ë¦­í•˜ë©´ ë°©í–¥ ì „í™˜
        currentExtrusionSort.direction = currentExtrusionSort.direction === 'asc' ? 'desc' : 'asc';
    } else {
        currentExtrusionSort.column = column;
        currentExtrusionSort.direction = 'asc';
    }
    
    filteredExtrusionPlanData.sort((a, b) => {
        let aVal = a[column] || '';
        let bVal = b[column] || '';
        
        // ìˆ«ì ë¹„êµ (ìì¬ë²ˆí˜¸)
        if (column === 'materialNum') {
            aVal = aVal.toString();
            bVal = bVal.toString();
            const compare = aVal.localeCompare(bVal, undefined, { numeric: true, sensitivity: 'base' });
            return currentExtrusionSort.direction === 'asc' ? compare : -compare;
        }
        
        // ë¬¸ìì—´ ë¹„êµ
        const compare = aVal.toString().localeCompare(bVal.toString(), 'ko');
        return currentExtrusionSort.direction === 'asc' ? compare : -compare;
    });
    
    renderExtrusionPlanTable();
}

// ì••ì¶œ ìƒì‚°ê³„íš ìˆ˜ëŸ‰ ì—…ë°ì´íŠ¸ (í…Œì´ë¸” â†’ ìº˜ë¦°ë” ì—°ë™)
function updateExtrusionQuantity(materialNum, date, shift, newQuantityStr) {
    // ë¬¸ìì—´ì—ì„œ ìˆ«ì ì¶”ì¶œ (ì‰¼í‘œ ì œê±°)
    const newQuantity = parseInt(newQuantityStr.replace(/,/g, '')) || 0;
    
    // shiftê°€ 'day' ë˜ëŠ” 'night'ì¸ì§€ í™•ì¸í•˜ê³  ë³€í™˜
    const shiftKey = (shift === 'ì£¼' || shift === 'day') ? 'day' : 'night';
    
    // extrusionPlanDataì—ì„œ í•´ë‹¹ ìì¬ ì°¾ì•„ì„œ ì—…ë°ì´íŠ¸
    const item = extrusionPlanData.find(i => i.materialNum === materialNum);
    if (item && item.productionQuantity) {
        if (!item.productionQuantity[date]) {
            item.productionQuantity[date] = { day: 0, night: 0 };
        }
        item.productionQuantity[date][shiftKey] = newQuantity;
        
        // filteredExtrusionPlanDataë„ ì—…ë°ì´íŠ¸
        const filteredItem = filteredExtrusionPlanData.find(i => i.materialNum === materialNum);
        if (filteredItem) {
            if (!filteredItem.productionQuantity) {
                filteredItem.productionQuantity = {};
            }
            if (!filteredItem.productionQuantity[date]) {
                filteredItem.productionQuantity[date] = { day: 0, night: 0 };
            }
            filteredItem.productionQuantity[date][shiftKey] = newQuantity;
        }
        
        // ëª¨ë“  í…Œì´ë¸” ì—…ë°ì´íŠ¸
        renderProductionTable(); // ì£¼ê°„ ìƒì‚°ê³„íš í…Œì´ë¸” ì—…ë°ì´íŠ¸
        renderExtrusionPlanTable(); // ìƒì‚°ê³„íš ê´€ë¦¬ í‘œ ì—…ë°ì´íŠ¸
        renderExtrusionPlanProductionTable(); // ìƒì‚°ê³„íš ê´€ë¦¬ ì•„ë˜ í…Œì´ë¸” ì—…ë°ì´íŠ¸
        
        // segments ì„¹ì…˜ì˜ ì£¼ê°„ìƒì‚°ê³„íš ìº˜ë¦°ë”ë„ ì—…ë°ì´íŠ¸
        if (document.getElementById('segments')?.classList.contains('active')) {
            extractCalendarDataFromTable();
            renderCalendar();
        }
    }
}

// ìº˜ë¦°ë”ì—ì„œ ì••ì¶œ ìƒì‚°ê³„íš ìˆ˜ëŸ‰ í¸ì§‘
function editExtrusionCalendarQuantity(eventEl) {
    const materialNum = eventEl.dataset.materialNum;
    const originalDate = eventEl.dataset.originalDate; // "12/1" í˜•ì‹
    const shift = eventEl.dataset.shift;
    const currentQuantity = parseInt(eventEl.dataset.quantity) || 0;
    
    const newQuantity = prompt('ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”:', currentQuantity.toLocaleString());
    if (newQuantity === null) return;
    
    const quantity = parseInt(newQuantity.replace(/,/g, '')) || 0;
    
    // ìƒì‚°ê³„íš ë°ì´í„° ì—…ë°ì´íŠ¸
    updateExtrusionQuantity(materialNum, originalDate, shift, quantity.toString());
    
    // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
    renderExtrusionPlanTable();
    renderExtrusionPlanProductionTable();
}

// ìº˜ë¦°ë” ì´ë²¤íŠ¸ ì‚­ì œ (ì£¼ê°„ ìƒì‚°ê³„íš ìº˜ë¦°ë”ìš©)
function deleteCalendarEvent(eventEl) {
    const type = eventEl.dataset.type;
    
    if (type === 'extrusion') {
        // ì••ì¶œ ìƒì‚°ê³„íš í•­ëª© ì‚­ì œ
        const materialNum = eventEl.dataset.materialNum;
        const originalDate = eventEl.dataset.originalDate; // "12/1" í˜•ì‹
        const shift = eventEl.dataset.shift;
        
        if (materialNum && originalDate && shift) {
            // ìƒì‚°ê³„íš ë°ì´í„°ì—ì„œ ìˆ˜ëŸ‰ì„ 0ìœ¼ë¡œ ì„¤ì •
            updateExtrusionQuantity(materialNum, originalDate, shift, '0');
            
            // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
            renderExtrusionPlanTable();
            renderExtrusionPlanProductionTable();
            renderProductionTable();
        }
    } else {
        // ê°œë°œ í•­ëª© ë˜ëŠ” ì¼ë°˜ ì„¸ê·¸ë¨¼íŠ¸ í•­ëª© ì‚­ì œ
        const date = eventEl.dataset.originalDate;
        const detail = eventEl.dataset.detail;
        
        // calendarDataì—ì„œ ì œê±°
        calendarData = calendarData.filter(item => 
            !(item.date === date && item.detail === detail)
        );
        
        // ì£¼ê°„ ìƒì‚°ê³„íš í…Œì´ë¸”ì—ì„œë„ ì œê±° (ê°œë°œ í•­ëª©ì¸ ê²½ìš°)
        if (detail && detail.includes('ê°œë°œ')) {
            // currentWeekDataì—ì„œë„ ì œê±°
            const detailParts = detail.split(' ');
            const machine = detailParts[0]; // "1í˜¸" ê°™ì€ í˜•ì‹
            const dateParts = date.split('-');
            const month = parseInt(dateParts[1]);
            const day = parseInt(dateParts[2]);
            const dateKey = `${month}/${day}-ì£¼`;
            
            if (currentWeekData[machine] && currentWeekData[machine][dateKey]) {
                currentWeekData[machine][dateKey] = currentWeekData[machine][dateKey].filter(item => 
                    !(item.name && item.name.includes('ê°œë°œ') && item.quantity === detailParts[1])
                );
                saveProductionData();
                renderProductionTable();
            }
        }
    }
    
    // ìº˜ë¦°ë” ë‹¤ì‹œ ë Œë”ë§
    extractCalendarDataFromTable();
    renderCalendar();
}

// ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„°ë¥¼ ì£¼ê°„ ìƒì‚°ê³„íš í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ ë Œë”ë§
function renderExtrusionPlanProductionTable() {
    const tbody = document.getElementById('extrusion-plan-production-tbody');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    
    // ì „ì²´ ë°ì´í„° ì‚¬ìš© (í•„í„°ë§ë˜ì§€ ì•Šì€)
    if (!extrusionPlanData || extrusionPlanData.length === 0) {
        const row = document.createElement('tr');
        const cell = document.createElement('td');
        cell.colSpan = 11;
        cell.style.padding = '20px';
        cell.style.textAlign = 'center';
        cell.textContent = 'ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
        row.appendChild(cell);
        tbody.appendChild(row);
        return;
    }
    
    // ì‘ì—…ì¥ë³„ë¡œ ê·¸ë£¹í™”
    const workplaceGroups = {};
    extrusionPlanData.forEach(item => {
        if (!item.workplace) return;
        if (!workplaceGroups[item.workplace]) {
            workplaceGroups[item.workplace] = [];
        }
        workplaceGroups[item.workplace].push(item);
    });
    
    // ì‘ì—…ì¥ ì •ë ¬ (ì••ì¶œ#01 ~ ì••ì¶œ#12)
    const sortedWorkplaces = Object.keys(workplaceGroups).sort((a, b) => {
        const numA = parseInt(a.replace('ì••ì¶œ#', '')) || 0;
        const numB = parseInt(b.replace('ì••ì¶œ#', '')) || 0;
        return numA - numB;
    });
    
    const dates = ['12/1', '12/2', '12/3', '12/4', '12/5'];
    const shiftMap = { 'day': 'ì£¼', 'night': 'ì•¼' };
    
    sortedWorkplaces.forEach(workplace => {
        const row = document.createElement('tr');
        
        // ì‘ì—…ì¥ëª… (ì••ì¶œ#01 -> 1í˜¸)
        const machineNum = parseInt(workplace.replace('ì••ì¶œ#', '')) || 0;
        const workplaceCell = document.createElement('td');
        workplaceCell.className = 'machine-cell';
        workplaceCell.textContent = `${machineNum}í˜¸`;
        row.appendChild(workplaceCell);
        
        // ê° ë‚ ì§œì˜ ì£¼/ì•¼ ì…€
        dates.forEach(date => {
            // ì£¼ê°„ ì…€
            const dayCell = document.createElement('td');
            dayCell.className = 'shift-cell day-shift-bg';
            dayCell.dataset.workplace = workplace;
            dayCell.dataset.date = date;
            dayCell.dataset.shift = 'ì£¼';
            
            // í•´ë‹¹ ì‘ì—…ì¥, ë‚ ì§œ, ì£¼ê°„ì˜ ë°ì´í„° ì°¾ê¸°
            const dayItems = [];
            workplaceGroups[workplace].forEach(item => {
                if (item.productionQuantity && item.productionQuantity[date] && item.productionQuantity[date].day > 0) {
                    const unit = (item.unit === 'ST') ? 'PC' : item.unit;
                    dayItems.push({
                        name: item.materialDetail,
                        quantity: item.productionQuantity[date].day.toLocaleString(),
                        unit: unit,
                        materialNum: item.materialNum,
                        shift: 'day',
                        originalDate: date
                    });
                }
            });
            
            // ì¤‘ì‹ëŒ€ì‘ í•­ëª© ì¶”ê°€
            if (extrusionLunchBreakData[workplace] && extrusionLunchBreakData[workplace][date] && extrusionLunchBreakData[workplace][date].day) {
                extrusionLunchBreakData[workplace][date].day.forEach((lunchBreak, index) => {
                    dayItems.push({
                        name: '',
                        quantity: '',
                        unit: '',
                        materialNum: '',
                        shift: 'day',
                        originalDate: date,
                        isLunchBreak: true,
                        lunchBreakText: lunchBreak,
                        lunchBreakIndex: index
                    });
                });
            }
            
            // ê°œë°œ í•­ëª© ì¶”ê°€
            if (extrusionDevData[workplace] && extrusionDevData[workplace][date] && extrusionDevData[workplace][date].day) {
                extrusionDevData[workplace][date].day.forEach((devItem, index) => {
                    dayItems.push({
                        name: `ê°œë°œ ${devItem.timeText}`,
                        quantity: devItem.section,
                        unit: '',
                        materialNum: '',
                        shift: 'day',
                        originalDate: date,
                        isDev: true,
                        devSection: devItem.section,
                        devTimeText: devItem.timeText,
                        devIndex: index
                    });
                });
            }
            
            // ìˆœì„œ ì •ë³´ê°€ ìˆìœ¼ë©´ ì ìš©
            if (extrusionItemOrder && extrusionItemOrder[workplace] && extrusionItemOrder[workplace][date] && extrusionItemOrder[workplace][date].day) {
                try {
                    const order = extrusionItemOrder[workplace][date].day;
                    const orderedItems = [];
                    const unorderedItems = [...dayItems];
                    
                    // ìˆœì„œ ì •ë³´ì— ë”°ë¼ ì •ë ¬
                    order.forEach(orderItem => {
                        const foundIndex = unorderedItems.findIndex(item => {
                            if (orderItem.type === 'dev' && item.isDev) {
                                return item.devIndex === orderItem.devIndex;
                            } else if (orderItem.type === 'lunchBreak' && item.isLunchBreak) {
                                return item.lunchBreakIndex === orderItem.lunchBreakIndex;
                            } else if (orderItem.type === 'production' && !item.isDev && !item.isLunchBreak) {
                                return item.materialNum === orderItem.materialNum;
                            }
                            return false;
                        });
                        if (foundIndex !== -1) {
                            orderedItems.push(unorderedItems[foundIndex]);
                            unorderedItems.splice(foundIndex, 1);
                        }
                    });
                    
                    // ìˆœì„œ ì •ë³´ì— ì—†ëŠ” í•­ëª©ì€ ë’¤ì— ì¶”ê°€
                    dayItems = [...orderedItems, ...unorderedItems];
                } catch (e) {
                    console.error('ìˆœì„œ ì •ë³´ ì ìš© ì˜¤ë¥˜:', e);
                    // ì˜¤ë¥˜ ë°œìƒ ì‹œ ì›ë˜ ìˆœì„œ ìœ ì§€
                }
            }
            
            if (dayItems.length === 0) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'empty-cell';
                dayCell.appendChild(emptyDiv);
            } else {
                dayItems.forEach((item, index) => {
                    if (item.isLunchBreak) {
                        const lunchDiv = createLunchBreakItem(workplace, date, 'day', item.lunchBreakText, item.lunchBreakIndex);
                        dayCell.appendChild(lunchDiv);
                    } else if (item.isDev) {
                        const devDiv = createDevItem(workplace, date, 'day', item.devSection, item.devTimeText, item.devIndex);
                        dayCell.appendChild(devDiv);
                    } else {
                        const workDiv = createExtrusionWorkItemForWeeklyTable(item, workplace, date, 'day', index);
                        dayCell.appendChild(workDiv);
                    }
                });
            }
            
            // ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
            dayCell.addEventListener('dragover', handleExtrusionProductionDragOver);
            dayCell.addEventListener('drop', handleExtrusionProductionDrop);
            dayCell.addEventListener('dragleave', handleExtrusionProductionDragLeave);
            
            row.appendChild(dayCell);
            
            // ì•¼ê°„ ì…€
            const nightCell = document.createElement('td');
            nightCell.className = 'shift-cell night-shift-bg';
            nightCell.dataset.workplace = workplace;
            nightCell.dataset.date = date;
            nightCell.dataset.shift = 'ì•¼';
            
            // í•´ë‹¹ ì‘ì—…ì¥, ë‚ ì§œ, ì•¼ê°„ì˜ ë°ì´í„° ì°¾ê¸°
            const nightItems = [];
            workplaceGroups[workplace].forEach(item => {
                if (item.productionQuantity && item.productionQuantity[date] && item.productionQuantity[date].night > 0) {
                    const unit = (item.unit === 'ST') ? 'PC' : item.unit;
                    nightItems.push({
                        name: item.materialDetail,
                        quantity: item.productionQuantity[date].night.toLocaleString(),
                        unit: unit,
                        materialNum: item.materialNum,
                        shift: 'night',
                        originalDate: date
                    });
                }
            });
            
            // ì¤‘ì‹ëŒ€ì‘ í•­ëª© ì¶”ê°€
            if (extrusionLunchBreakData[workplace] && extrusionLunchBreakData[workplace][date] && extrusionLunchBreakData[workplace][date].night) {
                extrusionLunchBreakData[workplace][date].night.forEach((lunchBreak, index) => {
                    nightItems.push({
                        name: '',
                        quantity: '',
                        unit: '',
                        materialNum: '',
                        shift: 'night',
                        originalDate: date,
                        isLunchBreak: true,
                        lunchBreakText: lunchBreak,
                        lunchBreakIndex: index
                    });
                });
            }
            
            // ê°œë°œ í•­ëª© ì¶”ê°€
            if (extrusionDevData[workplace] && extrusionDevData[workplace][date] && extrusionDevData[workplace][date].night) {
                extrusionDevData[workplace][date].night.forEach((devItem, index) => {
                    nightItems.push({
                        name: `ê°œë°œ ${devItem.timeText}`,
                        quantity: devItem.section,
                        unit: '',
                        materialNum: '',
                        shift: 'night',
                        originalDate: date,
                        isDev: true,
                        devSection: devItem.section,
                        devTimeText: devItem.timeText,
                        devIndex: index
                    });
                });
            }
            
            // ìˆœì„œ ì •ë³´ê°€ ìˆìœ¼ë©´ ì ìš©
            if (extrusionItemOrder && extrusionItemOrder[workplace] && extrusionItemOrder[workplace][date] && extrusionItemOrder[workplace][date].night) {
                try {
                    const order = extrusionItemOrder[workplace][date].night;
                    const orderedItems = [];
                    const unorderedItems = [...nightItems];
                    
                    // ìˆœì„œ ì •ë³´ì— ë”°ë¼ ì •ë ¬
                    order.forEach(orderItem => {
                        const foundIndex = unorderedItems.findIndex(item => {
                            if (orderItem.type === 'dev' && item.isDev) {
                                return item.devIndex === orderItem.devIndex;
                            } else if (orderItem.type === 'lunchBreak' && item.isLunchBreak) {
                                return item.lunchBreakIndex === orderItem.lunchBreakIndex;
                            } else if (orderItem.type === 'production' && !item.isDev && !item.isLunchBreak) {
                                return item.materialNum === orderItem.materialNum;
                            }
                            return false;
                        });
                        if (foundIndex !== -1) {
                            orderedItems.push(unorderedItems[foundIndex]);
                            unorderedItems.splice(foundIndex, 1);
                        }
                    });
                    
                    // ìˆœì„œ ì •ë³´ì— ì—†ëŠ” í•­ëª©ì€ ë’¤ì— ì¶”ê°€
                    nightItems = [...orderedItems, ...unorderedItems];
                } catch (e) {
                    console.error('ìˆœì„œ ì •ë³´ ì ìš© ì˜¤ë¥˜:', e);
                    // ì˜¤ë¥˜ ë°œìƒ ì‹œ ì›ë˜ ìˆœì„œ ìœ ì§€
                }
            }
            
            if (nightItems.length === 0) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'empty-cell';
                nightCell.appendChild(emptyDiv);
            } else {
                nightItems.forEach((item, index) => {
                    if (item.isLunchBreak) {
                        const lunchDiv = createLunchBreakItem(workplace, date, 'night', item.lunchBreakText, item.lunchBreakIndex);
                        nightCell.appendChild(lunchDiv);
                    } else if (item.isDev) {
                        const devDiv = createDevItem(workplace, date, 'night', item.devSection, item.devTimeText, item.devIndex);
                        nightCell.appendChild(devDiv);
                    } else {
                        const workDiv = createExtrusionWorkItemForWeeklyTable(item, workplace, date, 'night', index);
                        nightCell.appendChild(workDiv);
                    }
                });
            }
            
            // ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
            nightCell.addEventListener('dragover', handleExtrusionProductionDragOver);
            nightCell.addEventListener('drop', handleExtrusionProductionDrop);
            nightCell.addEventListener('dragleave', handleExtrusionProductionDragLeave);
            
            row.appendChild(nightCell);
        });
        
        tbody.appendChild(row);
    });
}

// ì••ì¶œ ìƒì‚°ê³„íš ì‘ì—… í•­ëª© ìš”ì†Œ ìƒì„± (ìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜ìš©)
function createExtrusionWorkItemElement(item) {
    const workDiv = document.createElement('div');
    workDiv.className = 'work-item';
    
    if (item.name) {
        const nameSpan = document.createElement('span');
        nameSpan.className = 'work-item-name';
        nameSpan.textContent = item.name;
        workDiv.appendChild(nameSpan);
    }
    
    if (item.quantity) {
        const quantitySpan = document.createElement('span');
        quantitySpan.className = 'work-item-quantity';
        quantitySpan.textContent = ` ${item.quantity}`;
        if (item.unit) {
            quantitySpan.textContent += ` (${item.unit})`;
        }
        workDiv.appendChild(quantitySpan);
    }
    
    workDiv.title = `${item.name} ${item.quantity}${item.unit ? ' (' + item.unit + ')' : ''}`;
    
    return workDiv;
}

// ì£¼ê°„ ìƒì‚°ê³„íš í…Œì´ë¸”ìš© ì••ì¶œ ì‘ì—… í•­ëª© ìš”ì†Œ ìƒì„± (ë“œë˜ê·¸ì•¤ë“œë¡­ ë° ìˆ˜ëŸ‰ í¸ì§‘ ì§€ì›)
function createExtrusionWorkItemForWeeklyTable(item, workplace, date, shift, index) {
    const workDiv = document.createElement('div');
    workDiv.className = 'work-item';
    workDiv.draggable = true;
    workDiv.dataset.workplace = workplace;
    workDiv.dataset.date = date;
    workDiv.dataset.shift = shift;
    workDiv.dataset.materialNum = item.materialNum;
    workDiv.dataset.index = index;
    workDiv.style.cursor = 'move';
    
    // ì´ë¦„ í‘œì‹œ
    if (item.name) {
        const nameSpan = document.createElement('span');
        nameSpan.className = 'work-item-name';
        nameSpan.textContent = item.name;
        workDiv.appendChild(nameSpan);
    }
    
    // ìˆ˜ëŸ‰ í‘œì‹œ (í¸ì§‘ ê°€ëŠ¥)
    if (item.quantity !== undefined) {
        const quantitySpan = document.createElement('span');
        quantitySpan.className = 'work-item-quantity';
        quantitySpan.style.cursor = 'text';
        quantitySpan.contentEditable = 'true';
        const originalQuantity = item.quantity;
        const unit = item.unit || '';
        quantitySpan.textContent = originalQuantity + (unit ? ` (${unit})` : '');
        
        // í´ë¦­ ì‹œ í¸ì§‘ ëª¨ë“œ ì§„ì… (ì „ì²´ í…ìŠ¤íŠ¸ ì„ íƒ)
        quantitySpan.addEventListener('click', function(e) {
            e.stopPropagation();
            const range = document.createRange();
            range.selectNodeContents(this);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
        });
        
        // ì—”í„°í‚¤ë¡œ ì ìš©
        quantitySpan.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                this.blur(); // blur ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ì—¬ ì ìš©ë¨
            } else if (e.key === 'Escape') {
                e.preventDefault();
                this.textContent = originalQuantity + (unit ? ` (${unit})` : '');
                this.blur();
            }
        });
        
        // ìˆ˜ëŸ‰ í¸ì§‘ ì´ë²¤íŠ¸ (blur ë˜ëŠ” ì—”í„°)
        quantitySpan.addEventListener('blur', function() {
            const text = this.textContent.trim();
            const match = text.match(/^([\d,]+)/);
            if (match) {
                const newQuantity = parseInt(match[1].replace(/,/g, '')) || 0;
                updateExtrusionQuantity(item.materialNum, date, shift, newQuantity.toString());
                renderExtrusionPlanTable(); // ìƒì‚°ê³„íš ê´€ë¦¬ í‘œ ì—…ë°ì´íŠ¸
                renderProductionTable(); // ì£¼ê°„ ìƒì‚°ê³„íš í…Œì´ë¸” ì—…ë°ì´íŠ¸
                renderExtrusionPlanProductionTable(); // ìƒì‚°ê³„íš ê´€ë¦¬ ì•„ë˜ í…Œì´ë¸” ì—…ë°ì´íŠ¸
            } else {
                // ì˜ëª»ëœ ì…ë ¥ ì‹œ ì›ë˜ ê°’ìœ¼ë¡œ ë³µì›
                this.textContent = originalQuantity + (unit ? ` (${unit})` : '');
            }
        });
        
        workDiv.appendChild(quantitySpan);
    }
    
    workDiv.title = `${item.name} ${item.quantity}${item.unit ? ' (' + item.unit + ')' : ''}`;
    
    // ë“œë˜ê·¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
    workDiv.addEventListener('dragstart', handleExtrusionWorkItemDragStart);
    workDiv.addEventListener('dragend', handleExtrusionWorkItemDragEnd);
    
    // work-item ê°„ ë“œë˜ê·¸ì•¤ë“œë¡­ (ê°™ì€ ë‚ ì§œ ë‚´ ìˆœì„œ ë³€ê²½ìš©)
    workDiv.addEventListener('dragover', handleExtrusionWorkItemDragOver);
    workDiv.addEventListener('drop', handleExtrusionWorkItemDrop);
    workDiv.addEventListener('dragleave', handleExtrusionWorkItemDragLeave);
    
    return workDiv;
}

// ì¤‘ì‹ëŒ€ì‘ í•­ëª© ìƒì„± í•¨ìˆ˜
function createLunchBreakItem(workplace, date, shift, lunchBreakText, index) {
    const lunchDiv = document.createElement('div');
    lunchDiv.className = 'work-item';
    lunchDiv.draggable = true;
    lunchDiv.style.borderLeft = '3px solid #e74c3c';
    lunchDiv.style.color = '#e74c3c';
    lunchDiv.style.fontWeight = 'bold';
    lunchDiv.dataset.workplace = workplace;
    lunchDiv.dataset.date = date;
    lunchDiv.dataset.shift = shift;
    lunchDiv.dataset.isLunchBreak = 'true';
    lunchDiv.dataset.lunchBreakText = lunchBreakText;
    lunchDiv.dataset.index = index;
    lunchDiv.style.cursor = 'move';
    
    const noteSpan = document.createElement('span');
    noteSpan.className = 'work-item-note';
    noteSpan.textContent = lunchBreakText;
    noteSpan.style.color = '#e74c3c';
    lunchDiv.appendChild(noteSpan);
    
    lunchDiv.title = lunchBreakText;
    
    // ë“œë˜ê·¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
    lunchDiv.addEventListener('dragstart', handleExtrusionWorkItemDragStart);
    lunchDiv.addEventListener('dragend', handleExtrusionWorkItemDragEnd);
    
    // work-item ê°„ ë“œë˜ê·¸ì•¤ë“œë¡­
    lunchDiv.addEventListener('dragover', handleExtrusionWorkItemDragOver);
    lunchDiv.addEventListener('drop', handleExtrusionWorkItemDrop);
    lunchDiv.addEventListener('dragleave', handleExtrusionWorkItemDragLeave);
    
    // ìš°í´ë¦­ ì‚­ì œ
    lunchDiv.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        if (confirm('ì´ ì¤‘ì‹ëŒ€ì‘ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            removeLunchBreakItem(workplace, date, shift, index);
        }
        return false;
    });
    
    return lunchDiv;
}

// ê°œë°œ í•­ëª© ìƒì„± í•¨ìˆ˜
function createDevItem(workplace, date, shift, section, timeText, index) {
    const devDiv = document.createElement('div');
    devDiv.className = 'work-item';
    devDiv.draggable = true;
    devDiv.style.borderLeft = '3px solid var(--accent)';
    devDiv.style.color = 'var(--accent)';
    devDiv.style.fontWeight = 'bold';
    devDiv.dataset.workplace = workplace;
    devDiv.dataset.date = date;
    devDiv.dataset.shift = shift;
    devDiv.dataset.isDev = 'true';
    devDiv.dataset.devSection = section;
    devDiv.dataset.devTimeText = timeText;
    devDiv.dataset.index = index;
    devDiv.style.cursor = 'move';
    
    const nameSpan = document.createElement('span');
    nameSpan.className = 'work-item-name';
    nameSpan.textContent = `ê°œë°œ ${timeText}`;
    nameSpan.style.color = 'var(--accent)';
    devDiv.appendChild(nameSpan);
    
    const quantitySpan = document.createElement('span');
    quantitySpan.className = 'work-item-quantity';
    quantitySpan.textContent = ` ${section}`;
    quantitySpan.style.color = 'var(--accent)';
    devDiv.appendChild(quantitySpan);
    
    devDiv.title = `ê°œë°œ ${timeText} ${section}`;
    
    // ë“œë˜ê·¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
    devDiv.addEventListener('dragstart', handleExtrusionWorkItemDragStart);
    devDiv.addEventListener('dragend', handleExtrusionWorkItemDragEnd);
    
    // work-item ê°„ ë“œë˜ê·¸ì•¤ë“œë¡­
    devDiv.addEventListener('dragover', handleExtrusionWorkItemDragOver);
    devDiv.addEventListener('drop', handleExtrusionWorkItemDrop);
    devDiv.addEventListener('dragleave', handleExtrusionWorkItemDragLeave);
    
    // ìš°í´ë¦­ ì‚­ì œ
    devDiv.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        if (confirm('ì´ ê°œë°œ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            removeDevItem(workplace, date, shift, index);
        }
        return false;
    });
    
    // ë”ë¸”í´ë¦­ìœ¼ë¡œ ì‹œì‘ ì‹œê°„ ì…ë ¥
    devDiv.addEventListener('dblclick', function(e) {
        e.stopPropagation();
        editDevStartTime(workplace, date, shift, section, timeText, index);
    });
    
    return devDiv;
}

// ê°œë°œ í•­ëª© ì‚­ì œ í•¨ìˆ˜
function removeDevItem(workplace, date, shift, index) {
    const shiftKey = shift === 'day' ? 'day' : 'night';
    
    if (extrusionDevData[workplace] && 
        extrusionDevData[workplace][date] && 
        extrusionDevData[workplace][date][shiftKey]) {
        extrusionDevData[workplace][date][shiftKey].splice(index, 1);
        
        // ë¹ˆ ë°°ì—´ì´ë©´ ë‚ ì§œ ê°ì²´ ì •ë¦¬
        if (extrusionDevData[workplace][date][shiftKey].length === 0) {
            delete extrusionDevData[workplace][date][shiftKey];
        }
        
        // ë‚ ì§œ ê°ì²´ê°€ ë¹„ì–´ìˆìœ¼ë©´ ì œê±°
        if (Object.keys(extrusionDevData[workplace][date]).length === 0) {
            delete extrusionDevData[workplace][date];
        }
        
        // ì‘ì—…ì¥ ê°ì²´ê°€ ë¹„ì–´ìˆìœ¼ë©´ ì œê±°
        if (Object.keys(extrusionDevData[workplace]).length === 0) {
            delete extrusionDevData[workplace];
        }
        
        // ë°ì´í„° ì €ì¥
        saveExtrusionDevData();
        
        // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
        renderExtrusionPlanProductionTable();
    }
}

// ê°œë°œ í•­ëª© ì‹œì‘ ì‹œê°„ í¸ì§‘ í•¨ìˆ˜
function editDevStartTime(workplace, date, shift, section, timeText, index) {
    // timeTextì—ì„œ ì‹œê°„ ì¶”ì¶œ (ì˜ˆ: "1.5ì‹œê°„" ë˜ëŠ” "08:30~10:00")
    let hours = 1.5; // ê¸°ë³¸ê°’ 1.5ì‹œê°„
    let currentStartTime = '';
    
    // "Xì‹œê°„" í˜•ì‹ì¸ì§€ í™•ì¸
    const hoursMatch = timeText.match(/(\d+\.?\d*)\s*ì‹œê°„/);
    if (hoursMatch) {
        hours = parseFloat(hoursMatch[1]);
    } else {
        // "HH:MM~HH:MM" í˜•ì‹ì¸ ê²½ìš° ì‹œì‘ ì‹œê°„ê³¼ ì¢…ë£Œ ì‹œê°„ ì¶”ì¶œí•˜ì—¬ ì‹œê°„ ê³„ì‚°
        const timeRangeMatch = timeText.match(/(\d{2}:\d{2})~(\d{2}:\d{2})/);
        if (timeRangeMatch) {
            currentStartTime = timeRangeMatch[1];
            const startParts = timeRangeMatch[1].split(':').map(Number);
            const endParts = timeRangeMatch[2].split(':').map(Number);
            const startMinutes = startParts[0] * 60 + startParts[1];
            const endMinutes = endParts[0] * 60 + endParts[1];
            hours = (endMinutes - startMinutes) / 60;
        }
    }
    
    // ì‹œì‘ ì‹œê°„ ì…ë ¥ ë°›ê¸°
    const timeInput = prompt(`ì‹œì‘ ì‹œê°„ì„ ì…ë ¥í•˜ì„¸ìš” (HH:MM í˜•ì‹):\ní˜„ì¬: ${currentStartTime || 'ì—†ìŒ'}\nê¸°ë³¸ ì‹œê°„: ${hours}ì‹œê°„`, currentStartTime || '08:30');
    
    if (timeInput === null) {
        return; // ì·¨ì†Œ
    }
    
    // ì‹œê°„ í˜•ì‹ ê²€ì¦ (HH:MM)
    const timePattern = /^(\d{1,2}):(\d{2})$/;
    const match = timeInput.trim().match(timePattern);
    
    if (!match) {
        alert('ì˜¬ë°”ë¥¸ ì‹œê°„ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì˜ˆ: 08:30)');
        return;
    }
    
    const hour = parseInt(match[1]);
    const minute = parseInt(match[2]);
    
    if (hour < 0 || hour > 23 || minute < 0 || minute > 59) {
        alert('ì˜¬ë°”ë¥¸ ì‹œê°„ ë²”ìœ„ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì‹œ: 0-23, ë¶„: 0-59)');
        return;
    }
    
    const startTime = `${String(hour).padStart(2, '0')}:${String(minute).padStart(2, '0')}`;
    
    // ì¢…ë£Œ ì‹œê°„ ê³„ì‚° (hours ë³€ìˆ˜ ì‚¬ìš©)
    const endTime = calculateEndTime(startTime, hours);
    const newTimeText = `${startTime}~${endTime}`;
    
    // ë°ì´í„° ì—…ë°ì´íŠ¸
    const shiftKey = shift === 'day' ? 'day' : 'night';
    
    if (extrusionDevData[workplace] && 
        extrusionDevData[workplace][date] && 
        extrusionDevData[workplace][date][shiftKey] &&
        extrusionDevData[workplace][date][shiftKey][index]) {
        extrusionDevData[workplace][date][shiftKey][index].timeText = newTimeText;
        
        // ë°ì´í„° ì €ì¥
        saveExtrusionDevData();
        
        // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
        renderExtrusionPlanProductionTable();
    }
}

// ì£¼ê°„ ìƒì‚°ê³„íš í…Œì´ë¸”ìš© ë“œë˜ê·¸ ë³€ìˆ˜
let draggedExtrusionWorkItem = null;

function handleExtrusionWorkItemDragStart(e) {
    const workItem = e.target.closest('.work-item');
    if (!workItem) return;
    
    draggedExtrusionWorkItem = {
        workplace: workItem.dataset.workplace,
        date: workItem.dataset.date,
        shift: workItem.dataset.shift,
        materialNum: workItem.dataset.materialNum,
        index: parseInt(workItem.dataset.index),
        isLunchBreak: workItem.dataset.isLunchBreak === 'true',
        lunchBreakText: workItem.dataset.lunchBreakText,
        lunchBreakIndex: parseInt(workItem.dataset.lunchBreakIndex) || -1,
        isDev: workItem.dataset.isDev === 'true',
        devSection: workItem.dataset.devSection,
        devTimeText: workItem.dataset.devTimeText,
        devIndex: parseInt(workItem.dataset.index) || -1
    };
    
    workItem.classList.add('dragging');
    e.dataTransfer.effectAllowed = 'move';
}

function handleExtrusionWorkItemDragEnd(e) {
    const workItem = e.target.closest('.work-item');
    if (workItem) {
        workItem.classList.remove('dragging');
    }
    document.querySelectorAll('.shift-cell').forEach(cell => {
        cell.classList.remove('drag-over');
    });
}

function handleExtrusionProductionDragOver(e) {
    e.preventDefault();
    e.dataTransfer.dropEffect = 'move';
    
    const cell = e.currentTarget;
    if (cell.classList.contains('shift-cell')) {
        cell.classList.add('drag-over');
    }
    return false;
}

function handleExtrusionProductionDragLeave(e) {
    e.currentTarget.classList.remove('drag-over');
}

// work-item ê°„ ë“œë˜ê·¸ì•¤ë“œë¡­ (ê°™ì€ ë‚ ì§œ ë‚´ ìˆœì„œ ë³€ê²½)
function handleExtrusionWorkItemDragOver(e) {
    e.preventDefault();
    e.stopPropagation();
    e.dataTransfer.dropEffect = 'move';
    
    const workItem = e.currentTarget;
    
    // ë“œë˜ê·¸ ì¤‘ì¸ í•­ëª©ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ í•˜ì´ë¼ì´íŠ¸
    if (!workItem.classList.contains('dragging')) {
        // ë§ˆìš°ìŠ¤ ìœ„ì¹˜ì— ë”°ë¼ ìœ„/ì•„ë˜ í‘œì‹œ
        const rect = workItem.getBoundingClientRect();
        const midpoint = rect.top + rect.height / 2;
        
        if (e.clientY < midpoint) {
            workItem.style.borderTop = '2px solid var(--primary-500)';
            workItem.style.borderBottom = '';
            workItem.dataset.dropPosition = 'before';
        } else {
            workItem.style.borderTop = '';
            workItem.style.borderBottom = '2px solid var(--primary-500)';
            workItem.dataset.dropPosition = 'after';
        }
    }
    
    return false;
}

function handleExtrusionWorkItemDragLeave(e) {
    const workItem = e.currentTarget;
    workItem.style.borderTop = '';
    workItem.style.borderBottom = '';
    delete workItem.dataset.dropPosition;
}

function handleExtrusionWorkItemDrop(e) {
    e.stopPropagation();
    e.preventDefault();
    
    const targetWorkItem = e.currentTarget;
    targetWorkItem.style.borderTop = '';
    targetWorkItem.style.borderBottom = '';
    
    if (!draggedExtrusionWorkItem) return false;
    
    const targetWorkplace = targetWorkItem.dataset.workplace;
    const targetDate = targetWorkItem.dataset.date;
    const targetShift = targetWorkItem.dataset.shift;
    const targetIndex = parseInt(targetWorkItem.dataset.index);
    const dropPosition = targetWorkItem.dataset.dropPosition || 'after';
    
    delete targetWorkItem.dataset.dropPosition;
    
    // ê°™ì€ ì‘ì—…ì¥, ê°™ì€ ë‚ ì§œ, ê°™ì€ êµëŒ€ ë‚´ì—ì„œë§Œ ìˆœì„œ ë³€ê²½ ê°€ëŠ¥
    if (draggedExtrusionWorkItem.workplace !== targetWorkplace ||
        draggedExtrusionWorkItem.date !== targetDate ||
        draggedExtrusionWorkItem.shift !== targetShift) {
        // ë‹¤ë¥¸ ë‚ ì§œ/êµëŒ€ë¡œ ì´ë™í•˜ëŠ” ê²½ìš°ëŠ” ì…€ ë“œë¡­ í•¸ë“¤ëŸ¬ë¡œ ì²˜ë¦¬
        return false;
    }
    
    // ê°™ì€ ì…€ ë‚´ì—ì„œ ìˆœì„œ ë³€ê²½
    const shiftKey = targetShift === 'ì£¼' ? 'day' : (targetShift === 'ì•¼' ? 'night' : targetShift);
    const draggedIndex = draggedExtrusionWorkItem.index;
    
    // ìˆœì„œ ì •ë³´ ì´ˆê¸°í™”
    if (!extrusionItemOrder[targetWorkplace]) {
        extrusionItemOrder[targetWorkplace] = {};
    }
    if (!extrusionItemOrder[targetWorkplace][targetDate]) {
        extrusionItemOrder[targetWorkplace][targetDate] = {};
    }
    if (!extrusionItemOrder[targetWorkplace][targetDate][shiftKey]) {
        // í˜„ì¬ ì…€ì˜ ëª¨ë“  í•­ëª© ìˆ˜ì§‘í•˜ì—¬ ìˆœì„œ ë°°ì—´ ìƒì„±
        const cell = document.querySelector(`td[data-workplace="${targetWorkplace}"][data-date="${targetDate}"][data-shift="${targetShift === 'day' ? 'ì£¼' : 'ì•¼'}"]`);
        if (cell) {
            const items = Array.from(cell.querySelectorAll('.work-item'));
            extrusionItemOrder[targetWorkplace][targetDate][shiftKey] = items.map((item, idx) => ({
                type: item.dataset.isDev === 'true' ? 'dev' : (item.dataset.isLunchBreak === 'true' ? 'lunchBreak' : 'production'),
                materialNum: item.dataset.materialNum || '',
                index: parseInt(item.dataset.index) || idx,
                devIndex: item.dataset.isDev === 'true' ? (parseInt(item.dataset.index) || idx) : -1,
                lunchBreakIndex: item.dataset.isLunchBreak === 'true' ? (parseInt(item.dataset.lunchBreakIndex) || idx) : -1
            }));
        } else {
            extrusionItemOrder[targetWorkplace][targetDate][shiftKey] = [];
        }
    }
    
    // ìˆœì„œ ë°°ì—´ì—ì„œ í•­ëª© ì´ë™
    const orderArray = extrusionItemOrder[targetWorkplace][targetDate][shiftKey];
    const draggedItem = orderArray[draggedIndex];
    if (draggedItem) {
        orderArray.splice(draggedIndex, 1);
        // targetIndexê°€ draggedIndexë³´ë‹¤ í¬ë©´ 1 ê°ì†Œ (ì œê±°ëœ í•­ëª© ë•Œë¬¸ì—)
        const adjustedTargetIndex = draggedIndex < targetIndex ? targetIndex - 1 : targetIndex;
        const insertIndex = dropPosition === 'before' ? adjustedTargetIndex : adjustedTargetIndex + 1;
        orderArray.splice(Math.min(insertIndex, orderArray.length), 0, draggedItem);
    }
    
    // localStorageì— ìˆœì„œ ì •ë³´ ì €ì¥
    try {
        localStorage.setItem('extrusionItemOrder', JSON.stringify(extrusionItemOrder));
    } catch (e) {
        console.error('ìˆœì„œ ì •ë³´ ì €ì¥ ì‹¤íŒ¨:', e);
    }
    
    // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
    renderExtrusionPlanProductionTable();
    
    draggedExtrusionWorkItem = null;
    return false;
}

function handleExtrusionProductionDrop(e) {
    e.stopPropagation();
    e.preventDefault();
    
    const targetCell = e.currentTarget;
    targetCell.classList.remove('drag-over');
    
    if (!draggedExtrusionWorkItem) return false;
    
    const targetWorkplace = targetCell.dataset.workplace;
    const targetDate = targetCell.dataset.date;
    const targetShift = targetCell.dataset.shift === 'ì£¼' ? 'day' : 'night';
    
    // ê°™ì€ ì‘ì—…ì¥ ë‚´ì—ì„œë§Œ ì´ë™ ê°€ëŠ¥
    if (draggedExtrusionWorkItem.workplace !== targetWorkplace) {
        alert('ê°™ì€ í˜¸ê¸° ë‚´ì—ì„œë§Œ ì‘ì—…ì„ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        draggedExtrusionWorkItem = null;
        return false;
    }
    
    const oldDate = draggedExtrusionWorkItem.date;
    const oldShift = draggedExtrusionWorkItem.shift === 'ì£¼' ? 'day' : (draggedExtrusionWorkItem.shift === 'ì•¼' ? 'night' : draggedExtrusionWorkItem.shift);
    
    // ì¤‘ì‹ëŒ€ì‘ í•­ëª©ì¸ ê²½ìš°
    if (draggedExtrusionWorkItem.isLunchBreak) {
        const oldShiftKey = oldShift === 'ì£¼' ? 'day' : (oldShift === 'ì•¼' ? 'night' : oldShift);
        const lunchBreakText = draggedExtrusionWorkItem.lunchBreakText;
        const oldIndex = draggedExtrusionWorkItem.lunchBreakIndex;
        
        // ê¸°ì¡´ ìœ„ì¹˜ì—ì„œ ì œê±°
        if (extrusionLunchBreakData[draggedExtrusionWorkItem.workplace] && 
            extrusionLunchBreakData[draggedExtrusionWorkItem.workplace][oldDate] &&
            extrusionLunchBreakData[draggedExtrusionWorkItem.workplace][oldDate][oldShiftKey]) {
            extrusionLunchBreakData[draggedExtrusionWorkItem.workplace][oldDate][oldShiftKey].splice(oldIndex, 1);
        }
        
        // ìƒˆ ìœ„ì¹˜ì— ì¶”ê°€
        if (!extrusionLunchBreakData[targetWorkplace]) {
            extrusionLunchBreakData[targetWorkplace] = {};
        }
        if (!extrusionLunchBreakData[targetWorkplace][targetDate]) {
            extrusionLunchBreakData[targetWorkplace][targetDate] = { day: [], night: [] };
        }
        extrusionLunchBreakData[targetWorkplace][targetDate][targetShift].push(lunchBreakText);
        
        saveExtrusionLunchBreakData();
        renderExtrusionPlanProductionTable();
        
        draggedExtrusionWorkItem = null;
        return false;
    }
    
    // ê°œë°œ í•­ëª©ì¸ ê²½ìš°
    if (draggedExtrusionWorkItem.isDev) {
        const oldShiftKey = oldShift === 'ì£¼' ? 'day' : (oldShift === 'ì•¼' ? 'night' : oldShift);
        const devSection = draggedExtrusionWorkItem.devSection;
        const devTimeText = draggedExtrusionWorkItem.devTimeText;
        const oldIndex = draggedExtrusionWorkItem.devIndex;
        
        // ê¸°ì¡´ ìœ„ì¹˜ì—ì„œ ì œê±°
        if (extrusionDevData[draggedExtrusionWorkItem.workplace] && 
            extrusionDevData[draggedExtrusionWorkItem.workplace][oldDate] &&
            extrusionDevData[draggedExtrusionWorkItem.workplace][oldDate][oldShiftKey]) {
            extrusionDevData[draggedExtrusionWorkItem.workplace][oldDate][oldShiftKey].splice(oldIndex, 1);
        }
        
        // ìƒˆ ìœ„ì¹˜ì— ì¶”ê°€
        if (!extrusionDevData[targetWorkplace]) {
            extrusionDevData[targetWorkplace] = {};
        }
        if (!extrusionDevData[targetWorkplace][targetDate]) {
            extrusionDevData[targetWorkplace][targetDate] = { day: [], night: [] };
        }
        extrusionDevData[targetWorkplace][targetDate][targetShift].push({
            section: devSection,
            timeText: devTimeText
        });
        
        saveExtrusionDevData();
        renderExtrusionPlanProductionTable();
        
        draggedExtrusionWorkItem = null;
        return false;
    }
    
    // ê°™ì€ ë‚ ì§œ, ê°™ì€ êµëŒ€ì¸ ê²½ìš°ëŠ” ìˆœì„œ ë³€ê²½ë§Œ (ë°ì´í„° ë³€ê²½ ì—†ìŒ)
    if (oldDate === targetDate && oldShift === targetShift) {
        draggedExtrusionWorkItem = null;
        return false;
    }
    
    // ìƒì‚°ê³„íš ë°ì´í„° ì—…ë°ì´íŠ¸
    const item = extrusionPlanData.find(i => i.materialNum === draggedExtrusionWorkItem.materialNum);
    if (item && item.productionQuantity) {
        const quantity = item.productionQuantity[oldDate] && item.productionQuantity[oldDate][oldShift] ? item.productionQuantity[oldDate][oldShift] : 0;
        
        // ê¸°ì¡´ ë‚ ì§œì—ì„œ ìˆ˜ëŸ‰ ì œê±°
        if (item.productionQuantity[oldDate]) {
            item.productionQuantity[oldDate][oldShift] = 0;
        }
        
        // ìƒˆ ë‚ ì§œì— ìˆ˜ëŸ‰ ì¶”ê°€
        if (!item.productionQuantity[targetDate]) {
            item.productionQuantity[targetDate] = { day: 0, night: 0 };
        }
        item.productionQuantity[targetDate][targetShift] = quantity;
        
        // filteredExtrusionPlanDataë„ ì—…ë°ì´íŠ¸
        const filteredItem = filteredExtrusionPlanData.find(i => i.materialNum === draggedExtrusionWorkItem.materialNum);
        if (filteredItem && filteredItem.productionQuantity) {
            if (filteredItem.productionQuantity[oldDate]) {
                filteredItem.productionQuantity[oldDate][oldShift] = 0;
            }
            if (!filteredItem.productionQuantity[targetDate]) {
                filteredItem.productionQuantity[targetDate] = { day: 0, night: 0 };
            }
            filteredItem.productionQuantity[targetDate][targetShift] = quantity;
        }
        
        // ëª¨ë“  í…Œì´ë¸” ì—…ë°ì´íŠ¸
        renderProductionTable();
        renderExtrusionPlanTable();
        renderExtrusionPlanProductionTable();
    }
    
    draggedExtrusionWorkItem = null;
    return false;
}

// ìƒì‚°ê³„íš ê´€ë¦¬ ì„¹ì…˜ìš© ìº˜ë¦°ë” ë Œë”ë§ (ì „ì²´ ë°ì´í„° í‘œì‹œ)
let extrusionPlanCalendarDate = new Date(2024, 11, 1); // 2024ë…„ 12ì›”

function renderExtrusionPlanCalendar() {
    const container = document.getElementById('extrusion-plan-calendar-grid');
    const monthYearEl = document.getElementById('extrusion-plan-calendar-month-year');
    
    if (!container) return;
    
    const year = extrusionPlanCalendarDate.getFullYear();
    const month = extrusionPlanCalendarDate.getMonth();
    
    // Update month/year header
    const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
    monthYearEl.textContent = `${year}ë…„ ${monthNames[month]}`;
    
    // Clear container
    container.innerHTML = '';
    
    // Add day headers
    const dayHeaders = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
    dayHeaders.forEach((day, index) => {
        const header = document.createElement('div');
        header.className = 'calendar-day-header';
        if (index === 0) header.classList.add('sunday');
        if (index === 6) header.classList.add('saturday');
        header.textContent = day;
        container.appendChild(header);
    });
    
    // Get first day of month and number of days
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();
    const startingDayOfWeek = firstDay.getDay();
    
    // Add empty cells for days before month starts
    const prevMonth = month === 0 ? 11 : month - 1;
    const prevYear = month === 0 ? year - 1 : year;
    const prevMonthLastDay = new Date(prevYear, prevMonth + 1, 0).getDate();
    
    for (let i = 0; i < startingDayOfWeek; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day other-month';
        const prevDay = prevMonthLastDay - startingDayOfWeek + i + 1;
        const prevDate = new Date(prevYear, prevMonth, prevDay);
        const prevDateStr = formatDateForCalendar(prevDate);
        emptyDay.dataset.date = prevDateStr;
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = prevDay;
        emptyDay.appendChild(dayNumber);
        
        // ì´ì „ ì›” ë‚ ì§œì˜ ì´ë²¤íŠ¸ í‘œì‹œ (ì „ì²´ ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„°)
        addExtrusionCalendarEventsToDay(emptyDay, prevDateStr);
        
        emptyDay.addEventListener('dragover', handleDragOver);
        emptyDay.addEventListener('drop', handleDrop);
        emptyDay.addEventListener('dragleave', handleDragLeave);
        
        container.appendChild(emptyDay);
    }
    
    // Add days of month
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    for (let day = 1; day <= daysInMonth; day++) {
        const dayEl = document.createElement('div');
        const currentDate = new Date(year, month, day);
        const dateStr = formatDateForCalendar(currentDate);
        const dayOfWeek = currentDate.getDay();
        
        dayEl.className = 'calendar-day';
        dayEl.dataset.date = dateStr;
        
        if (dayOfWeek === 0) dayEl.classList.add('sunday');
        if (dayOfWeek === 6) dayEl.classList.add('saturday');
        
        const holidayName = isHoliday(currentDate);
        if (holidayName) {
            dayEl.classList.add('holiday');
        }
        
        if (currentDate.getTime() === today.getTime()) {
            dayEl.classList.add('calendar-today');
        }
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = day;
        dayEl.appendChild(dayNumber);
        
        // ê³µíœ´ì¼ ë¼ë²¨ ì¶”ê°€
        if (holidayName) {
            const holidayLabel = document.createElement('div');
            holidayLabel.className = 'calendar-holiday-label';
            holidayLabel.textContent = holidayName;
            dayEl.appendChild(holidayLabel);
        }
        
        // ì´ë²¤íŠ¸ í‘œì‹œ (ì „ì²´ ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„°)
        addExtrusionCalendarEventsToDay(dayEl, dateStr);
        
        // ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        dayEl.addEventListener('dragover', handleDragOver);
        dayEl.addEventListener('drop', handleDrop);
        dayEl.addEventListener('dragleave', handleDragLeave);
        
        container.appendChild(dayEl);
    }
    
    // Add empty cells for days after month ends
    const totalCells = container.children.length;
    const totalDayCells = totalCells - 7; // í—¤ë” 7ì¹¸ ì œì™¸
    const remainingCells = 35 - totalDayCells; // 5 weeks * 7 days = 35ì¹¸
    const nextMonth = month === 11 ? 0 : month + 1;
    const nextYear = month === 11 ? year + 1 : year;
    
    for (let i = 0; i < remainingCells; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day other-month';
        const nextDay = i + 1;
        const nextDate = new Date(nextYear, nextMonth, nextDay);
        const nextDateStr = formatDateForCalendar(nextDate);
        emptyDay.dataset.date = nextDateStr;
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = nextDay;
        emptyDay.appendChild(dayNumber);
        
        addExtrusionCalendarEventsToDay(emptyDay, nextDateStr);
        
        emptyDay.addEventListener('dragover', handleDragOver);
        emptyDay.addEventListener('drop', handleDrop);
        emptyDay.addEventListener('dragleave', handleDragLeave);
        
        container.appendChild(emptyDay);
    }
}

// ìƒì‚°ê³„íš ê´€ë¦¬ ìº˜ë¦°ë”ì— ì••ì¶œ ìƒì‚°ê³„íš ì´ë²¤íŠ¸ ì¶”ê°€ (ì „ì²´ ë°ì´í„° ì‚¬ìš©)
function addExtrusionCalendarEventsToDay(dayEl, dateStr) {
    // dateStr í˜•ì‹: "2024-12-01"
    // ìƒì‚°ê³„íš ë‚ ì§œ í˜•ì‹: "12/1"
    const dateParts = dateStr.split('-');
    const month = parseInt(dateParts[1]);
    const day = parseInt(dateParts[2]);
    const planDate = `${month}/${day}`;
    
    // ê°œë°œ í•­ëª© ì¶”ê°€ (calendarDataì—ì„œ)
    if (calendarData && calendarData.length > 0) {
        calendarData.forEach(item => {
            if (item.date === dateStr && item.type === 'development') {
                const eventEl = document.createElement('div');
                eventEl.className = 'calendar-event';
                eventEl.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
                eventEl.style.color = '#ffffff';
                eventEl.textContent = item.detail;
                eventEl.title = item.detail;
                eventEl.dataset.type = 'development';
                eventEl.dataset.date = dateStr;
                eventEl.dataset.detail = item.detail;
                
                // ìš°í´ë¦­ ì‚­ì œ ê¸°ëŠ¥
                eventEl.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    if (confirm('ì´ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        deleteExtrusionCalendarEvent(eventEl);
                    }
                    return false;
                });
                
                dayEl.appendChild(eventEl);
            }
        });
    }
    
    // ì „ì²´ ë°ì´í„°ë¥¼ ì‚¬ìš© (í•„í„°ë§ë˜ì§€ ì•Šì€)
    if (!extrusionPlanData || extrusionPlanData.length === 0) return;
    
    extrusionPlanData.forEach(item => {
        if (!item.productionQuantity || !item.productionQuantity[planDate]) return;
        
        const pq = item.productionQuantity[planDate];
        const unit = (item.unit === 'ST') ? 'PC' : item.unit;
        
        // ì£¼ê°„ ìˆ˜ëŸ‰ì´ ìˆìœ¼ë©´ í‘œì‹œ
        if (pq.day > 0) {
            const eventEl = document.createElement('div');
            eventEl.className = 'calendar-event';
            eventEl.draggable = true;
            eventEl.textContent = `${item.materialDetail}/${unit}/${pq.day.toLocaleString()}`;
            eventEl.title = `${item.materialDetail} (${unit}) ${pq.day.toLocaleString()}`;
            eventEl.dataset.materialNum = item.materialNum;
            eventEl.dataset.date = planDate;
            eventEl.dataset.shift = 'day';
            eventEl.dataset.originalDate = planDate;
            eventEl.dataset.type = 'extrusion';
            eventEl.dataset.materialDetail = item.materialDetail;
            eventEl.dataset.unit = unit;
            eventEl.dataset.quantity = pq.day;
            
            eventEl.addEventListener('dragstart', handleDragStart);
            eventEl.addEventListener('dragend', handleDragEnd);
            eventEl.addEventListener('dblclick', function() {
                editExtrusionCalendarQuantity(eventEl);
            });
            
            // ìš°í´ë¦­ ì‚­ì œ ê¸°ëŠ¥
            eventEl.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                if (confirm('ì´ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    deleteExtrusionCalendarEvent(eventEl);
                }
                return false;
            });
            
            dayEl.appendChild(eventEl);
        }
        
        // ì•¼ê°„ ìˆ˜ëŸ‰ì´ ìˆìœ¼ë©´ í‘œì‹œ
        if (pq.night > 0) {
            const eventEl = document.createElement('div');
            eventEl.className = 'calendar-event';
            eventEl.draggable = true;
            eventEl.style.background = 'var(--accent-200)';
            eventEl.textContent = `${item.materialDetail}/${unit}/${pq.night.toLocaleString()}`;
            eventEl.title = `${item.materialDetail} (${unit}) ${pq.night.toLocaleString()} (ì•¼ê°„)`;
            eventEl.dataset.materialNum = item.materialNum;
            eventEl.dataset.date = planDate;
            eventEl.dataset.shift = 'night';
            eventEl.dataset.originalDate = planDate;
            eventEl.dataset.type = 'extrusion';
            eventEl.dataset.materialDetail = item.materialDetail;
            eventEl.dataset.unit = unit;
            eventEl.dataset.quantity = pq.night;
            
            eventEl.addEventListener('dragstart', handleDragStart);
            eventEl.addEventListener('dragend', handleDragEnd);
            eventEl.addEventListener('dblclick', function() {
                editExtrusionCalendarQuantity(eventEl);
            });
            
            // ìš°í´ë¦­ ì‚­ì œ ê¸°ëŠ¥
            eventEl.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                if (confirm('ì´ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    deleteExtrusionCalendarEvent(eventEl);
                }
                return false;
            });
            
            dayEl.appendChild(eventEl);
        }
    });
}

// ìƒì‚°ê³„íš ê´€ë¦¬ ìº˜ë¦°ë” ë„¤ë¹„ê²Œì´ì…˜
document.addEventListener('DOMContentLoaded', function() {
    const prevBtn = document.getElementById('extrusion-plan-prev-month');
    const nextBtn = document.getElementById('extrusion-plan-next-month');
    
    if (prevBtn) {
        prevBtn.addEventListener('click', () => {
            extrusionPlanCalendarDate.setMonth(extrusionPlanCalendarDate.getMonth() - 1);
            renderExtrusionPlanCalendar();
        });
    }
    
    if (nextBtn) {
        nextBtn.addEventListener('click', () => {
            extrusionPlanCalendarDate.setMonth(extrusionPlanCalendarDate.getMonth() + 1);
            renderExtrusionPlanCalendar();
        });
    }
});

// ì••ì¶œ ìƒì‚°ê³„íš ìº˜ë¦°ë” ë Œë”ë§
function renderExtrusionCalendar() {
    const container = document.getElementById('extrusion-calendar-grid');
    const monthYearEl = document.getElementById('extrusion-calendar-month-year');
    
    if (!container) return;
    
    const year = currentExtrusionCalendarDate.getFullYear();
    const month = currentExtrusionCalendarDate.getMonth();
    
    // Update month/year header
    const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
    monthYearEl.textContent = `${year}ë…„ ${monthNames[month]}`;
    
    // Clear container
    container.innerHTML = '';
    
    // Add day headers
    const dayHeaders = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
    dayHeaders.forEach((day, index) => {
        const header = document.createElement('div');
        header.className = 'calendar-day-header';
        if (index === 0) header.classList.add('sunday');
        if (index === 6) header.classList.add('saturday');
        header.textContent = day;
        container.appendChild(header);
    });
    
    // Get first day of month and number of days
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();
    const startingDayOfWeek = firstDay.getDay();
    
    // Add empty cells for days before month starts
    const prevMonth = month === 0 ? 11 : month - 1;
    const prevYear = month === 0 ? year - 1 : year;
    const prevMonthLastDay = new Date(prevYear, prevMonth + 1, 0).getDate();
    
    for (let i = 0; i < startingDayOfWeek; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day other-month';
        const prevDay = prevMonthLastDay - startingDayOfWeek + i + 1;
        const prevDate = new Date(prevYear, prevMonth, prevDay);
        const prevDateStr = formatDateForCalendar(prevDate);
        emptyDay.dataset.date = prevDateStr;
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = prevDay;
        emptyDay.appendChild(dayNumber);
        
        // ì´ì „ ì›” ë‚ ì§œì˜ ì´ë²¤íŠ¸ í‘œì‹œ (ê°œë°œ/ì¤‘ì‹ëŒ€ì‘ë§Œ)
        addExtrusionCalendarEvents(emptyDay, prevDateStr);
        
        emptyDay.addEventListener('dragover', handleExtrusionDragOver);
        emptyDay.addEventListener('drop', handleExtrusionDrop);
        emptyDay.addEventListener('dragleave', handleExtrusionDragLeave);
        
        container.appendChild(emptyDay);
    }
    
    // Add days of month
    for (let day = 1; day <= daysInMonth; day++) {
        const dayEl = document.createElement('div');
        const currentDate = new Date(year, month, day);
        const dateStr = formatDateForCalendar(currentDate);
        const dayOfWeek = currentDate.getDay();
        
        dayEl.className = 'calendar-day';
        dayEl.dataset.date = dateStr;
        
        if (dayOfWeek === 0) dayEl.classList.add('sunday');
        if (dayOfWeek === 6) dayEl.classList.add('saturday');
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = day;
        dayEl.appendChild(dayNumber);
        
        // ì´ë²¤íŠ¸ í‘œì‹œ (ê°œë°œ/ì¤‘ì‹ëŒ€ì‘ ì œì™¸í•˜ê³  ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„° í‘œì‹œ)
        addExtrusionCalendarEvents(dayEl, dateStr);
        
        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸
        dayEl.addEventListener('dragover', handleExtrusionDragOver);
        dayEl.addEventListener('drop', handleExtrusionDrop);
        dayEl.addEventListener('dragleave', handleExtrusionDragLeave);
        
        container.appendChild(dayEl);
    }
    
    // Add empty cells for days after month ends
    const nextMonth = month === 11 ? 0 : month + 1;
    const nextYear = month === 11 ? year + 1 : year;
    const totalCells = container.children.length - 7; // í—¤ë” ì œì™¸
    const remainingCells = 42 - totalCells; // 6ì£¼ * 7ì¼ = 42
    
    for (let i = 1; i <= remainingCells; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day other-month';
        const nextDate = new Date(nextYear, nextMonth, i);
        const nextDateStr = formatDateForCalendar(nextDate);
        emptyDay.dataset.date = nextDateStr;
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = i;
        emptyDay.appendChild(dayNumber);
        
        addExtrusionCalendarEvents(emptyDay, nextDateStr);
        
        emptyDay.addEventListener('dragover', handleExtrusionDragOver);
        emptyDay.addEventListener('drop', handleExtrusionDrop);
        emptyDay.addEventListener('dragleave', handleExtrusionDragLeave);
        
        container.appendChild(emptyDay);
    }
}

// ì••ì¶œ ìº˜ë¦°ë” ì´ë²¤íŠ¸ ì¶”ê°€ (ê°œë°œ/ì¤‘ì‹ëŒ€ì‘ ì œì™¸)
function addExtrusionCalendarEvents(dayEl, dateStr) {
    // dateStr í˜•ì‹: "2024-12-01"
    // ìƒì‚°ê³„íš ë‚ ì§œ í˜•ì‹: "12/1"
    const dateParts = dateStr.split('-');
    const month = parseInt(dateParts[1]);
    const day = parseInt(dateParts[2]);
    const planDate = `${month}/${day}`;
    
    // í•„í„°ë§ëœ ë°ì´í„°ì—ì„œ í•´ë‹¹ ë‚ ì§œì˜ í•­ëª© ì°¾ê¸°
    filteredExtrusionPlanData.forEach(item => {
        if (!item.productionQuantity || !item.productionQuantity[planDate]) return;
        
        const pq = item.productionQuantity[planDate];
        
        // ì£¼ê°„ ìˆ˜ëŸ‰ì´ ìˆìœ¼ë©´ í‘œì‹œ
        if (pq.day > 0) {
            const eventEl = document.createElement('div');
            eventEl.className = 'calendar-event';
            eventEl.draggable = true;
            eventEl.textContent = `${item.materialDetail}/${item.unit}/${pq.day.toLocaleString()}`;
            eventEl.title = `${item.materialDetail} (${item.unit}) ${pq.day.toLocaleString()}`;
            eventEl.dataset.materialNum = item.materialNum;
            eventEl.dataset.date = planDate;
            eventEl.dataset.shift = 'day';
            eventEl.dataset.materialDetail = item.materialDetail;
            eventEl.dataset.unit = item.unit;
            eventEl.dataset.quantity = pq.day;
            
            eventEl.addEventListener('dragstart', handleExtrusionDragStart);
            eventEl.addEventListener('dragend', handleExtrusionDragEnd);
            eventEl.addEventListener('dblclick', function() {
                editExtrusionCalendarQuantity(eventEl);
            });
            
            dayEl.appendChild(eventEl);
        }
        
        // ì•¼ê°„ ìˆ˜ëŸ‰ì´ ìˆìœ¼ë©´ í‘œì‹œ
        if (pq.night > 0) {
            const eventEl = document.createElement('div');
            eventEl.className = 'calendar-event';
            eventEl.draggable = true;
            eventEl.style.background = 'var(--accent-200)';
            eventEl.textContent = `${item.materialDetail}/${item.unit}/${pq.night.toLocaleString()}`;
            eventEl.title = `${item.materialDetail} (${item.unit}) ${pq.night.toLocaleString()} (ì•¼ê°„)`;
            eventEl.dataset.materialNum = item.materialNum;
            eventEl.dataset.date = planDate;
            eventEl.dataset.shift = 'night';
            eventEl.dataset.materialDetail = item.materialDetail;
            eventEl.dataset.unit = item.unit;
            eventEl.dataset.quantity = pq.night;
            
            eventEl.addEventListener('dragstart', handleExtrusionDragStart);
            eventEl.addEventListener('dragend', handleExtrusionDragEnd);
            eventEl.addEventListener('dblclick', function() {
                editExtrusionCalendarQuantity(eventEl);
            });
            
            dayEl.appendChild(eventEl);
        }
    });
}

// ì••ì¶œ ìº˜ë¦°ë” ë“œë˜ê·¸ ì‹œì‘
let draggedExtrusionEvent = null;
function handleExtrusionDragStart(e) {
    draggedExtrusionEvent = {
        materialNum: e.target.dataset.materialNum,
        date: e.target.dataset.date,
        shift: e.target.dataset.shift,
        materialDetail: e.target.dataset.materialDetail,
        unit: e.target.dataset.unit,
        quantity: parseInt(e.target.dataset.quantity)
    };
    e.target.classList.add('dragging');
}

function handleExtrusionDragEnd(e) {
    e.target.classList.remove('dragging');
    document.querySelectorAll('.calendar-day.drag-over').forEach(el => {
        el.classList.remove('drag-over');
    });
}

function handleExtrusionDragOver(e) {
    e.preventDefault();
    e.stopPropagation();
    const dayEl = e.currentTarget;
    if (dayEl.classList.contains('calendar-day')) {
        dayEl.classList.add('drag-over');
    }
    return false;
}

function handleExtrusionDragLeave(e) {
    e.currentTarget.classList.remove('drag-over');
}

function handleExtrusionDrop(e) {
    if (e.stopPropagation) {
        e.stopPropagation();
    }
    
    e.preventDefault();
    
    const dayEl = e.currentTarget;
    if (!dayEl.classList.contains('calendar-day')) {
        return false;
    }
    
    dayEl.classList.remove('drag-over');
    
    if (!draggedExtrusionEvent) return false;
    
    // ë‚ ì§œ ì¶”ì¶œ
    let newDate;
    if (dayEl.dataset.date) {
        const dateParts = dayEl.dataset.date.split('-');
        newDate = new Date(parseInt(dateParts[0]), parseInt(dateParts[1]) - 1, parseInt(dateParts[2]));
    } else {
        const dayNumber = parseInt(dayEl.querySelector('.calendar-day-number')?.textContent);
        if (!dayNumber) return false;
        const year = currentExtrusionCalendarDate.getFullYear();
        const month = currentExtrusionCalendarDate.getMonth();
        newDate = new Date(year, month, dayNumber);
    }
    
    const newDateStr = formatDateForCalendar(newDate);
    const month = newDate.getMonth() + 1;
    const day = newDate.getDate();
    const newPlanDate = `${month}/${day}`;
    
    // ìƒì‚°ê³„íš ë°ì´í„° ì—…ë°ì´íŠ¸
    const item = extrusionPlanData.find(i => i.materialNum === draggedExtrusionEvent.materialNum);
    if (item && item.productionQuantity) {
        // ê¸°ì¡´ ë‚ ì§œì—ì„œ ìˆ˜ëŸ‰ ì œê±°
        const oldDate = draggedExtrusionEvent.date;
        if (item.productionQuantity[oldDate]) {
            item.productionQuantity[oldDate][draggedExtrusionEvent.shift] = 0;
        }
        
        // ìƒˆ ë‚ ì§œì— ìˆ˜ëŸ‰ ì¶”ê°€
        if (!item.productionQuantity[newPlanDate]) {
            item.productionQuantity[newPlanDate] = { day: 0, night: 0 };
        }
        item.productionQuantity[newPlanDate][draggedExtrusionEvent.shift] = draggedExtrusionEvent.quantity;
        
        // filteredExtrusionPlanDataë„ ì—…ë°ì´íŠ¸
        const filteredItem = filteredExtrusionPlanData.find(i => i.materialNum === draggedExtrusionEvent.materialNum);
        if (filteredItem && filteredItem.productionQuantity) {
            if (filteredItem.productionQuantity[oldDate]) {
                filteredItem.productionQuantity[oldDate][draggedExtrusionEvent.shift] = 0;
            }
            if (!filteredItem.productionQuantity[newPlanDate]) {
                filteredItem.productionQuantity[newPlanDate] = { day: 0, night: 0 };
            }
            filteredItem.productionQuantity[newPlanDate][draggedExtrusionEvent.shift] = draggedExtrusionEvent.quantity;
        }
        
        // í…Œì´ë¸”ê³¼ ìº˜ë¦°ë” ë‹¤ì‹œ ë Œë”ë§
        renderExtrusionPlanTable();
        renderExtrusionCalendar();
    }
    
    draggedExtrusionEvent = null;
    return false;
}

// ìº˜ë¦°ë” ì´ë²¤íŠ¸ ìˆ˜ëŸ‰ í¸ì§‘
function editExtrusionCalendarQuantity(eventEl) {
    const materialNum = eventEl.dataset.materialNum;
    const date = eventEl.dataset.date;
    const shift = eventEl.dataset.shift;
    const currentQuantity = parseInt(eventEl.dataset.quantity) || 0;
    
    const newQuantity = prompt('ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”:', currentQuantity.toLocaleString());
    if (newQuantity === null) return;
    
    const quantity = parseInt(newQuantity.replace(/,/g, '')) || 0;
    
    // ìƒì‚°ê³„íš ë°ì´í„° ì—…ë°ì´íŠ¸
    updateExtrusionQuantity(materialNum, date, shift, quantity.toString());
    
    // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
    renderExtrusionPlanTable();
    renderExtrusionPlanProductionTable();
}

// ì••ì¶œ ìº˜ë¦°ë” ë„¤ë¹„ê²Œì´ì…˜
document.addEventListener('DOMContentLoaded', function() {
    const prevBtn = document.getElementById('extrusion-prev-month');
    const nextBtn = document.getElementById('extrusion-next-month');
    
    if (prevBtn) {
        prevBtn.addEventListener('click', () => {
            currentExtrusionCalendarDate.setMonth(currentExtrusionCalendarDate.getMonth() - 1);
            renderExtrusionCalendar();
        });
    }
    
    if (nextBtn) {
        nextBtn.addEventListener('click', () => {
            currentExtrusionCalendarDate.setMonth(currentExtrusionCalendarDate.getMonth() + 1);
            renderExtrusionCalendar();
        });
    }
});

    </script>
    
    <!-- ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„° í¬í•¨ -->
    <script>
    // ì™¸ë¶€ íŒŒì¼ ë‚´ìš©ì„ ì§ì ‘ í¬í•¨
    let extrusionPlanDataFromFile = [{"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003697", "materialDetail": "SX2 B/SIDE FRT RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 1500, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003698", "materialDetail": "SX2 B/SIDE RR RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 1500, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "", "materialNum": "46003964", "materialDetail": "LX3 G/RUN FRT B (ì‚¬ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 7200, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "RG3", "materialNum": "46003265", "materialDetail": "RG3 B/SIDE FRT", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 2800, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "DL3", "materialNum": "46003245", "materialDetail": "DL3 B/SIDE FRT LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 1800, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003092", "materialDetail": "DN8 G/RUN RR C", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 6000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003093", "materialDetail": "DN8 G/RUN RR F", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 6000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "SX2", "materialNum": "46003705", "materialDetail": "SX2 D/SIDE FRT A ì‚¬ë¦¼ (ë™ì„œ)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 5000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "SX2", "materialNum": "46003706", "materialDetail": "SX2 D/SIDE RR A ì‚¬ë¦¼ (ì‚¼ì§„)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 5000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "NEA", "materialNum": "46003767", "materialDetail": "NEa G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 2000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "NEA", "materialNum": "46003769", "materialDetail": "NEa G/RUN RR B-1", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 2000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "NEA", "materialNum": "46003770", "materialDetail": "NEa G/RUN RR B-2", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 2000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "SW", "materialNum": "46003788", "materialDetail": "SW1 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 5000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#10", "vehicleType": "HR", "materialNum": "46002227", "materialDetail": "HR CHNL A-1", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 9000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#10", "vehicleType": "HR", "materialNum": "46002228", "materialDetail": "HR CHNL A-2", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 4000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#10", "vehicleType": "SG2", "materialNum": "46003550", "materialDetail": "SG2 G/RUN RR D", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 5000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "LX3", "materialNum": "46003723", "materialDetail": "LX3 G/RUN FRT A-1", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 10000, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "YB", "materialNum": "46002616", "materialDetail": "YB G/RUN FRT/RR B", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 4800}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "LX3", "materialNum": "46003810", "materialDetail": "TK1/LX3 FRT/RR LWR CHNL ì‚¬ë¦¼", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 6000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#02", "vehicleType": "SX2", "materialNum": "46003566", "materialDetail": "SX2 D/SIDE FRT B ì‚¬ë¦¼ (ë™ì„œ)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 8000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#02", "vehicleType": "SX2", "materialNum": "46003624", "materialDetail": "SX2 D/SIDE RR B ì‚¬ë¦¼ (ì‚¼ì§„)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 8000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003569", "materialDetail": "SX2 B/SIDE FRT LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 1500}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003570", "materialDetail": "SX2 B/SIDE RR LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 1500}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "LX3", "materialNum": "46003729", "materialDetail": "LX3 G/RUN RR C-2", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 12000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "", "materialNum": "46003965", "materialDetail": "LX3 G/RUN RR C-1 (ì‚¬ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 5000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "RG3", "materialNum": "46003266", "materialDetail": "RG3 B/SIDE RR", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 2800}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "DL3", "materialNum": "46003245", "materialDetail": "DL3 B/SIDE FRT LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 1800}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "DL3", "materialNum": "46003257", "materialDetail": "DL3 B/SIDE FRT RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 1200}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003090", "materialDetail": "DN8 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 5000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003091", "materialDetail": "DN8 G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 3000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "NQ5", "materialNum": "46003955", "materialDetail": "NQ5 G/RUN FRT/RR B (ì‚¬ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 2000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "SX2", "materialNum": "46003706", "materialDetail": "SX2 D/SIDE RR A ì‚¬ë¦¼ (ì‚¼ì§„)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 4000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "DL3", "materialNum": "46003711", "materialDetail": "DL3 PE D/SIDE RR F", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 8000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "DL3", "materialNum": "46003243", "materialDetail": "DL3 D/SIDE C/SEAL(PE ê³µìš©)", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 8000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "DL3", "materialNum": "46003244", "materialDetail": "DL3 D/SIDE P/SEAL(PE ê³µìš©)", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 8000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "GL3", "materialNum": "46003398", "materialDetail": "GL3 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 3000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "NQ5", "materialNum": "46003481", "materialDetail": "NQ5 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 1350}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "LX3", "materialNum": "46003725", "materialDetail": "LX3 G/RUN RR A-3", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 7000}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "JD", "materialNum": "46002134", "materialDetail": "CN7/JD/GDe/GD/TL/YP FR CHNL", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 5000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "NQ5", "materialNum": "46003840", "materialDetail": "NQ5 FRT LWR CHNL", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 20000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003697", "materialDetail": "SX2 B/SIDE FRT RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 1500, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003698", "materialDetail": "SX2 B/SIDE RR RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 1500, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003735", "materialDetail": "LX3 B/SIDE RR LH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 1500, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003736", "materialDetail": "LX3 B/SIDE RR RH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 1500, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "DL3", "materialNum": "46003257", "materialDetail": "DL3 B/SIDE FRT RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 2400, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "DL3", "materialNum": "46003258", "materialDetail": "DL3 B/SIDE RR RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 600, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "NQ5", "materialNum": "46003955", "materialDetail": "NQ5 G/RUN FRT/RR B (ì‚¬ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 6000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "DL3", "materialNum": "46003710", "materialDetail": "DL3 PE D/SIDE FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 8000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "X10", "materialNum": "46002131", "materialDetail": "X100 G/RUN FRT/RR B", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 3000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "SW", "materialNum": "46003789", "materialDetail": "SW1 G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 5000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "NQ5", "materialNum": "46003481", "materialDetail": "NQ5 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 4050, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "NQ5", "materialNum": "46003483", "materialDetail": "NQ5 G/RUN RR A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 5400, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "ETC", "workplace": "ì••ì¶œ#11", "vehicleType": "SG2", "materialNum": "46003776", "materialDetail": "SG2 G/RUN FRT B ì‚¬ë¦¼ (ì‚¼ì§„)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 3000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "MX5", "materialNum": "46003592", "materialDetail": "MX5 G/RUN RR A-1", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 3000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "LX3", "materialNum": "46003725", "materialDetail": "LX3 G/RUN RR A-3", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 5000, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#02", "vehicleType": "SX2", "materialNum": "46003566", "materialDetail": "SX2 D/SIDE FRT B ì‚¬ë¦¼ (ë™ì„œ)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 8000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#02", "vehicleType": "SX2", "materialNum": "46003624", "materialDetail": "SX2 D/SIDE RR B ì‚¬ë¦¼ (ì‚¼ì§„)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 8000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003569", "materialDetail": "SX2 B/SIDE FRT LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 1000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003570", "materialDetail": "SX2 B/SIDE RR LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 2000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001215", "materialDetail": "TAM DRIP/SEAL RH A-1", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 1000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001216", "materialDetail": "TAM DRIP/SEAL RH A-2", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 1000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001217", "materialDetail": "TAM DRIP/SEAL RH A-3", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 1000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001222", "materialDetail": "TAM PART'G/SEAL RR RH A-1", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 1000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001223", "materialDetail": "TAM PART'G/SEAL RR RH A-2", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 1000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "SX2", "materialNum": "46003568", "materialDetail": "SX2 C/SEAL D", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 14000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003733", "materialDetail": "LX3 B/SIDE FRT LH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 1000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003734", "materialDetail": "LX3 B/SIDE FRT RH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 2000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "DL3", "materialNum": "46003258", "materialDetail": "DL3 B/SIDE RR RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 3000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003094", "materialDetail": "DN8 G/RUN RR D", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 6000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DL3", "materialNum": "46003236", "materialDetail": "DL3 G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 4000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DL3", "materialNum": "46003238", "materialDetail": "DL3 G/RUN RR C", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 6000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DL3", "materialNum": "46003239", "materialDetail": "DL3 G/RUN RR D", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 6000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "LX3", "materialNum": "46003731", "materialDetail": "LX3 G/RUN RR F", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 12000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "LX3", "materialNum": "46003732", "materialDetail": "LX3 G/RUN RR G", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 10000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "NEA", "materialNum": "46003765", "materialDetail": "NEa G/RUN FRT E", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 2000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "NEA", "materialNum": "46003771", "materialDetail": "NEa G/RUN RR D", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 2000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "LX3", "materialNum": "46003963", "materialDetail": "LX3 G/RUN FRT E (ì‚¬ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 7200}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "SG2", "materialNum": "46003585", "materialDetail": "SG2 G/RUN FRT E ì‚¬ë¦¼", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 3600}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "ETC", "workplace": "ì••ì¶œ#11", "vehicleType": "SG2", "materialNum": "46003777", "materialDetail": "SG2 G/RUN RR B ì‚¬ë¦¼ (ëŒ€ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 3000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "MX5", "materialNum": "46003587", "materialDetail": "MX5 G/RUN FRT A-1", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 4000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "MX5", "materialNum": "46003592", "materialDetail": "MX5 G/RUN RR A-1", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 5000}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "YB", "materialNum": "46002848", "materialDetail": "YB CUV G/RUN RR D", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 2400, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "CN7", "materialNum": "46003281", "materialDetail": "CN7/NX4e RR LWR CHNL(ì‚¬ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 6000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003697", "materialDetail": "SX2 B/SIDE FRT RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 1500, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003698", "materialDetail": "SX2 B/SIDE RR RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 1500, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001213", "materialDetail": "TAM B/SIDE FRT RH", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 4800, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001225", "materialDetail": "TAM D/SEAL RR RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 2000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "MX5", "materialNum": "46003712", "materialDetail": "MX5 G/RUN FRT E", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 5000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "MX5", "materialNum": "46003713", "materialDetail": "MX5 G/RUN RR E", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 5000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003735", "materialDetail": "LX3 B/SIDE RR LH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 1500, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003736", "materialDetail": "LX3 B/SIDE RR RH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 1500, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "DL3", "materialNum": "46003246", "materialDetail": "DL3 B/SIDE RR LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 3600, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DL3", "materialNum": "46003235", "materialDetail": "DL3 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 2000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "ETC", "workplace": "ì••ì¶œ#07", "vehicleType": "CN7", "materialNum": "46003763", "materialDetail": "CN7 G/RUN RR C ì‚¬ë¦¼", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 8000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "RG3", "materialNum": "46003267", "materialDetail": "RG3 D/SIDE FRT RR A", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 14000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "LX3", "materialNum": "46003730", "materialDetail": "LX3 G/RUN RR D", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 12000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#09", "vehicleType": "CM", "materialNum": "46000633", "materialDetail": "CM G/RUN FR B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 200, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#09", "vehicleType": "QL", "materialNum": "46002309", "materialDetail": "QL G/RUN FRT E", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 500, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#10", "vehicleType": "DN8", "materialNum": "46003089", "materialDetail": "DN8 G/RUN FRT E", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 5000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#10", "vehicleType": "DL3", "materialNum": "46003234", "materialDetail": "DL3 G/RUN FRT E", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 4000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#10", "vehicleType": "NQ5", "materialNum": "46003480", "materialDetail": "NQ5 G/RUN FRT E", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 5000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "ETC", "workplace": "ì••ì¶œ#11", "vehicleType": "CN7", "materialNum": "46003581", "materialDetail": "CN7 G/RUN FRT/RR A ì‚¬ë¦¼", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 7000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "MX5", "materialNum": "46003588", "materialDetail": "MX5 G/RUN FRT A-2", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 7000, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "SK3", "materialNum": "46003073", "materialDetail": "SP2 G/RUN FRT/RR B (ëŒ€ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 3000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "SG2", "materialNum": "46003551", "materialDetail": "SG2 LWR CHNL RR", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 6000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#02", "vehicleType": "SX2", "materialNum": "46003566", "materialDetail": "SX2 D/SIDE FRT B ì‚¬ë¦¼ (ë™ì„œ)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 8000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#02", "vehicleType": "SX2", "materialNum": "46003624", "materialDetail": "SX2 D/SIDE RR B ì‚¬ë¦¼ (ì‚¼ì§„)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 8000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003569", "materialDetail": "SX2 B/SIDE FRT LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 1500}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003570", "materialDetail": "SX2 B/SIDE RR LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 1500}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001213", "materialDetail": "TAM B/SIDE FRT RH", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 4800}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001228", "materialDetail": "TAM L/SEAL FR RH A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 2000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "TAM", "materialNum": "46001229", "materialDetail": "TAM L/SEAL RR RH A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 2000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003733", "materialDetail": "LX3 B/SIDE FRT LH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 2000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003734", "materialDetail": "LX3 B/SIDE FRT RH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 1000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003091", "materialDetail": "DN8 G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 1500}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DL3", "materialNum": "46003235", "materialDetail": "DL3 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 5000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DL3", "materialNum": "46003237", "materialDetail": "DL3 G/RUN RR F", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 6000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "DL3", "materialNum": "46003241", "materialDetail": "DL3 D/SIDE FRT/RR B(PE ê³µìš©)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 14000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "ETC", "workplace": "ì••ì¶œ#11", "vehicleType": "CN7", "materialNum": "46003581", "materialDetail": "CN7 G/RUN FRT/RR A ì‚¬ë¦¼", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 10000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "SK3", "materialNum": "46003072", "materialDetail": "SP2 G/RUN FRT/RR A (ëŒ€ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 5000}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#12", "vehicleType": "QL", "materialNum": "46002307", "materialDetail": "QL G/RUN FRT A", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 500}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#12", "vehicleType": "IG", "materialNum": "46003208", "materialDetail": "IG PE G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 300}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "PU", "materialNum": "46002953", "materialDetail": "PU G/RUN FR A (EPDM)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 3000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "SK3", "materialNum": "46003073", "materialDetail": "SP2 G/RUN FRT/RR B (ëŒ€ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 7000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003697", "materialDetail": "SX2 B/SIDE FRT RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1500, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#03", "vehicleType": "SX2", "materialNum": "46003698", "materialDetail": "SX2 B/SIDE RR RH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1500, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "MX5", "materialNum": "46003589", "materialDetail": "MX5 G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 5000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "MX5", "materialNum": "46003590", "materialDetail": "MX5 G/RUN RR B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 5000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003735", "materialDetail": "LX3 B/SIDE RR LH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1500, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "LX3", "materialNum": "46003736", "materialDetail": "LX3 B/SIDE RR RH ë‹¨ë©´", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1500, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "TAM", "materialNum": "46001211", "materialDetail": "TAM B/SIDE FRT LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1200, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#06", "vehicleType": "TAM", "materialNum": "46001212", "materialDetail": "TAM B/SIDE RR LH", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1200, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "EU", "materialNum": "46001708", "materialDetail": "EU G/RUN E", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003090", "materialDetail": "DN8 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 5000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003091", "materialDetail": "DN8 G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1500, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#07", "vehicleType": "UB", "materialNum": "46001455", "materialDetail": "UB G/R FRT A/FRT 3DR A", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 100, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "DL3", "materialNum": "46003241", "materialDetail": "DL3 D/SIDE FRT/RR B(PE ê³µìš©)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 14000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "EU", "materialNum": "46001705", "materialDetail": "EU G/RUN B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "EU", "materialNum": "46001710", "materialDetail": "EU G/RUN F-2", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 1000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "YB", "materialNum": "46002617", "materialDetail": "YB G/RUN FRT E", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 2000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#10", "vehicleType": "SP2", "materialNum": "46003139", "materialDetail": "SP2 RR LWR CHNL", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 10000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "CN7", "materialNum": "46003582", "materialDetail": "CN7 G/RUN FRT E ì‚¬ë¦¼", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 5000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "ETC", "workplace": "ì••ì¶œ#11", "vehicleType": "CN7", "materialNum": "46003581", "materialDetail": "CN7 G/RUN FRT/RR A ì‚¬ë¦¼", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 5000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "SK3", "materialNum": "46003072", "materialDetail": "SP2 G/RUN FRT/RR A (ëŒ€ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 8000, "night": 0}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "YB", "materialNum": "46002615", "materialDetail": "YB G/RUN FRT/RR A", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 6000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#01", "vehicleType": "YB", "materialNum": "46002616", "materialDetail": "YB G/RUN FRT/RR B", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 4800}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#02", "vehicleType": "SX2", "materialNum": "46003566", "materialDetail": "SX2 D/SIDE FRT B ì‚¬ë¦¼ (ë™ì„œ)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 11000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#02", "vehicleType": "SX2", "materialNum": "46003624", "materialDetail": "SX2 D/SIDE RR B ì‚¬ë¦¼ (ì‚¼ì§„)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 11000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "SW", "materialNum": "46003790", "materialDetail": "SW1 G/RUN FRT C", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 5000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "SW", "materialNum": "46003791", "materialDetail": "SW1 G/RUN FRT E", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 2400}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "", "materialNum": "46003965", "materialDetail": "LX3 G/RUN RR C-1 (ì‚¬ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 6000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#05", "vehicleType": "RG3", "materialNum": "46003266", "materialDetail": "RG3 B/SIDE RR", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 1600}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#05", "vehicleType": "DH", "materialNum": "46001632", "materialDetail": "DH B/SIDE RR", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 400}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#05", "vehicleType": "IG", "materialNum": "46003204", "materialDetail": "IG PE B/SIDE FRT", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 400}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#05", "vehicleType": "IG", "materialNum": "46003205", "materialDetail": "IG PE B/SIDE RR", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 400}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#06", "vehicleType": "HM", "materialNum": "46000826", "materialDetail": "HM B/SIDE FRT(9P)", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 400}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#06", "vehicleType": "HM", "materialNum": "46000827", "materialDetail": "HM B/SIDE RR (9P)", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 400}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#06", "vehicleType": "CM", "materialNum": "46000879", "materialDetail": "CM B/SIDE FRT(ì— ë³´)", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 200}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#06", "vehicleType": "DM", "materialNum": "46001403", "materialDetail": "DM B/SIDE FRT", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 400}, "12/5": {"day": 0, "night": 0}}}, {"category": "AS", "workplace": "ì••ì¶œ#06", "vehicleType": "DM", "materialNum": "46001404", "materialDetail": "DM B/SIDE RR", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 400}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003092", "materialDetail": "DN8 G/RUN RR C", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 6000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DN8", "materialNum": "46003093", "materialDetail": "DN8 G/RUN RR F", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 6000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DL3", "materialNum": "46003236", "materialDetail": "DL3 G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 2000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "J10", "materialNum": "46003598", "materialDetail": "J100 HOOD SEAL FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 4000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "SX2", "materialNum": "46003705", "materialDetail": "SX2 D/SIDE FRT A ì‚¬ë¦¼ (ë™ì„œ)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 2000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "SX2", "materialNum": "46003706", "materialDetail": "SX2 D/SIDE RR A ì‚¬ë¦¼ (ì‚¼ì§„)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 7200}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "TK1", "materialNum": "46003746", "materialDetail": "TK1 G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 2000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "TK1", "materialNum": "46003749", "materialDetail": "TK1 G/RUN RR A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 2000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "NEA", "materialNum": "46003766", "materialDetail": "NEa G/RUN FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 4000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "DL3", "materialNum": "46003243", "materialDetail": "DL3 D/SIDE C/SEAL(PE ê³µìš©)", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 8000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "DL3", "materialNum": "46003244", "materialDetail": "DL3 D/SIDE P/SEAL(PE ê³µìš©)", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 8000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "RG3", "materialNum": "46003269", "materialDetail": "RG3 L/SEAL RR A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 4000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#11", "vehicleType": "RG3", "materialNum": "46003270", "materialDetail": "RG3 P/SEAL FRT A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 4000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#12", "vehicleType": "SP2", "materialNum": "46003137", "materialDetail": "SP2 G/RUN RR D", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 2000}, "12/5": {"day": 0, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#04", "vehicleType": "", "materialNum": "46003965", "materialDetail": "LX3 G/RUN RR C-1 (ì‚¬ë¦¼)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 3000, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#07", "vehicleType": "DL3", "materialNum": "46003236", "materialDetail": "DL3 G/RUN FRT B", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 2000, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#08", "vehicleType": "SX2", "materialNum": "46003705", "materialDetail": "SX2 D/SIDE FRT A ì‚¬ë¦¼ (ë™ì„œ)", "unit": "M", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 2000, "night": 0}}}, {"category": "OEM", "workplace": "ì••ì¶œ#09", "vehicleType": "NEA", "materialNum": "46003768", "materialDetail": "NEa G/RUN RR A", "unit": "ST", "itemNum": "", "companyName": "", "productionQuantity": {"12/1": {"day": 0, "night": 0}, "12/2": {"day": 0, "night": 0}, "12/3": {"day": 0, "night": 0}, "12/4": {"day": 0, "night": 0}, "12/5": {"day": 3000, "night": 0}}}];
    try {
        // ì™¸ë¶€ íŒŒì¼ì´ ìˆìœ¼ë©´ ë¡œë“œ ì‹œë„, ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ ì‚¬ìš©
        if (typeof window !== 'undefined' && window.location) {
            // ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œëŠ” ì™¸ë¶€ íŒŒì¼ ë¡œë“œ ì‹œë„í•˜ì§€ ì•ŠìŒ (ì´ë¯¸ ì¸ë¼ì¸ìœ¼ë¡œ í¬í•¨ë¨)
            // ë°ì´í„°ëŠ” ì•„ë˜ embedded ë³€ìˆ˜ì—ì„œ ë¡œë“œë¨
        }
    } catch(e) {
        console.warn('ì™¸ë¶€ ë°ì´í„° íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:', e);
    }
    </script>
    <script>
    // embedded ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë„ë¡ loadExtrusionPlanData í•¨ìˆ˜ ì˜¤ë²„ë¼ì´ë“œ
    const originalLoadExtrusionPlanData = loadExtrusionPlanData;
    loadExtrusionPlanData = async function() {
        // ë¨¼ì € embedded ë°ì´í„° í™•ì¸
        if (typeof extrusionPlanDataFromFile !== 'undefined' && Array.isArray(extrusionPlanDataFromFile)) {
            extrusionPlanData = extrusionPlanDataFromFile;
            filteredExtrusionPlanData = extrusionPlanData; // ì´ˆê¸° í•„í„°ë§
            console.log(`ì••ì¶œ ìƒì‚°ê³„íš ë°ì´í„° ë¡œë“œ ì™„ë£Œ (embedded): ${extrusionPlanData.length}ê°œ í–‰`);
            return;
        }
        
        // embedded ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì›ë˜ í•¨ìˆ˜ ì‹¤í–‰
        await originalLoadExtrusionPlanData();
    };
    
    // Embedded ë°ì´í„° ë³€ìˆ˜ë“¤ (ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ íŒŒì¼ì„ ë³´ë‚¼ ë•Œ ì´ ë°ì´í„°ë“¤ì´ í¬í•¨ë¨)
    // localStorageê°€ ë¹„ì–´ìˆì„ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
    // í˜„ì¬ localStorageì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ì´ ë³€ìˆ˜ë“¤ì— ë³µì‚¬í•˜ì—¬ í¬í•¨ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    // ì£¼ê°„ ìƒì‚°ê³„íš ë°ì´í„° (embedded)
    // ì‚¬ìš©ë²•: ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í˜„ì¬ ë°ì´í„°ë¥¼ ë³µì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
    // copy(JSON.stringify(currentWeekData))
    // ê·¸ í›„ ì•„ë˜ ë³€ìˆ˜ì— ë¶™ì—¬ë„£ê¸°
    const embeddedProductionData = JSON.parse(JSON.stringify(initialProductionData));
    
    // ì¤‘ì‹ëŒ€ì‘ ë°ì´í„° (embedded)
    // ì‚¬ìš©ë²•: ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í˜„ì¬ ë°ì´í„°ë¥¼ ë³µì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
    // copy(JSON.stringify(extrusionLunchBreakData))
    const embeddedExtrusionLunchBreakData = {};
    
    // ê°œë°œ ë°ì´í„° (embedded)
    // ì‚¬ìš©ë²•: ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í˜„ì¬ ë°ì´í„°ë¥¼ ë³µì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
    // copy(JSON.stringify(extrusionDevData))
    const embeddedExtrusionDevData = {};
    
    // ì´ë¯¸ì§€ ë°ì´í„° (embedded)
    // HTML íŒŒì¼ ë‚´ë¶€ì— ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ì—¬ íŒŒì¼ì„ ì˜®ê²¨ë„ ì´ë¯¸ì§€ê°€ ìœ ì§€ë©ë‹ˆë‹¤.
    // ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ë¯€ë¡œ ìˆ˜ë™ ìˆ˜ì •ì´ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
    let embeddedDevImages = {};
    
    // HTML íŒŒì¼ ë‚´ë¶€ì˜ embedded ì´ë¯¸ì§€ ë°ì´í„° ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateEmbeddedImagesInHTML() {
        // embedded ë³€ìˆ˜ ì—…ë°ì´íŠ¸ (ë©”ëª¨ë¦¬ìƒì—ì„œë§Œ)
        // ì‹¤ì œ HTML íŒŒì¼ ì €ì¥ì€ ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ í•´ì•¼ í•¨
        if (typeof embeddedDevImages === 'undefined') {
            embeddedDevImages = {};
        }
        
        // localStorageì˜ ìµœì‹  ë°ì´í„°ë¥¼ embedded ë³€ìˆ˜ì— ë™ê¸°í™”
        const images = JSON.parse(localStorage.getItem('devImages') || '{}');
        if (Object.keys(images).length > 0) {
            embeddedDevImages = images;
        }
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ localStorage ë°ì´í„°ë¥¼ embedded ë³€ìˆ˜ì— ë™ê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
        const images = JSON.parse(localStorage.getItem('devImages') || '{}');
        if (Object.keys(images).length > 0) {
            embeddedDevImages = images;
        }
    });
    
    // ì´ë¯¸ì§€ ë°ì´í„° ë³€ê²½ ì¶”ì 
    window.imageDataChanged = false;
    
    // ì›ë³¸ HTML ë‚´ìš© ì €ì¥ (í˜ì´ì§€ ë¡œë“œ ì‹œ)
    window.originalHTMLContent = null;
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì›ë³¸ HTML ì €ì¥ ì‹œë„
    (function() {
        // DOMContentLoadedì—ì„œ ì‹œë„
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadOriginalHTML);
        } else {
            loadOriginalHTML();
        }
        
        function loadOriginalHTML() {
            try {
                const xhr = new XMLHttpRequest();
                xhr.open('GET', window.location.href, true);
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4 && (xhr.status === 0 || xhr.status === 200)) {
                        const content = xhr.responseText;
                        if (content && content.trim().length > 0 && content.includes('<!DOCTYPE')) {
                            window.originalHTMLContent = content;
                        }
                    }
                };
                xhr.onerror = function() {
                    // ì˜¤ë¥˜ ë¬´ì‹œ
                };
                xhr.send(null);
            } catch (e) {
                // ì˜¤ë¥˜ ë¬´ì‹œ
            }
        }
    })();
    
    // íŒŒì¼ ê³µìœ ë¥¼ ìœ„í•œ ë°ì´í„° ë‚´ë³´ë‚´ê¸° í•¨ìˆ˜
    // ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ exportDataForSharing() ì‹¤í–‰ ì‹œ í˜„ì¬ localStorage ë°ì´í„°ë¥¼ embedded ë³€ìˆ˜ì— ë³µì‚¬
    window.exportDataForSharing = function() {
        // í˜„ì¬ localStorage ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const currentProdData = localStorage.getItem('productionData');
        const currentLunchData = localStorage.getItem('extrusionLunchBreakData');
        const currentDevData = localStorage.getItem('extrusionDevData');
        const currentImages = localStorage.getItem('devImages');
        
        // embedded ë³€ìˆ˜ì— ë³µì‚¬ (ì‹¤ì œë¡œëŠ” HTML íŒŒì¼ì„ ìˆ˜ì •í•´ì•¼ í•˜ì§€ë§Œ, ì½˜ì†”ì— ì¶œë ¥)
        console.log('=== íŒŒì¼ ê³µìœ ë¥¼ ìœ„í•œ ë°ì´í„° (ì•„ë˜ ë‚´ìš©ì„ HTML íŒŒì¼ì˜ embedded ë³€ìˆ˜ì— ë³µì‚¬í•˜ì„¸ìš”) ===');
        console.log('\n// ì£¼ê°„ ìƒì‚°ê³„íš ë°ì´í„°');
        console.log('const embeddedProductionData = ' + (currentProdData || JSON.stringify(initialProductionData)) + ';');
        console.log('\n// ì¤‘ì‹ëŒ€ì‘ ë°ì´í„°');
        console.log('const embeddedExtrusionLunchBreakData = ' + (currentLunchData || '{}') + ';');
        console.log('\n// ê°œë°œ ë°ì´í„°');
        console.log('const embeddedExtrusionDevData = ' + (currentDevData || '{}') + ';');
        console.log('\n// ì´ë¯¸ì§€ ë°ì´í„°');
        console.log('let embeddedDevImages = ' + (currentImages || '{}') + ';');
        console.log('\n=== ìœ„ ë‚´ìš©ì„ HTML íŒŒì¼ì˜ embedded ë³€ìˆ˜ ì„ ì–¸ ë¶€ë¶„ì— ë³µì‚¬í•˜ì„¸ìš” ===');
        
        // í´ë¦½ë³´ë“œì— ë³µì‚¬í•  ìˆ˜ ìˆë„ë¡
        const exportText = `// ì£¼ê°„ ìƒì‚°ê³„íš ë°ì´í„°\nconst embeddedProductionData = ${currentProdData || JSON.stringify(initialProductionData)};\n\n// ì¤‘ì‹ëŒ€ì‘ ë°ì´í„°\nconst embeddedExtrusionLunchBreakData = ${currentLunchData || '{}'};\n\n// ê°œë°œ ë°ì´í„°\nconst embeddedExtrusionDevData = ${currentDevData || '{}'};\n\n// ì´ë¯¸ì§€ ë°ì´í„°\nlet embeddedDevImages = ${currentImages || '{}'};`;
        
        // í´ë¦½ë³´ë“œì— ë³µì‚¬ ì‹œë„
        if (navigator.clipboard) {
            navigator.clipboard.writeText(exportText).then(() => {
                alert('ë°ì´í„°ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nHTML íŒŒì¼ì˜ embedded ë³€ìˆ˜ ì„ ì–¸ ë¶€ë¶„ì„ ì°¾ì•„ì„œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.');
            }).catch(() => {
                alert('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨. ì½˜ì†”ì— ì¶œë ¥ëœ ë‚´ìš©ì„ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•˜ì„¸ìš”.');
            });
        } else {
            alert('ì½˜ì†”ì— ì¶œë ¥ëœ ë‚´ìš©ì„ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•˜ì„¸ìš”.');
        }
    };
    
    // HTML íŒŒì¼ì— ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ í¬í•¨ì‹œí‚¤ëŠ” í•¨ìˆ˜
    // ì´ë¯¸ì§€ë¥¼ ì €ì¥í•  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ í˜¸ì¶œë¨
    // silent: trueì¼ ê²½ìš° ì•Œë¦¼ ì—†ì´ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ
    window.saveHTMLWithImages = function(silent = false) {
        // embeddedDevImages ë³€ìˆ˜ì—ì„œ ì§ì ‘ ì´ë¯¸ì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        // ë§Œì•½ embeddedDevImagesê°€ ë¹„ì–´ìˆìœ¼ë©´ localStorageì—ì„œ ê°€ì ¸ì˜¤ê¸°
        let imageData = {};
        if (typeof embeddedDevImages !== 'undefined' && embeddedDevImages && Object.keys(embeddedDevImages).length > 0) {
            imageData = embeddedDevImages;
        } else {
            // embeddedDevImagesê°€ ì—†ìœ¼ë©´ localStorageì—ì„œ ê°€ì ¸ì˜¤ê¸°
            const storedImages = JSON.parse(localStorage.getItem('devImages') || '{}');
            imageData = storedImages;
        }
        
        // JSON ë¬¸ìì—´ë¡œ ë³€í™˜
        const currentImages = JSON.stringify(imageData);
        // JSON ë¬¸ìì—´ì„ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë¬¸ìì—´ ì—°ê²° ì‚¬ìš©
        const imageDataText = 'let embeddedDevImages = ' + currentImages + ';';
        
        // HTML íŒŒì¼ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°
        // ë¡œì»¬ íŒŒì¼ì˜ ê²½ìš° fetchê°€ ì‘ë™í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ í˜„ì¬ í˜ì´ì§€ì˜ HTMLì„ ì§ì ‘ ê°€ì ¸ì˜´
        let htmlContent = '';
        
        // ì›ë³¸ HTML íŒŒì¼ì„ ì½ìœ¼ë ¤ê³  ì‹œë„
        const tryFetch = () => {
            // ë¨¼ì € ì €ì¥ëœ ì›ë³¸ HTML ì‚¬ìš©
            if (window.originalHTMLContent && window.originalHTMLContent.trim().length > 0 && window.originalHTMLContent.includes('<!DOCTYPE')) {
                htmlContent = window.originalHTMLContent;
                processHTMLContent();
                return;
            }
            
            // ì €ì¥ëœ ì›ë³¸ì´ ì—†ìœ¼ë©´ XMLHttpRequest ì‹œë„
            const xhr = new XMLHttpRequest();
            xhr.open('GET', window.location.href, true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 0 || xhr.status === 200) {
                        // ì„±ê³µì ìœ¼ë¡œ ì½ì€ ê²½ìš°
                        htmlContent = xhr.responseText;
                        // ì›ë³¸ HTML ì €ì¥
                        window.originalHTMLContent = htmlContent;
                        // HTMLì´ ë¹„ì–´ìˆì§€ ì•Šì€ì§€ í™•ì¸
                        if (htmlContent && htmlContent.trim().length > 0 && htmlContent.includes('<!DOCTYPE')) {
                            processHTMLContent();
                        } else {
                            // HTMLì´ ë¹„ì–´ìˆê±°ë‚˜ ì˜ëª»ëœ ê²½ìš° íŒŒì¼ ì„ íƒ ìš”ì²­
                            requestFileSelection();
                        }
                    } else {
                        // ì½ê¸° ì‹¤íŒ¨ ì‹œ íŒŒì¼ ì„ íƒ ìš”ì²­
                        requestFileSelection();
                    }
                }
            };
            xhr.onerror = function() {
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ íŒŒì¼ ì„ íƒ ìš”ì²­
                requestFileSelection();
            };
            try {
                xhr.send(null);
            } catch (e) {
                // CORS ì˜¤ë¥˜ ë“±ìœ¼ë¡œ ì‹¤íŒ¨í•œ ê²½ìš° íŒŒì¼ ì„ íƒ ìš”ì²­
                console.warn('XMLHttpRequest ì‹¤íŒ¨:', e);
                requestFileSelection();
            }
        };
        
        // íŒŒì¼ ì„ íƒì„ ìš”ì²­í•˜ëŠ” í•¨ìˆ˜
        const requestFileSelection = () => {
            // ë¨¼ì € í˜„ì¬ í˜ì´ì§€ì˜ HTMLì„ ì‚¬ìš©í•´ë³´ê¸°
            const currentHTML = document.documentElement.outerHTML;
            if (currentHTML && currentHTML.includes('<!DOCTYPE') && currentHTML.includes('<html')) {
                // í˜„ì¬ í˜ì´ì§€ HTMLì´ ìœ íš¨í•˜ë©´ ì‚¬ìš©
                htmlContent = currentHTML;
                // embeddedDevImages ë³€ìˆ˜ë§Œ êµì²´
                processHTMLContent();
                return;
            }
            
            // í˜„ì¬ í˜ì´ì§€ HTMLë„ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ íŒŒì¼ ì„ íƒ ìš”ì²­
            if (!silent) {
                if (confirm('ì›ë³¸ HTML íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nì›ë³¸ SCM.html íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\n\n(ì·¨ì†Œë¥¼ ëˆ„ë¥´ë©´ í˜„ì¬ í˜ì´ì§€ì˜ HTMLì„ ì‚¬ìš©í•©ë‹ˆë‹¤)')) {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = '.html';
                    input.onchange = function(e) {
                        const file = e.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                htmlContent = e.target.result;
                                processHTMLContent();
                            };
                            reader.onerror = function() {
                                alert('íŒŒì¼ ì½ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                            };
                            reader.readAsText(file);
                        }
                    };
                    input.click();
                } else {
                    // ì·¨ì†Œë¥¼ ëˆ„ë¥´ë©´ í˜„ì¬ í˜ì´ì§€ HTML ì‚¬ìš©
                    htmlContent = currentHTML;
                    processHTMLContent();
                }
            } else {
                // ìë™ ì €ì¥ ëª¨ë“œì—ì„œëŠ” í˜„ì¬ í˜ì´ì§€ HTML ì‚¬ìš©
                htmlContent = currentHTML;
                processHTMLContent();
            }
        };
        
        const processHTMLContent = () => {
            try {
                // HTML ë‚´ìš©ì´ ìœ íš¨í•œì§€ í™•ì¸
                if (!htmlContent || htmlContent.trim().length === 0) {
                    throw new Error('HTML ë‚´ìš©ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.');
                }
                
                // HTMLì´ <!DOCTYPEë¡œ ì‹œì‘í•˜ëŠ”ì§€ í™•ì¸
                if (!htmlContent.includes('<!DOCTYPE') && !htmlContent.includes('<html')) {
                    throw new Error('ìœ íš¨í•œ HTML íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.');
                }
                
                // embeddedDevImages ë³€ìˆ˜ ì°¾ê¸° ë° êµì²´
                // ì£¼ì„ì„ ê¸°ì¤€ìœ¼ë¡œ ì •í™•í•œ ìœ„ì¹˜ ì°¾ê¸°
                const commentIndex = htmlContent.indexOf('// ì´ë¯¸ì§€ ë°ì´í„° (embedded)');
                let replaced = false;
                
                if (commentIndex !== -1) {
                    // ì£¼ì„ ë‹¤ìŒ ì¤„ë¶€í„° ì°¾ê¸°
                    const afterComment = htmlContent.substring(commentIndex);
                    const lineEndIndex = afterComment.indexOf('\n');
                    if (lineEndIndex !== -1) {
                        const varStartIndex = commentIndex + lineEndIndex + 1;
                        // ë‹¤ìŒ ì¤„ì—ì„œ ë³€ìˆ˜ ì„ ì–¸ ì‹œì‘ ìœ„ì¹˜ ì°¾ê¸°
                        const varLineStart = htmlContent.substring(varStartIndex);
                        const varMatch = varLineStart.match(/^\s*(let|const|var)\s+embeddedDevImages\s*=/);
                        if (varMatch) {
                            // ë³€ìˆ˜ ì„ ì–¸ì´ ì‹œì‘ë˜ëŠ” ì •í™•í•œ ìœ„ì¹˜
                            const actualVarStart = varStartIndex + varMatch.index;
                            // ì„¸ë¯¸ì½œë¡ ì„ ì°¾ì•„ì„œ ë³€ìˆ˜ ì„ ì–¸ì˜ ë ì°¾ê¸°
                            // Base64 ë°ì´í„°ê°€ ë§¤ìš° í¬ë¯€ë¡œ ì •ê·œì‹ ëŒ€ì‹  ë¬¸ìì—´ ê²€ìƒ‰ ì‚¬ìš©
                            let semicolonIndex = htmlContent.indexOf(';', actualVarStart);
                            if (semicolonIndex !== -1) {
                                // ì„¸ë¯¸ì½œë¡  ë‹¤ìŒ ì¤„ë°”ê¿ˆê¹Œì§€ í¬í•¨
                                let varEndIndex = semicolonIndex + 1;
                                // ë‹¤ìŒ ì¤„ë°”ê¿ˆê¹Œì§€ í¬í•¨
                                const nextNewline = htmlContent.indexOf('\n', semicolonIndex);
                                if (nextNewline !== -1) {
                                    varEndIndex = nextNewline + 1;
                                }
                                
                                // ë³€ìˆ˜ êµì²´
                                htmlContent = htmlContent.substring(0, actualVarStart) + 
                                    '    ' + imageDataText + '\n' + 
                                    htmlContent.substring(varEndIndex);
                                replaced = true;
                            }
                        }
                    }
                }
                
                if (!replaced) {
                    // ë³€ìˆ˜ê°€ ì—†ìœ¼ë©´ ì¶”ê°€
                    if (commentIndex !== -1) {
                        const nextLine = htmlContent.indexOf('\n', commentIndex);
                        htmlContent = htmlContent.substring(0, nextLine + 1) + '    ' + imageDataText + '\n' + htmlContent.substring(nextLine + 1);
                    } else {
                        // ì£¼ì„ë„ ì—†ìœ¼ë©´ script íƒœê·¸ ëë‚˜ê¸° ì „ì— ì¶”ê°€
                        const scriptTagEnd = '<' + '/' + 'script' + '>';
                        const scriptEnd = htmlContent.lastIndexOf(scriptTagEnd);
                        if (scriptEnd !== -1) {
                            const beforeScript = htmlContent.substring(0, scriptEnd);
                            const afterScript = htmlContent.substring(scriptEnd);
                            const commentLine = '\n    // ì´ë¯¸ì§€ ë°ì´í„° (embedded)\n';
                            const varLine = '    ' + imageDataText + '\n';
                            htmlContent = beforeScript + commentLine + varLine + afterScript;
                        }
                    }
                }
                
                // ìˆ˜ì •ëœ HTML íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                try {
                    const blob = new Blob([htmlContent], { type: 'text/html' });
                    
                    // Blob í¬ê¸° í™•ì¸ (ì•½ 2GB ì œí•œ)
                    if (blob.size > 2 * 1024 * 1024 * 1024) {
                        throw new Error('HTML íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤ (2GB ì´ˆê³¼). ì¼ë¶€ ì´ë¯¸ì§€ë¥¼ ì œê±°í•´ì£¼ì„¸ìš”.');
                    }
                    
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'SCM.html';
                    document.body.appendChild(a);
                    a.click();
                    
                    // ì•½ê°„ì˜ ì§€ì—° í›„ ì •ë¦¬
                    setTimeout(() => {
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    }, 100);
                    
                    if (!silent) {
                        alert('ì´ë¯¸ì§€ ë°ì´í„°ê°€ í¬í•¨ëœ HTML íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\në‹¤ìš´ë¡œë“œëœ íŒŒì¼ë¡œ ê¸°ì¡´ íŒŒì¼ì„ êµì²´í•˜ì„¸ìš”.');
                    } else {
                        console.log('HTML íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ (ìë™ ì €ì¥ ëª¨ë“œ)');
                    }
                } catch (blobError) {
                    console.error('Blob ìƒì„± ë˜ëŠ” ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨:', blobError);
                    throw blobError;
                }
            } catch (error) {
                console.error('HTML íŒŒì¼ ì²˜ë¦¬ ì‹¤íŒ¨:', error);
                if (!silent) {
                    alert('HTML íŒŒì¼ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. exportDataForSharing() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•˜ì„¸ìš”.');
                }
            }
        };
        
        // HTML íŒŒì¼ ì½ê¸° ì‹œì‘
        tryFetch();
    };
    
    // í˜ì´ì§€ ì¢…ë£Œ ì‹œ DOMì—ì„œ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ì°¾ì•„ì„œ embeddedDevImagesì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
    function collectAllImagesFromDOM() {
        // embeddedDevImages ë³€ìˆ˜ ì´ˆê¸°í™”
        if (typeof embeddedDevImages === 'undefined') {
            embeddedDevImages = {};
        }
        
        // ëª¨ë“  file input ìš”ì†Œ ì°¾ê¸° (í† ê¸€ë¡œ ìˆ¨ê²¨ì§„ ê²ƒë„ í¬í•¨)
        const fileInputs = document.querySelectorAll('input[id^="file-as-is-"], input[id^="file-to-be-"]');
        
        const promises = [];
        
        fileInputs.forEach(fileInput => {
            const id = fileInput.id;
            let devId, type;
            
            if (id.startsWith('file-as-is-')) {
                devId = id.replace('file-as-is-', '');
                type = 'as-is';
            } else if (id.startsWith('file-to-be-')) {
                devId = id.replace('file-to-be-', '');
                type = 'to-be';
            } else {
                return;
            }
            
            // ë¶€ëª¨ ìš”ì†Œì—ì„œ img íƒœê·¸ ì°¾ê¸°
            const uploadArea = fileInput.parentElement;
            if (!uploadArea) return;
            
            const img = uploadArea.querySelector('img');
            if (!img || !img.src) return;
            
            // ì´ë¯¸ì§€ ì²˜ë¦¬ Promise
            let imagePromise = null;
            
            if (img.src.startsWith('data:image/')) {
                // ì´ë¯¸ Base64ì´ë©´ ê·¸ëŒ€ë¡œ ì €ì¥
                imagePromise = Promise.resolve(img.src);
            } else if (img.src.startsWith('blob:')) {
                // Blob URLì¸ ê²½ìš° Base64ë¡œ ë³€í™˜
                imagePromise = fetch(img.src)
                    .then(response => {
                        if (!response.ok) throw new Error('Fetch failed');
                        return response.blob();
                    })
                    .then(blob => {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onloadend = () => resolve(reader.result);
                            reader.onerror = reject;
                            reader.readAsDataURL(blob);
                        });
                    })
                    .catch(err => {
                        console.warn(`ì´ë¯¸ì§€ ë³€í™˜ ì‹¤íŒ¨ (${devId}, ${type}):`, err);
                        return null;
                    });
            }
            
            if (imagePromise) {
                promises.push(imagePromise.then(base64 => {
                    if (base64 && base64.startsWith('data:image/')) {
                        if (!embeddedDevImages[devId]) {
                            embeddedDevImages[devId] = {};
                        }
                        embeddedDevImages[devId][type] = base64;
                        return true;
                    }
                    return false;
                }).catch(() => false));
            }
        });
        
        // ëª¨ë“  Promise ì™„ë£Œ í›„ ë°˜í™˜
        return Promise.all(promises).then(() => {
            console.log('DOMì—ì„œ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ embeddedDevImagesì— ìˆ˜ì§‘í–ˆìŠµë‹ˆë‹¤.');
        });
    }
    
    // í˜ì´ì§€ë¥¼ ë‹«ì„ ë•Œ ìë™ìœ¼ë¡œ HTML íŒŒì¼ ì €ì¥ (ë¹„í™œì„±í™”ë¨ - ì˜ë„ì¹˜ ì•Šì€ ë‹¤ìš´ë¡œë“œ ë°©ì§€)
    // ìë™ ì €ì¥ ê¸°ëŠ¥ì€ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ì €ì¥ì´ í•„ìš”í•œ ê²½ìš° ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ saveHTMLWithImages() í•¨ìˆ˜ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•˜ì„¸ìš”.
    /*
    let autoSaveTriggered = false;
    window.addEventListener('beforeunload', function(e) {
        if (!autoSaveTriggered && typeof window.saveHTMLWithImages === 'function') {
            autoSaveTriggered = true;
            // visibilitychange ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜ì´ì§€ê°€ ìˆ¨ê²¨ì§ˆ ë•Œ ì €ì¥
            if (document.visibilityState === 'hidden') {
                // DOMì—ì„œ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ìˆ˜ì§‘
                collectAllImagesFromDOM().then(() => {
                    window.saveHTMLWithImages(true);
                }).catch(() => {
                    window.saveHTMLWithImages(true);
                });
            }
        }
    });
    
    // í˜ì´ì§€ê°€ ìˆ¨ê²¨ì§ˆ ë•Œ (íƒ­ ì „í™˜, ì°½ ë‹«ê¸° ë“±) ìë™ ì €ì¥
    document.addEventListener('visibilitychange', function() {
        if (document.visibilityState === 'hidden' && !autoSaveTriggered && typeof window.saveHTMLWithImages === 'function') {
            autoSaveTriggered = true;
            // DOMì—ì„œ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ìˆ˜ì§‘
            collectAllImagesFromDOM().then(() => {
                setTimeout(() => {
                    window.saveHTMLWithImages(true);
                }, 100);
            }).catch(() => {
                setTimeout(() => {
                    window.saveHTMLWithImages(true);
                }, 100);
            });
        }
    });
    */
    </script>

</body>

</html>


