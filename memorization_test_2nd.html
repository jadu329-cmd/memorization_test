<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•”ì†¡ ì ê²€ TEST ê²Œì„ (2nd)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .mode-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #764ba2;
            color: white;
        }

        .btn-secondary:hover {
            background: #5d3a7d;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(118, 75, 162, 0.4);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-info {
            background: #3b82f6;
            color: white;
        }

        .btn-info:hover {
            background: #2563eb;
        }

        .category-selector {
            display: none;
            margin-top: 20px;
        }

        .category-selector.active {
            display: block;
        }

        .category-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .game-area {
            display: none;
        }

        .game-area.active {
            display: block;
        }

        .verse-info {
            background: #f3f4f6;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }

        .verse-reference {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .verse-number {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 10px;
        }

        .progress {
            margin-top: 15px;
            font-size: 14px;
            color: #6b7280;
        }

        .input-area {
            margin-bottom: 20px;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            resize: vertical;
            font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
            line-height: 1.6;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .result-area {
            margin-bottom: 20px;
        }

        .result-message {
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            display: none;
        }

        .result-message.show {
            display: block;
        }

        .result-message.correct {
            background: #d1fae5;
            color: #065f46;
            border: 2px solid #10b981;
        }

        .result-message.incorrect {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #ef4444;
        }

        .answer-comparison {
            background: #f9fafb;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            display: none;
        }

        .answer-comparison.show {
            display: block;
        }

        .answer-line {
            margin-bottom: 10px;
            line-height: 1.8;
            font-size: 16px;
        }

        .answer-line .correct {
            color: #065f46;
        }

        .answer-line .incorrect {
            background: #fee2e2;
            color: #991b1b;
            padding: 2px 4px;
            border-radius: 4px;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e5e7eb;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .hide {
            display: none;
        }

        .correct-answer {
            background: #ecfdf5;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid #10b981;
            margin-top: 15px;
            line-height: 1.8;
            font-size: 16px;
        }

        .wrong-answer-item {
            background: #fff;
            border: 2px solid #fee2e2;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .wrong-answer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #fee2e2;
        }

        .wrong-answer-reference {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
        }

        .wrong-answer-number {
            font-size: 14px;
            color: #6b7280;
        }

        .wrong-answer-verse {
            line-height: 1.8;
            font-size: 16px;
            color: #333;
            margin-top: 10px;
        }

        .wrong-answers-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .wrong-answers-header h2 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        .wrong-answers-header p {
            color: #6b7280;
            font-size: 1em;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 20px 15px;
                border-radius: 15px;
            }

            h1 {
                font-size: 1.5em;
                margin-bottom: 20px;
            }

            .game-selector {
                margin-bottom: 20px;
            }

            .mode-buttons {
                flex-direction: column;
                gap: 8px;
            }

            button {
                padding: 14px 20px;
                font-size: 15px;
                width: 100%;
            }

            .category-buttons {
                flex-direction: column;
                gap: 8px;
            }

            .category-buttons button {
                width: 100%;
            }

            .verse-info {
                padding: 15px;
                margin-bottom: 15px;
            }

            .verse-reference {
                font-size: 20px;
            }

            .verse-number {
                font-size: 13px;
            }

            .progress {
                font-size: 13px;
            }

            textarea {
                min-height: 180px;
                padding: 12px;
                font-size: 15px;
            }

            .result-message {
                padding: 12px;
                font-size: 16px;
            }

            .answer-comparison {
                padding: 15px;
            }

            .answer-line {
                font-size: 15px;
                line-height: 1.6;
            }

            .control-buttons {
                flex-direction: column;
                gap: 8px;
            }

            .control-buttons button {
                width: 100%;
            }

            .navigation {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }

            .nav-buttons {
                flex-direction: column;
                gap: 8px;
                width: 100%;
            }

            .nav-buttons button {
                width: 100%;
            }

            .wrong-answer-item {
                padding: 15px;
                margin-bottom: 15px;
            }

            .wrong-answer-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .wrong-answer-reference {
                font-size: 18px;
            }

            .wrong-answer-number {
                font-size: 13px;
            }

            .wrong-answer-verse {
                font-size: 15px;
                line-height: 1.6;
            }

            .correct-answer {
                padding: 12px;
                font-size: 15px;
            }

            .wrong-answers-header {
                margin-bottom: 20px;
            }

            .wrong-answers-header h2 {
                font-size: 1.5em;
            }

            .wrong-answers-header p {
                font-size: 0.9em;
            }

            #wrongAnswersList > div:first-child {
                padding: 12px !important;
            }

            #wrongAnswersList > div:first-child p {
                font-size: 16px !important;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.3em;
            }

            .verse-reference {
                font-size: 18px;
            }

            textarea {
                min-height: 150px;
                font-size: 14px;
            }

            .result-message {
                font-size: 15px;
            }

            .answer-line {
                font-size: 14px;
            }

            .wrong-answer-reference {
                font-size: 16px;
            }

            .wrong-answer-verse {
                font-size: 14px;
            }

            button[onclick="goHome()"] {
                font-size: 18px !important;
                padding: 12px 20px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“– ì•”ì†¡ ì ê²€ TEST ê²Œì„ (2nd)</h1>
        
        <div class="game-selector">
            <div class="mode-buttons">
                <button class="btn-primary" onclick="selectMode(1)">1. ì „ì²´ ìˆœì„œëŒ€ë¡œ</button>
                <button class="btn-primary" onclick="selectMode(2)">2. ëª©ì°¨ë³„ë¡œ ì„ê¸°</button>
                <button class="btn-primary" onclick="selectMode(3)">3. ì „ì²´ ë¬´ì‘ìœ„ ì„ê¸°</button>
            </div>
            
            <div class="category-selector" id="categorySelector">
                <h3 style="margin-bottom: 15px; color: #333;">ëª©ì°¨ ì„ íƒ</h3>
                <div class="category-buttons">
                    <button class="btn-secondary" onclick="selectCategory('ì˜í˜¼ì— ëŒ€í•˜ì—¬')">ì˜í˜¼ì— ëŒ€í•˜ì—¬</button>
                    <button class="btn-secondary" onclick="selectCategory('ì£„ì— ëŒ€í•˜ì—¬')">ì£„ì— ëŒ€í•˜ì—¬</button>
                    <button class="btn-secondary" onclick="selectCategory('ì‹¬íŒì— ëŒ€í•˜ì—¬')">ì‹¬íŒì— ëŒ€í•˜ì—¬</button>
                </div>
            </div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="verse-info">
                <div class="verse-reference" id="verseReference"></div>
                <div class="verse-number" id="verseNumber"></div>
                <div class="progress" id="progress"></div>
            </div>

            <div class="input-area">
                <textarea id="userInput" placeholder="ì•”ì†¡ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." oninput="checkAnswer()"></textarea>
            </div>

            <div class="result-area">
                <div class="result-message" id="resultMessage"></div>
                
                <div class="answer-comparison" id="answerComparison"></div>
                
                <div class="control-buttons">
                    <button class="btn-info" onclick="showWrongParts()">í‹€ë¦° ë¶€ë¶„ë§Œ í™•ì¸í•˜ê¸°</button>
                    <button class="btn-success" onclick="showFullAnswer()">ì „ì²´ ì •ë‹µ ë³´ê¸°</button>
                </div>
                
                <div class="correct-answer hide" id="fullAnswer"></div>
            </div>

            <div class="navigation">
                <div class="nav-buttons">
                    <button class="btn-secondary" onclick="previousVerse()">ì´ì „</button>
                    <button class="btn-primary" onclick="restartGame()">ì²˜ìŒìœ¼ë¡œ</button>
                    <button class="btn-secondary" onclick="nextVerse()">ë‹¤ìŒ</button>
                </div>
                <div class="nav-buttons" style="margin-top: 10px;">
                    <button class="btn-info" onclick="showWrongAnswers()">ğŸ“ ì˜¤ë‹µë…¸íŠ¸</button>
                    <button class="btn-primary" onclick="goHome()" style="font-size: 20px; padding: 8px 16px;">ğŸ </button>
                </div>
            </div>
        </div>

        <div class="game-area" id="wrongAnswersArea" style="display: none;">
            <div class="wrong-answers-header">
                <h2>ğŸ“ ì˜¤ë‹µ ë…¸íŠ¸</h2>
                <p>í‹€ë ¸ë˜ ë¬¸ì œë“¤ì„ ë‹¤ì‹œ í™•ì¸í•´ë³´ì„¸ìš”</p>
            </div>
            
            <div id="wrongAnswersList"></div>
            
            <div class="navigation" style="margin-top: 30px;">
                <div class="nav-buttons">
                    <button class="btn-secondary" onclick="backToGame()">ê²Œì„ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
                    <button class="btn-primary" onclick="goHome()" style="font-size: 20px; padding: 8px 16px;">ğŸ </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // ì•”ì†¡ ë°ì´í„°
        // ì•„ë˜ ë°°ì—´ì— ì•”ì†¡ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ì„¸ìš”
        // í˜•ì‹: { no: ë²ˆí˜¸, reference: "ì¥ì ˆ", verse: "êµ¬ì ˆ ë‚´ìš©", category: "ëª©ì°¨ ì´ë¦„" }
        // ============================================
        const memorizationData = [
            // ì˜í˜¼ì— ëŒ€í•˜ì—¬ (1-11)
            { no: 1, reference: "ìš¥ 19:26", verse: "ë‚˜ì˜ ì´ ê°€ì£½, ì´ê²ƒì´ ì©ì€ í›„ì— ë‚´ê°€ ìœ¡ì²´ ë°–ì—ì„œ í•˜ë‚˜ë‹˜ì„ ë³´ë¦¬ë¼", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 2, reference: "ì°½ 2:7", verse: "ì—¬í˜¸ì™€ í•˜ë‚˜ë‹˜ì´ í™ìœ¼ë¡œ ì‚¬ëŒì„ ì§€ìœ¼ì‹œê³  ìƒê¸°ë¥¼ ê·¸ ì½”ì— ë¶ˆì–´ ë„£ìœ¼ì‹œë‹ˆ ì‚¬ëŒì´ ìƒë ¹ì´ ëœì§€ë¼", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 3, reference: "ì‚¬ 57:16", verse: "ë‚´ê°€ ì˜ì›íˆëŠ” ë‹¤íˆ¬ì§€ ì•„ë‹ˆí•˜ë©° ë‚´ê°€ ì¥êµ¬íˆëŠ” ë…¸í•˜ì§€ ì•„ë‹ˆí•  ê²ƒì€ ë‚˜ì˜ ì§€ì€ ê·¸ ì˜ê³¼ í˜¼ì´ ë‚´ ì•ì—ì„œ ê³¤ë¹„í• ê¹Œ í•¨ì´ë‹ˆë¼", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 4, reference: "ëˆ… 12:20~21", verse: "í•˜ë‚˜ë‹˜ì€ ì´ë¥´ì‹œë˜ ì–´ë¦¬ì„ì€ ìì—¬ ì˜¤ëŠ˜ ë°¤ì— ë„¤ ì˜í˜¼ì„ ë„ë¡œ ì°¾ìœ¼ë¦¬ë‹ˆ ê·¸ëŸ¬ë©´ ë„¤ ì˜ˆë¹„í•œ ê²ƒì´ ë‰˜ ê²ƒì´ ë˜ê² ëŠëƒ í•˜ì…¨ìœ¼ë‹ˆ ìê¸°ë¥¼ ìœ„í•˜ì—¬ ì¬ë¬¼ì„ ìŒ“ì•„ ë‘ê³  í•˜ë‚˜ë‹˜ê»˜ ëŒ€í•˜ì—¬ ë¶€ìš”ì¹˜ ëª»í•œ ìê°€ ì´ì™€ ê°™ìœ¼ë‹ˆë¼", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 5, reference: "ì „ 3:11", verse: "í•˜ë‚˜ë‹˜ì´ ëª¨ë“  ê²ƒì„ ì§€ìœ¼ì‹œë˜ ë•Œë¥¼ ë”°ë¼ ì•„ë¦„ë‹µê²Œ í•˜ì…¨ê³  ë˜ ì‚¬ëŒì—ê²Œ ì˜ì›ì„ ì‚¬ëª¨í•˜ëŠ” ë§ˆìŒì„ ì£¼ì…¨ëŠë‹ˆë¼ ê·¸ëŸ¬ë‚˜ í•˜ë‚˜ë‹˜ì˜ í•˜ì‹œëŠ” ì¼ì˜ ì‹œì¢…ì„ ì‚¬ëŒìœ¼ë¡œ ì¸¡ëŸ‰í•  ìˆ˜ ì—†ê²Œ í•˜ì…¨ë„ë‹¤", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 6, reference: "ì•½ 2:26", verse: "ì˜í˜¼ ì—†ëŠ” ëª¸ì´ ì£½ì€ê²ƒ ê°™ì´ í–‰í•¨ì´ ì—†ëŠ” ë¯¿ìŒì€ ì£½ì€ ê²ƒì´ë‹ˆë¼", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 7, reference: "ì „ 3:20~21", verse: "ë‹¤ í™ìœ¼ë¡œ ë§ë¯¸ì•”ì•˜ìœ¼ë¯€ë¡œ ë‹¤ í™ìœ¼ë¡œ ëŒì•„ê°€ë‚˜ë‹ˆ ë‹¤ í•œ ê³³ìœ¼ë¡œ ê°€ê±°ë‹ˆì™€ ì¸ìƒì˜ í˜¼ì€ ìœ„ë¡œ ì˜¬ë¼ê°€ê³  ì§ìŠ¹ì˜ í˜¼ì€ ì•„ë˜ ê³§ ë•…ìœ¼ë¡œ ë‚´ë ¤ê°€ëŠ” ì¤„ì„ ëˆ„ê°€ ì•Œë´", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 8, reference: "í–‰ 7:59~60", verse: "ì €í¬ê°€ ëŒë¡œ ìŠ¤ë°ë°˜ì„ ì¹˜ë‹ˆ ìŠ¤ë°ë°˜ì´ ë¶€ë¥´ì§–ì–´ ê°€ë¡œë˜ ì£¼ ì˜ˆìˆ˜ì—¬ ë‚´ ì˜í˜¼ì„ ë°›ìœ¼ì‹œì˜µì†Œì„œ í•˜ê³  ë¬´ë¦ì„ ê¿‡ê³  í¬ê²Œ ë¶ˆëŸ¬ ê°€ë¡œë˜ ì£¼ì—¬ ì´ ì£„ë¥¼ ì €ë“¤ì—ê²Œ ëŒë¦¬ì§€ ë§ˆì˜µì†Œì„œ ì´ ë§ì„ í•˜ê³  ìë‹ˆë¼", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 9, reference: "ê²” 18:4", verse: "ëª¨ë“  ì˜í˜¼ì´ ë‹¤ ë‚´ê²Œ ì†í•œì§€ë¼ ì•„ë¹„ì˜ ì˜í˜¼ì´ ë‚´ê²Œ ì†í•¨ ê°™ì´ ì•„ë“¤ì˜ ì˜í˜¼ë„ ë‚´ê²Œ ì†í•˜ì˜€ë‚˜ë‹ˆ ë²”ì£„í•˜ëŠ” ê·¸ ì˜í˜¼ì´ ì£½ìœ¼ë¦¬ë¼", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 10, reference: "ë§ˆ 10:28", verse: "ëª¸ì€ ì£½ì—¬ë„ ì˜í˜¼ì€ ëŠ¥íˆ ì£½ì´ì§€ ëª»í•˜ëŠ” ìë“¤ì„ ë‘ë ¤ì›Œí•˜ì§€ ë§ê³  ì˜¤ì§ ëª¸ê³¼ ì˜í˜¼ì„ ëŠ¥íˆ ì§€ì˜¥ì— ë©¸í•˜ì‹œëŠ” ìë¥¼ ë‘ë ¤ì›Œí•˜ë¼", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            { no: 11, reference: "ì „ 2:24", verse: "ì‚¬ëŒì´ ë¨¹ê³  ë§ˆì‹œë©° ìˆ˜ê³ í•˜ëŠ” ê°€ìš´ë°ì„œ ì‹¬ë ¹ìœ¼ë¡œ ë‚™ì„ ëˆ„ë¦¬ê²Œ í•˜ëŠ” ê²ƒë³´ë‹¤ ë‚˜ì€ ê²ƒì´ ì—†ë‚˜ë‹ˆ ë‚´ê°€ ì´ê²ƒë„ ë³¸ì¦‰ í•˜ë‚˜ë‹˜ì˜ ì†ì—ì„œ ë‚˜ëŠ” ê²ƒì´ë¡œë‹¤", category: "ì˜í˜¼ì— ëŒ€í•˜ì—¬" },
            
            // ì£„ì— ëŒ€í•˜ì—¬ (12-26)
            { no: 12, reference: "ìš¥ 15:14-16", verse: "ì‚¬ëŒì´ ë¬´ì—‡ì´ê´€ëŒ€ ê¹¨ë—í•˜ê² ëŠëƒ ì—¬ì¸ì—ê²Œì„œ ë‚œ ìê°€ ë¬´ì—‡ì´ê´€ëŒ€ ì˜ë¡­ê² ëŠëƒ í•˜ë‚˜ë‹˜ì€ ê·¸ ê±°ë£©í•œ ìë“¤ì„ ë¯¿ì§€ ì•„ë‹ˆ í•˜ì‹œë‚˜ë‹ˆ í•˜ëŠ˜ì´ë¼ë„ ê·¸ì˜ ë³´ì‹œê¸°ì— ë¶€ì •í•˜ê±°ë“  í•˜ë¬¼ë©° ì•…ì„ ì§“ê¸°ë¥¼ ë¬¼ ë§ˆì‹¬ ê°™ì´ í•˜ëŠ” ê°€ì¦í•˜ê³  ë¶€íŒ¨í•œ ì‚¬ëŒì´ê² ëŠëƒ", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 13, reference: "ì‹œ 38:3-4", verse: "ì£¼ì˜ ì§„ë…¸ë¡œ ì¸í•˜ì—¬ ë‚´ ì‚´ì— ì„±í•œ ê³³ì´ ì—†ì‚¬ì˜¤ë©° ë‚˜ì˜ ì£„ë¡œ ì¸í•˜ì—¬ ë‚´ ë¼ˆì— í‰ì•ˆí•¨ì´ ì—†ë‚˜ì´ë‹¤ ë‚´ ì£„ì•…ì´ ë‚´ ë¨¸ë¦¬ì— ë„˜ì³ì„œ ë¬´ê±°ìš´ ì§ ê°™ìœ¼ë‹ˆ ê°ë‹¹í•  ìˆ˜ ì—†ë‚˜ì´ë‹¤", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 14, reference: "ì‹œ 51:5", verse: "ë‚´ê°€ ì£„ì•… ì¤‘ì— ì¶œìƒí•˜ì˜€ìŒì´ì—¬ ëª¨ì¹œì´ ì£„ ì¤‘ì— ë‚˜ë¥¼ ì‰íƒœí•˜ì˜€ë‚˜ì´ë‹¤", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 15, reference: "ì  30:12", verse: "ìŠ¤ìŠ¤ë¡œ ê¹¨ë—í•œ ìë¡œ ì—¬ê¸°ë©´ì„œ ì˜¤íˆë ¤ ê·¸ ë”ëŸ¬ìš´ ê²ƒì„ ì”»ì§€ ì•„ë‹ˆí•˜ëŠ” ë¬´ë¦¬ê°€ ìˆëŠë‹ˆë¼", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 16, reference: "ì „ 9:3", verse: "ëª¨ë“  ì‚¬ëŒì˜ ê²°êµ­ì´ ì¼ë°˜ì¸ ê·¸ê²ƒì€ í•´ ì•„ë˜ì„œ ëª¨ë“  ì¼ ì¤‘ì— ì•…í•œ ê²ƒì´ë‹ˆ ê³§ ì¸ìƒì˜ ë§ˆìŒì— ì•…ì´ ê°€ë“í•˜ì—¬ í‰ìƒì— ë¯¸ì¹œ ë§ˆìŒì„ í’ˆë‹¤ê°€ í›„ì—ëŠ” ì£½ì€ ìì—ê²Œë¡œ ëŒì•„ê°€ëŠ” ê²ƒì´ë¼", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 17, reference: "ì‚¬ 59:1-3", verse: "ì—¬í˜¸ì™€ì˜ ì†ì´ ì§§ì•„ êµ¬ì›ì¹˜ ëª»í•˜ì‹¬ë„ ì•„ë‹ˆìš” ê·€ê°€ ë‘”í•˜ì—¬ ë“£ì§€ ëª»í•˜ì‹¬ë„ ì•„ë‹ˆë¼ ì˜¤ì§ ë„ˆí¬ ì£„ì•…ì´ ë„ˆí¬ì™€ ë„ˆí¬ í•˜ë‚˜ë‹˜ ì‚¬ì´ë¥¼ ë‚´ì—ˆê³  ë„ˆí¬ ì£„ê°€ ê·¸ ì–¼êµ´ì„ ê°€ë¦¬ì›Œì„œ ë„ˆí¬ë¥¼ ë“£ì§€ ì•Šìœ¼ì‹œê²Œ í•¨ì´ë‹ˆ ì´ëŠ” ë„ˆí¬ ì†ì´ í”¼ì—, ë„ˆí¬ ì†ê°€ë½ì´ ì£„ì•…ì— ë”ëŸ¬ì› ìœ¼ë©° ë„ˆí¬ ì…ìˆ ì€ ê±°ì§“ì„ ë§í•˜ë©° ë„ˆí¬ í˜€ëŠ” ì•…ë…ì„ ë°œí•¨ì´ë¼", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 18, reference: "ì•½ 2:9-10", verse: "ë§Œì¼ ë„ˆí¬ê°€ ì™¸ëª¨ë¡œ ì‚¬ëŒì„ ì·¨í•˜ë©´ ì£„ë¥¼ ì§“ëŠ” ê²ƒì´ë‹ˆ ìœ¨ë²•ì´ ë„ˆí¬ë¥¼ ë²”ì£„ìë¡œ ì •í•˜ë¦¬ë¼ ëˆ„êµ¬ë“ ì§€ ì˜¨ ìœ¨ë²•ì„ ì§€í‚¤ë‹¤ê°€ ê·¸ í•˜ë‚˜ì— ê±°ì¹˜ë©´ ëª¨ë‘ ë²”í•œ ìê°€ ë˜ë‚˜ë‹ˆ", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 19, reference: "ë ˜ 17:9-10", verse: "ë§Œë¬¼ë³´ë‹¤ ê±°ì§“ë˜ê³  ì‹¬íˆ ë¶€íŒ¨í•œ ê²ƒì€ ë§ˆìŒì´ë¼ ëˆ„ê°€ ëŠ¥íˆ ì´ë¥¼ ì•Œë¦¬ìš”ë§ˆëŠ” ë‚˜ ì—¬í˜¸ì™€ëŠ” ì‹¬ì¥ì„ ì‚´í”¼ë©° íë¶€ë¥¼ ì‹œí—˜í•˜ê³  ê°ê° ê·¸ í–‰ìœ„ì™€ ê·¸ í–‰ì‹¤ëŒ€ë¡œ ë³´ì‘í•˜ë‚˜ë‹ˆ", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 20, reference: "ìš”ì¼ 2:15-16", verse: "ì´ ì„¸ìƒì´ë‚˜ ì„¸ìƒì— ìˆëŠ” ê²ƒë“¤ì„ ì‚¬ë‘ì¹˜ ë§ë¼ ëˆ„êµ¬ë“ ì§€ ì„¸ìƒì„ ì‚¬ë‘í•˜ë©´ ì•„ë²„ì§€ì˜ ì‚¬ë‘ì´ ê·¸ ì†ì— ìˆì§€ ì•„ë‹ˆí•˜ë‹ˆ ì´ëŠ” ì„¸ìƒì— ìˆëŠ” ëª¨ë“  ê²ƒì´ ìœ¡ì‹ ì˜ ì •ìš•ê³¼ ì•ˆëª©ì˜ ì •ìš•ê³¼ ì´ìƒì˜ ìë‘ì´ë‹ˆ ë‹¤ ì•„ë²„ì§€ê»˜ë¡œ ì¢‡ì•„ ì˜¨ ê²ƒì´ ì•„ë‹ˆìš” ì„¸ìƒìœ¼ë¡œ ì¢‡ì•„ ì˜¨ ê²ƒì´ë¼", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 21, reference: "ìš”ì¼ 3:8", verse: "ì£„ë¥¼ ì§“ëŠ” ìëŠ” ë§ˆê·€ì—ê²Œ ì†í•˜ë‚˜ë‹ˆ ë§ˆê·€ëŠ” ì²˜ìŒë¶€í„° ë²”ì£„í•¨ì´ë‹ˆë¼ í•˜ë‚˜ë‹˜ì˜ ì•„ë“¤ì´ ë‚˜íƒ€ë‚˜ì‹  ê²ƒì€ ë§ˆê·€ì˜ ì¼ì„ ë©¸í•˜ë ¤ í•˜ì‹¬ì´ë‹ˆë¼", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 22, reference: "ë ˜ 2:22", verse: "ì£¼ ì—¬í˜¸ì™€ ë‚´ê°€ ë§í•˜ë…¸ë¼ ë„¤ê°€ ì¿ë¬¼ë¡œ ìŠ¤ìŠ¤ë¡œ ì”»ìœ¼ë©° ìˆ˜ë‹¤í•œ ë¹„ëˆ„ë¥¼ ì“¸ì§€ë¼ë„ ë„¤ ì£„ì•…ì´ ì˜¤íˆë ¤ ë‚´ ì•ì— ê·¸ì € ìˆìœ¼ë¦¬ë‹ˆ", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 23, reference: "ë ˜ 2:35", verse: "ê·¸ëŸ¬ë‚˜ ë„ˆëŠ” ë§í•˜ê¸°ë¥¼ ë‚˜ëŠ” ë¬´ì£„í•˜ë‹ˆ ê·¸ ì§„ë…¸ê°€ ì°¸ìœ¼ë¡œ ë‚´ê²Œì„œ ë– ë‚¬ë‹¤ í•˜ê±°ë‹ˆì™€ ë³´ë¼ ë„¤ ë§ì´ ë‚˜ëŠ” ì£„ë¥¼ ë²”ì¹˜ ì•„ë‹ˆí•˜ì˜€ë‹¤ í•¨ì„ ì¸í•˜ì—¬ ë‚´ê°€ ë„ˆë¥¼ ì‹¬íŒí•˜ë¦¬ë¼", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 24, reference: "ë¡¬ 3:10-12", verse: "ê¸°ë¡í•œë°” ì˜ì¸ì€ ì—†ë‚˜ë‹ˆ í•˜ë‚˜ë„ ì—†ìœ¼ë©° ê¹¨ë‹«ëŠ” ìë„ ì—†ê³  í•˜ë‚˜ë‹˜ì„ ì°¾ëŠ” ìë„ ì—†ê³  ë‹¤ ì¹˜ìš°ì³ í•œê°€ì§€ë¡œ ë¬´ìµí•˜ê²Œ ë˜ê³  ì„ ì„ í–‰í•˜ëŠ” ìëŠ” ì—†ë‚˜ë‹ˆ í•˜ë‚˜ë„ ì—†ë„ë‹¤", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 25, reference: "ìš¥ 13:26-28", verse: "ì£¼ê»˜ì„œ ë‚˜ë¥¼ ëŒ€ì í•˜ì‚¬ ê´´ë¡œìš´ ì¼ë“¤ì„ ê¸°ë¡í•˜ì‹œë©° ë‚˜ë¡œ ë‚˜ì˜ ì–´ë ¸ì„ ë•Œì— ì§€ì€ ì£„ë¥¼ ë°›ê²Œ í•˜ì‹œì˜¤ë©° ë‚´ ë°œì„ ì°©ê³ ì— ì±„ìš°ì‹œë©° ë‚˜ì˜ ëª¨ë“  ê¸¸ì„ ì‚´í”¼ì‚¬ ë‚´ ë°œìì·¨ë¥¼ í•œì •í•˜ì‹œë‚˜ì´ë‹¤ ë‚˜ëŠ” ì©ì€ ë¬¼ê±´ì˜ í›„íŒ¨í•¨ ê°™ìœ¼ë©° ì¢€ë¨¹ì€ ì˜ë³µ ê°™ìœ¼ë‹ˆì´ë‹¤", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            { no: 26, reference: "ì‚¬ 64:6", verse: "ëŒ€ì € ìš°ë¦¬ëŠ” ë‹¤ ë¶€ì •í•œ ì ê°™ì•„ì„œ ìš°ë¦¬ì˜ ì˜ëŠ” ë‹¤ ë”ëŸ¬ìš´ ì˜· ê°™ìœ¼ë©° ìš°ë¦¬ëŠ” ë‹¤ ì‡ íŒ¨í•¨ì´ ìì‚¬ê·€ ê°™ìœ¼ë¯€ë¡œ ìš°ë¦¬ì˜ ì£„ì•…ì´ ë°”ëŒ ê°™ì´ ìš°ë¦¬ë¥¼ ëª°ì•„ ê°€ë‚˜ì´ë‹¤", category: "ì£„ì— ëŒ€í•˜ì—¬" },
            
            // ì‹¬íŒì— ëŒ€í•˜ì—¬ (27-36)
            { no: 27, reference: "ì „ 11:9", verse: "ì²­ë…„ì´ì—¬ ë„¤ ì–´ë¦° ë•Œë¥¼ ì¦ê±°ì›Œí•˜ë©° ë„¤ ì²­ë…„ì˜ ë‚ ì„ ë§ˆìŒì— ê¸°ë»í•˜ì—¬ ë§ˆìŒì— ì›í•˜ëŠ” ê¸¸ê³¼ ë„¤ ëˆˆì´ ë³´ëŠ”ëŒ€ë¡œ ì¢‡ì•„ í–‰í•˜ë¼ ê·¸ëŸ¬ë‚˜ í•˜ë‚˜ë‹˜ì´ ì´ ëª¨ë“  ì¼ë¡œ ì¸í•˜ì—¬ ë„ˆë¥¼ ì‹¬íŒí•˜ì‹¤ ì¤„ ì•Œë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 28, reference: "ë§ˆ 3:12", verse: "ì†ì— í‚¤ë¥¼ ë“¤ê³  ìê¸°ì˜ íƒ€ì‘ ë§ˆë‹¹ì„ ì •í•˜ê²Œ í•˜ì‚¬ ì•Œê³¡ì€ ëª¨ì•„ ê³¡ê°„ì— ë“¤ì´ê³  ì­‰ì •ì´ëŠ” êº¼ì§€ì§€ ì•ŠëŠ” ë¶ˆì— íƒœìš°ì‹œë¦¬ë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 29, reference: "í–‰ 17:30~31", verse: "ì•Œì§€ ëª»í•˜ë˜ ì‹œëŒ€ì—ëŠ” í•˜ë‚˜ë‹˜ì´ í—ˆë¬¼ì¹˜ ì•„ë‹ˆí•˜ì…¨ê±°ë‹ˆì™€ ì´ì œëŠ” ì–´ë””ë“ ì§€ ì‚¬ëŒì„ ë‹¤ ëª…í•˜ì‚¬ íšŒê°œí•˜ë¼ í•˜ì…¨ìœ¼ë‹ˆ ì´ëŠ” ì •í•˜ì‹  ì‚¬ëŒìœ¼ë¡œ í•˜ì—¬ê¸ˆ ì²œí•˜ë¥¼ ê³µì˜ë¡œ ì‹¬íŒí•  ë‚ ì„ ì‘ì •í•˜ì‹œê³  ì´ì— ì €ë¥¼ ì£½ì€ ì ê°€ìš´ë°ì„œ ë‹¤ì‹œ ì‚´ë¦¬ì‹  ê²ƒìœ¼ë¡œ ëª¨ë“  ì‚¬ëŒì—ê²Œ ë¯¿ì„ë§Œí•œ ì¦ê±°ë¥¼ ì£¼ì…¨ìŒì´ë‹ˆë¼ í•˜ë‹ˆë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 30, reference: "ë¡¬ 14:11~12", verse: "ê¸°ë¡ë˜ì—ˆìœ¼ë˜ ì£¼ê»˜ì„œ ê°€ë¼ì‚¬ëŒ€ ë‚´ê°€ ì‚´ì•˜ë…¸ë‹ˆ ëª¨ë“  ë¬´ë¦ì´ ë‚´ê²Œ ê¿‡ì„ ê²ƒì´ìš” ëª¨ë“  í˜€ê°€ í•˜ë‚˜ë‹˜ê»˜ ìë°±í•˜ë¦¬ë¼ í•˜ì˜€ëŠë‹ˆë¼ ì´ëŸ¬ë¯€ë¡œ ìš°ë¦¬ ê°ì¸ì´ ìê¸° ì¼ì„ í•˜ë‚˜ë‹˜ê»˜ ì§ê³ í•˜ë¦¬ë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 31, reference: "ë§ˆ 12:36~37", verse: "ë‚´ê°€ ë„ˆí¬ì—ê²Œ ì´ë¥´ë…¸ë‹ˆ ì‚¬ëŒì´ ë¬´ìŠ¨ ë¬´ìµí•œ ë§ì„ í•˜ë“ ì§€ ì‹¬íŒë‚ ì— ì´ì— ëŒ€í•˜ì—¬ ì‹¬ë¬¸ì„ ë°›ìœ¼ë¦¬ë‹ˆ ë„¤ ë§ë¡œ ì˜ë¡­ë‹¤ í•¨ì„ ë°›ê³  ë„¤ ë§ë¡œ ì •ì£„í•¨ì„ ë°›ìœ¼ë¦¬ë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 32, reference: "íˆ 4:13", verse: "ì§€ìœ¼ì‹  ê²ƒì´ í•˜ë‚˜ë¼ë„ ê·¸ ì•ì— ë‚˜íƒ€ë‚˜ì§€ ì•ŠìŒì´ ì—†ê³  ì˜¤ì§ ë§Œë¬¼ì´ ìš°ë¦¬ë¥¼ ìƒê´€í•˜ì‹œëŠ” ìì˜ ëˆˆì•ì— ë²Œê±°ë²—ì€ ê²ƒ ê°™ì´ ë“œëŸ¬ë‚˜ëŠë‹ˆë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 33, reference: "íˆ 9:27~28", verse: "í•œë²ˆ ì£½ëŠ” ê²ƒì€ ì‚¬ëŒì—ê²Œ ì •í•˜ì‹  ê²ƒì´ìš” ê·¸ í›„ì—ëŠ” ì‹¬íŒì´ ìˆìœ¼ë¦¬ë‹ˆ ì´ì™€ ê°™ì´ ê·¸ë¦¬ìŠ¤ë„ë„ ë§ì€ ì‚¬ëŒì˜ ì£„ë¥¼ ë‹´ë‹¹í•˜ì‹œë ¤ê³  ë‹¨ë²ˆì— ë“œë¦¬ì‹ ë°” ë˜ì…¨ê³  êµ¬ì›ì— ì´ë¥´ê²Œ í•˜ê¸° ìœ„í•˜ì—¬ ì£„ì™€ ìƒê´€ ì—†ì´ ìê¸°ë¥¼ ë°”ë¼ëŠ” ìë“¤ì—ê²Œ ë‘ë²ˆì§¸ ë‚˜íƒ€ë‚˜ì‹œë¦¬ë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 34, reference: "ë¡¬ 2:6~8", verse: "í•˜ë‚˜ë‹˜ê»˜ì„œ ê° ì‚¬ëŒì—ê²Œ ê·¸ í–‰í•œëŒ€ë¡œ ë³´ì‘í•˜ì‹œë˜ ì°¸ê³  ì„ ì„ í–‰í•˜ì—¬ ì˜ê´‘ê³¼ ì¡´ê·€ì™€ ì©ì§€ ì•„ë‹ˆí•¨ì„ êµ¬í•˜ëŠ” ìì—ê²ŒëŠ” ì˜ìƒìœ¼ë¡œ í•˜ì‹œê³  ì˜¤ì§ ë‹¹ì„ ì§€ì–´ ì§„ë¦¬ë¥¼ ì¢‡ì§€ ì•„ë‹ˆí•˜ê³  ë¶ˆì˜ë¥¼ ì¢‡ëŠ” ìì—ê²ŒëŠ” ë…¸ì™€ ë¶„ìœ¼ë¡œ í•˜ì‹œë¦¬ë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 35, reference: "ê³„ 22:10~13", verse: "ë˜ ë‚´ê²Œ ë§í•˜ë˜ ì´ ì±…ì˜ ì˜ˆì–¸ì˜ ë§ì”€ì„ ì¸ë´‰í•˜ì§€ ë§ë¼ ë•Œê°€ ê°€ê¹Œìš°ë‹ˆë¼ ë¶ˆì˜ë¥¼ í•˜ëŠ” ìëŠ” ê·¸ëŒ€ë¡œ ë¶ˆì˜ë¥¼ í•˜ê³  ë”ëŸ¬ìš´ ìëŠ” ê·¸ëŒ€ë¡œ ë”ëŸ½ê³  ì˜ë¡œìš´ ìëŠ” ê·¸ëŒ€ë¡œ ì˜ë¥¼ í–‰í•˜ê³  ê±°ë£©í•œ ìëŠ” ê·¸ëŒ€ë¡œ ê±°ë£©ë˜ê²Œ í•˜ë¼ ë³´ë¼ ë‚´ê°€ ì†íˆ ì˜¤ë¦¬ë‹ˆ ë‚´ê°€ ì¤„ ìƒì´ ë‚´ê²Œ ìˆì–´ ê° ì‚¬ëŒì—ê²Œ ê·¸ì˜ ì¼í•œëŒ€ë¡œ ê°šì•„ ì£¼ë¦¬ë¼ ë‚˜ëŠ” ì•ŒíŒŒì™€ ì˜¤ë©”ê°€ìš” ì²˜ìŒê³¼ ë‚˜ì¤‘ì´ìš” ì‹œì‘ê³¼ ëì´ë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" },
            { no: 36, reference: "ì‚´í›„ 2:10~12", verse: "ë¶ˆì˜ì˜ ëª¨ë“  ì†ì„ìœ¼ë¡œ ë©¸ë§í•˜ëŠ” ìë“¤ì—ê²Œ ì„í•˜ë¦¬ë‹ˆ ì´ëŠ” ì €í¬ê°€ ì§„ë¦¬ì˜ ì‚¬ë‘ì„ ë°›ì§€ ì•„ë‹ˆí•˜ì—¬ êµ¬ì›í•¨ì„ ì–»ì§€ ëª»í•¨ì´ë‹ˆë¼ ì´ëŸ¬ë¯€ë¡œ í•˜ë‚˜ë‹˜ì´ ìœ í˜¹ì„ ì €ì˜ ê°€ìš´ë° ì—­ì‚¬í•˜ê²Œ í•˜ì‚¬ ê±°ì§“ ê²ƒì„ ë¯¿ê²Œ í•˜ì‹¬ì€ ì§„ë¦¬ë¥¼ ë¯¿ì§€ ì•Šê³  ë¶ˆì˜ë¥¼ ì¢‹ì•„í•˜ëŠ” ëª¨ë“  ìë¡œ ì‹¬íŒì„ ë°›ê²Œ í•˜ë ¤ í•˜ì‹¬ì´ë‹ˆë¼", category: "ì‹¬íŒì— ëŒ€í•˜ì—¬" }
        ];

        let currentMode = null;
        let currentCategory = null;
        let currentQuestions = [];
        let currentIndex = 0;
        let shuffledIndices = [];
        let isChecking = false;
        let answerResults = []; // ê° ë¬¸ì œì˜ ì •ë‹µ ì—¬ë¶€ë¥¼ ì¶”ì í•˜ëŠ” ë°°ì—´
        let userAnswers = []; // ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë‹µì„ ì €ì¥

        function selectMode(mode) {
            currentMode = mode;
            const categorySelector = document.getElementById('categorySelector');
            
            if (mode === 1 || mode === 2) {
                // ì „ì²´ ìˆœì„œëŒ€ë¡œ ë˜ëŠ” ëª©ì°¨ë³„ë¡œ ì„ê¸°: ëª©ì°¨ ì„ íƒ í•„ìš”
                categorySelector.classList.add('active');
                document.getElementById('gameArea').classList.remove('active');
            } else {
                // ì „ì²´ ë¬´ì‘ìœ„ ì„ê¸°: ë°”ë¡œ ì‹œì‘
                categorySelector.classList.remove('active');
                startGame(mode);
            }
        }

        function selectCategory(category) {
            currentCategory = category;
            startGame(currentMode, category);
        }

        function startGame(mode, category = null) {
            currentMode = mode;
            currentCategory = category;
            
            // ê²Œì„ ì˜ì—­ í‘œì‹œ
            document.getElementById('gameArea').classList.add('active');
            document.getElementById('categorySelector').classList.remove('active');
            document.getElementById('wrongAnswersArea').style.display = 'none';
            
            // ì§ˆë¬¸ ëª©ë¡ ì¤€ë¹„
            if (mode === 1) {
                // ì „ì²´ ìˆœì„œëŒ€ë¡œ: ì„ íƒí•œ ëª©ì°¨ ë‚´ì—ì„œ ìˆœì„œëŒ€ë¡œ
                const categoryData = memorizationData.filter(item => item.category === category);
                currentQuestions = [...categoryData];
                shuffledIndices = currentQuestions.map((_, i) => i);
            } else if (mode === 2) {
                // ëª©ì°¨ë³„ë¡œ ì„ê¸°: ì„ íƒí•œ ëª©ì°¨ ë‚´ì—ì„œ ì„ê¸°
                const categoryData = memorizationData.filter(item => item.category === category);
                currentQuestions = [...categoryData];
                shuffledIndices = shuffleArray([...Array(categoryData.length).keys()]);
            } else if (mode === 3) {
                // ì „ì²´ ë¬´ì‘ìœ„ ì„ê¸°
                currentQuestions = [...memorizationData];
                shuffledIndices = shuffleArray([...Array(memorizationData.length).keys()]);
            }
            
            currentIndex = 0;
            // ì •ë‹µ ê²°ê³¼ ë°°ì—´ ì´ˆê¸°í™”
            answerResults = [];
            userAnswers = [];
            loadCurrentVerse();
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function loadCurrentVerse() {
            const questionIndex = shuffledIndices[currentIndex];
            const verse = currentQuestions[questionIndex];
            
            document.getElementById('verseReference').textContent = verse.reference;
            // ì „ì²´ ë¬´ì‘ìœ„ ì„ê¸° ëª¨ë“œì—ì„œëŠ” ë²ˆí˜¸ì™€ ì¹´í…Œê³ ë¦¬ ì •ë³´ ëª¨ë‘ í‘œì‹œí•˜ì§€ ì•ŠìŒ
            if (currentMode === 3) {
                document.getElementById('verseNumber').textContent = '';
            } else {
                document.getElementById('verseNumber').textContent = `No. ${verse.no} - ${verse.category}`;
            }
            document.getElementById('progress').textContent = `${currentIndex + 1} / ${currentQuestions.length}`;
            
            // ì´ì „ì— ì…ë ¥í•œ ë‹µì´ ìˆìœ¼ë©´ ë³µì›
            const previousAnswer = userAnswers[questionIndex] || '';
            document.getElementById('userInput').value = previousAnswer;
            document.getElementById('userInput').focus();
            document.getElementById('resultMessage').classList.remove('show', 'correct', 'incorrect');
            document.getElementById('answerComparison').classList.remove('show');
            document.getElementById('fullAnswer').classList.add('hide');
            isChecking = answerResults[questionIndex] === true;
            
            // ì´ë¯¸ ì •ë‹µì„ ë§ì¶˜ ë¬¸ì œë©´ ì •ë‹µ ë©”ì‹œì§€ í‘œì‹œ
            if (isChecking) {
                const resultMessage = document.getElementById('resultMessage');
                resultMessage.textContent = 'âœ… ì •ë‹µì…ë‹ˆë‹¤!';
                resultMessage.className = 'result-message show correct';
            }
        }

        function normalizeText(text) {
            // ê³µë°±ì„ í•˜ë‚˜ë¡œ í†µì¼í•˜ê³  ì•ë’¤ ê³µë°± ì œê±°
            return text.replace(/\s+/g, ' ').trim();
        }

        function checkAnswer() {
            const questionIndex = shuffledIndices[currentIndex];
            // ì´ë¯¸ ì •ë‹µìœ¼ë¡œ ì²´í¬ëœ ë¬¸ì œëŠ” ë‹¤ì‹œ ì²´í¬í•˜ì§€ ì•ŠìŒ
            if (isChecking && answerResults[questionIndex] === true) return;
            
            const userInput = document.getElementById('userInput').value;
            const correctAnswer = currentQuestions[questionIndex].verse;
            
            // ì‚¬ìš©ì ë‹µ ì €ì¥
            userAnswers[questionIndex] = userInput;
            
            // ê³µë°± ì •ê·œí™” í›„ ë¹„êµ (ì—°ì†ëœ ê³µë°±ì„ í•˜ë‚˜ë¡œ ì²˜ë¦¬)
            const normalizedUserInput = normalizeText(userInput);
            const normalizedCorrectAnswer = normalizeText(correctAnswer);
            
            const resultMessage = document.getElementById('resultMessage');
            
            if (normalizedUserInput === normalizedCorrectAnswer && userInput.trim().length > 0) {
                resultMessage.textContent = 'âœ… ì •ë‹µì…ë‹ˆë‹¤!';
                resultMessage.className = 'result-message show correct';
                document.getElementById('answerComparison').classList.remove('show');
                document.getElementById('fullAnswer').classList.add('hide');
                isChecking = true;
                answerResults[questionIndex] = true; // ì •ë‹µ ê¸°ë¡
            } else if (userInput.trim().length > 0) {
                resultMessage.textContent = 'âŒ í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.';
                resultMessage.className = 'result-message show incorrect';
                // ì˜¤ë‹µì€ ë‚˜ì¤‘ì— ë‹¤ì‹œ ì •ë‹µìœ¼ë¡œ ë°”ë€” ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì¼ë‹¨ ê¸°ë¡í•˜ì§€ ì•ŠìŒ (ì •ë‹µì´ ë˜ë©´ ê¸°ë¡)
                if (answerResults[questionIndex] === undefined) {
                    answerResults[questionIndex] = false; // ì˜¤ë‹µ ê¸°ë¡
                }
            } else {
                resultMessage.classList.remove('show');
                // ë‹µì´ ì—†ìœ¼ë©´ ê¸°ë¡í•˜ì§€ ì•ŠìŒ
            }
        }

        function showWrongParts() {
            const userInput = document.getElementById('userInput').value;
            const questionIndex = shuffledIndices[currentIndex];
            const correctAnswer = currentQuestions[questionIndex].verse;
            
            const comparison = document.getElementById('answerComparison');
            comparison.classList.add('show');
            
            // ì •ë‹µ ì „ì²´ë¥¼ ë³´ì—¬ì£¼ë˜ í‹€ë¦° ë¶€ë¶„ë§Œ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œ
            let html = '<div style="margin-bottom: 15px; font-weight: bold; color: #333;">í‹€ë¦° ë¶€ë¶„ (ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œ):</div>';
            html += '<div class="answer-line" style="line-height: 2;">';
            
            // ê³µë°± ì •ê·œí™” í•¨ìˆ˜
            const normalize = (text) => text.replace(/\s+/g, ' ').trim();
            const correctNormalized = normalize(correctAnswer);
            const userNormalized = normalize(userInput);
            
            // ì›ë³¸ ì •ë‹µ í…ìŠ¤íŠ¸ì˜ ê° ë¬¸ì ìœ„ì¹˜ì™€ ì •ê·œí™”ëœ í…ìŠ¤íŠ¸ì˜ ì¸ë±ìŠ¤ ë§¤í•‘ ìƒì„±
            const originalChars = Array.from(correctAnswer);
            const normalizedChars = Array.from(correctNormalized);
            const userChars = Array.from(userNormalized);
            
            // ì›ë³¸ í…ìŠ¤íŠ¸ì˜ ê° ë¬¸ì ìœ„ì¹˜ê°€ ì •ê·œí™”ëœ í…ìŠ¤íŠ¸ì˜ ëª‡ ë²ˆì§¸ ì¸ë±ìŠ¤ì¸ì§€ ë§¤í•‘
            // ê³µë°± ì²˜ë¦¬: ì›ë³¸ì˜ ì—°ì†ëœ ê³µë°±ì€ ì •ê·œí™”ëœ í…ìŠ¤íŠ¸ì˜ í•˜ë‚˜ì˜ ê³µë°±ì— ë§¤í•‘
            const originalToNormalized = [];
            let normalizedIdx = 0;
            let inWhitespace = false;
            
            for (let i = 0; i < originalChars.length; i++) {
                const char = originalChars[i];
                const isWhitespace = char === ' ' || char === '\n' || char === '\t';
                
                if (isWhitespace) {
                    // ê³µë°±ì¸ ê²½ìš°: ì—°ì†ëœ ê³µë°±ì˜ ì²« ë²ˆì§¸ë§Œ ì •ê·œí™”ëœ í…ìŠ¤íŠ¸ì— ë§¤í•‘
                    if (!inWhitespace && normalizedIdx < normalizedChars.length && normalizedChars[normalizedIdx] === ' ') {
                        originalToNormalized[i] = normalizedIdx;
                        normalizedIdx++;
                    }
                    inWhitespace = true;
                } else {
                    // ê³µë°±ì´ ì•„ë‹Œ ë¬¸ì
                    if (normalizedIdx < normalizedChars.length) {
                        originalToNormalized[i] = normalizedIdx;
                        normalizedIdx++;
                    }
                    inWhitespace = false;
                }
            }
            
            // ì •ê·œí™”ëœ í…ìŠ¤íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í‹€ë¦° ìœ„ì¹˜ ì°¾ê¸°
            // Dynamic Programming ê¸°ë°˜ì˜ ë¬¸ì ë‹¨ìœ„ ë¹„êµë¡œ ì •í™•í•œ ë§¤ì¹­ ìˆ˜í–‰
            const wrongPositions = new Set();
            
            // ë¬¸ì ë‹¨ìœ„ë¡œ ë¹„êµí•˜ì—¬ í‹€ë¦° ìœ„ì¹˜ ì°¾ê¸°
            let correctIdx = 0;
            let userIdx = 0;
            
            while (correctIdx < normalizedChars.length) {
                const correctChar = normalizedChars[correctIdx];
                
                if (userIdx < userChars.length) {
                    const userChar = userChars[userIdx];
                    
                    if (correctChar === userChar) {
                        // ì¼ì¹˜í•˜ëŠ” ê²½ìš°: ë‘ ì¸ë±ìŠ¤ ëª¨ë‘ ì¦ê°€
                        correctIdx++;
                        userIdx++;
                    } else {
                        // í‹€ë¦° ê²½ìš°: ì •ë‹µ ë¬¸ìë¥¼ í‹€ë ¸ë‹¤ê³  í‘œì‹œ
                        wrongPositions.add(correctIdx);
                        correctIdx++;
                        
                        // ì‚¬ìš©ì ì…ë ¥ì˜ í˜„ì¬ ë¬¸ìê°€ ê³µë°±ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ê±´ë„ˆë›°ê¸°
                        // (ê³µë°±ì´ë©´ ê·¸ëŒ€ë¡œ ë‘ê³  ë‹¤ìŒ ì •ë‹µ ë¬¸ìì™€ ë¹„êµ)
                        if (userChar !== ' ') {
                            userIdx++;
                        }
                    }
                } else {
                    // ì‚¬ìš©ì ì…ë ¥ì´ ëë‚¬ëŠ”ë° ì •ë‹µì´ ë‚¨ì€ ê²½ìš°: ëª¨ë‘ í‹€ë¦° ê²ƒìœ¼ë¡œ í‘œì‹œ
                    wrongPositions.add(correctIdx);
                    correctIdx++;
                }
            }
            
            // ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ë©´ì„œ í‹€ë¦° ë¶€ë¶„ í‘œì‹œ
            for (let i = 0; i < originalChars.length; i++) {
                const char = originalChars[i];
                
                // ê³µë°±ì´ë‚˜ ì¤„ë°”ê¿ˆì€ ê·¸ëŒ€ë¡œ í‘œì‹œ
                if (char === ' ' || char === '\n' || char === '\t') {
                    html += char;
                    continue;
                }
                
                // ì´ ìœ„ì¹˜ê°€ ì •ê·œí™”ëœ í…ìŠ¤íŠ¸ì˜ ì–´ëŠ ì¸ë±ìŠ¤ì¸ì§€ í™•ì¸
                const mappedIdx = originalToNormalized[i];
                if (mappedIdx !== undefined && wrongPositions.has(mappedIdx)) {
                    // í‹€ë¦° ë¶€ë¶„ (ë¹¨ê°„ìƒ‰)
                    html += `<span class="incorrect">${escapeHtml(char)}</span>`;
                } else {
                    // ë§ëŠ” ë¶€ë¶„ (ê²€ì€ìƒ‰)
                    html += escapeHtml(char);
                }
            }
            
            html += '</div>';
            comparison.innerHTML = html;
        }

        function showFullAnswer() {
            const questionIndex = shuffledIndices[currentIndex];
            const correctAnswer = currentQuestions[questionIndex].verse;
            
            const fullAnswerDiv = document.getElementById('fullAnswer');
            fullAnswerDiv.textContent = correctAnswer;
            fullAnswerDiv.classList.remove('hide');
        }

        function previousVerse() {
            if (currentIndex > 0) {
                currentIndex--;
                loadCurrentVerse();
            }
        }

        function nextVerse() {
            // í˜„ì¬ ë¬¸ì œì˜ ë‹µì„ ì €ì¥
            const userInput = document.getElementById('userInput').value;
            const questionIndex = shuffledIndices[currentIndex];
            userAnswers[questionIndex] = userInput;
            
            // í˜„ì¬ ë¬¸ì œì˜ ì •ë‹µ ì—¬ë¶€ í™•ì¸ (ì•„ì§ í™•ì¸í•˜ì§€ ì•Šì•˜ë‹¤ë©´)
            if (answerResults[questionIndex] === undefined && userInput.trim().length > 0) {
                const correctAnswer = currentQuestions[questionIndex].verse;
                const normalizedUserInput = normalizeText(userInput);
                const normalizedCorrectAnswer = normalizeText(correctAnswer);
                answerResults[questionIndex] = normalizedUserInput === normalizedCorrectAnswer;
            } else if (answerResults[questionIndex] === undefined) {
                answerResults[questionIndex] = false;
            }
            
            if (currentIndex < currentQuestions.length - 1) {
                currentIndex++;
                loadCurrentVerse();
            } else {
                // ë§ˆì§€ë§‰ ë¬¸ì œì´ë©´ ì˜¤ë‹µë…¸íŠ¸ í™”ë©´ìœ¼ë¡œ ì´ë™
                alert('ë§ˆì§€ë§‰ êµ¬ì ˆì…ë‹ˆë‹¤! ì˜¤ë‹µë…¸íŠ¸ë¥¼ í™•ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
                showWrongAnswers();
            }
        }

        function restartGame() {
            // ì •ë‹µ ê²°ê³¼ ì´ˆê¸°í™”
            answerResults = [];
            userAnswers = [];
            
            if (currentMode === 3) {
                // ì „ì²´ ë¬´ì‘ìœ„ ëª¨ë“œì—ì„œëŠ” ë‹¤ì‹œ ì„ê¸°
                shuffledIndices = shuffleArray([...Array(currentQuestions.length).keys()]);
            } else if (currentMode === 2) {
                // ëª©ì°¨ë³„ ëª¨ë“œì—ì„œëŠ” í•´ë‹¹ ëª©ì°¨ ë‚´ì—ì„œ ë‹¤ì‹œ ì„ê¸°
                shuffledIndices = shuffleArray([...Array(currentQuestions.length).keys()]);
            }
            currentIndex = 0;
            loadCurrentVerse();
        }

        function showWrongAnswers() {
            // í˜„ì¬ ë¬¸ì œì˜ ë‹µì„ ì €ì¥ (ì•„ì§ ì €ì¥ë˜ì§€ ì•Šì•˜ë‹¤ë©´)
            if (document.getElementById('gameArea').classList.contains('active')) {
                const userInput = document.getElementById('userInput').value;
                const questionIndex = shuffledIndices[currentIndex];
                if (userAnswers[questionIndex] === undefined || userAnswers[questionIndex] !== userInput) {
                    userAnswers[questionIndex] = userInput;
                    // ì •ë‹µ ì—¬ë¶€ë„ í™•ì¸
                    if (answerResults[questionIndex] === undefined && userInput.trim().length > 0) {
                        const correctAnswer = currentQuestions[questionIndex].verse;
                        const normalizedUserInput = normalizeText(userInput);
                        const normalizedCorrectAnswer = normalizeText(correctAnswer);
                        answerResults[questionIndex] = normalizedUserInput === normalizedCorrectAnswer;
                    } else if (answerResults[questionIndex] === undefined) {
                        answerResults[questionIndex] = false;
                    }
                }
            }
            
            // í‹€ë¦° ë¬¸ì œë“¤ í•„í„°ë§ (ë‹µì„ ì…ë ¥í•œ ë¬¸ì œ ì¤‘ í‹€ë¦° ê²ƒë§Œ)
            const wrongAnswers = [];
            const answeredQuestions = new Set(); // ì´ë¯¸ ë‹µí•œ ë¬¸ì œë“¤ë§Œ ì²´í¬
            
            for (let i = 0; i < currentQuestions.length; i++) {
                const questionIndex = shuffledIndices[i];
                const userAnswer = userAnswers[questionIndex];
                
                // ë‹µì„ ì…ë ¥í•œ ë¬¸ì œë§Œ ì²´í¬ (userAnswerê°€ ìˆê³  ë¹„ì–´ìˆì§€ ì•Šì€ ê²½ìš°)
                if (userAnswer !== undefined && userAnswer.trim().length > 0) {
                    answeredQuestions.add(i);
                    // ì •ë‹µ ì—¬ë¶€ í™•ì¸ (ì•„ì§ í™•ì¸í•˜ì§€ ì•Šì•˜ë‹¤ë©´)
                    if (answerResults[questionIndex] === undefined) {
                        const correctAnswer = currentQuestions[questionIndex].verse;
                        const normalizedUserInput = normalizeText(userAnswer);
                        const normalizedCorrectAnswer = normalizeText(correctAnswer);
                        answerResults[questionIndex] = normalizedUserInput === normalizedCorrectAnswer;
                    }
                    
                    // í‹€ë¦° ë¬¸ì œë§Œ ì¶”ê°€
                    if (answerResults[questionIndex] === false) {
                        wrongAnswers.push({
                            index: i,
                            questionIndex: questionIndex,
                            verse: currentQuestions[questionIndex],
                            userAnswer: userAnswer
                        });
                    }
                }
            }
            
            // ì˜¤ë‹µì´ ì—†ìœ¼ë©´ ë©”ì‹œì§€ í‘œì‹œ
            if (wrongAnswers.length === 0 && answeredQuestions.size > 0) {
                alert('ğŸ‰ ì§€ê¸ˆê¹Œì§€ í‘¼ ë¬¸ì œ ì¤‘ í‹€ë¦° ê²ƒì´ ì—†ìŠµë‹ˆë‹¤!');
                return;
            } else if (answeredQuestions.size === 0) {
                alert('ì•„ì§ í’€ì§€ ì•Šì€ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤. ë¬¸ì œë¥¼ í’€ì–´ë³´ì„¸ìš”!');
                return;
            }
            
            // ê²Œì„ í™”ë©´ ìˆ¨ê¸°ê³  ì˜¤ë‹µë…¸íŠ¸ í™”ë©´ í‘œì‹œ
            document.getElementById('gameArea').classList.remove('active');
            document.getElementById('wrongAnswersArea').style.display = 'block';
            
            // ì˜¤ë‹µ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
            const wrongAnswersList = document.getElementById('wrongAnswersList');
            let html = `<div style="margin-bottom: 20px; padding: 15px; background: #fee2e2; border-radius: 12px; text-align: center;">
                <p style="font-size: 18px; font-weight: bold; color: #991b1b;">
                    ì´ ${wrongAnswers.length}ê°œì˜ ë¬¸ì œë¥¼ í‹€ë¦¬ì…¨ìŠµë‹ˆë‹¤. (${answeredQuestions.size}ê°œ ë¬¸ì œ í’€ì´ ì™„ë£Œ)
                </p>
            </div>`;
            
            if (wrongAnswers.length > 0) {
                wrongAnswers.forEach((wrong, idx) => {
                    // í‹€ë¦° ë¶€ë¶„ í‘œì‹œë¥¼ ìœ„í•œ HTML ìƒì„±
                    const correctAnswer = wrong.verse.verse;
                    const userAnswerText = wrong.userAnswer;
                    
                    // ê³µë°± ì •ê·œí™”
                    const normalize = (text) => text.replace(/\s+/g, ' ').trim();
                    const correctNormalized = normalize(correctAnswer);
                    const userNormalized = normalize(userAnswerText);
                    
                    // ì •ë‹µê³¼ ì‚¬ìš©ì ì…ë ¥ì„ ë¬¸ì ë°°ì—´ë¡œ ë³€í™˜
                    const correctChars = Array.from(correctNormalized);
                    const userChars = Array.from(userNormalized);
                    
                    // ì›ë³¸ ì •ë‹µ í…ìŠ¤íŠ¸ë¥¼ í‘œì‹œí•˜ë˜, ê³µë°±ì€ ê·¸ëŒ€ë¡œ ìœ ì§€
                    const originalChars = Array.from(correctAnswer);
                    let userIdx = 0;
                    let normalizedIdx = 0; // ì •ê·œí™”ëœ í…ìŠ¤íŠ¸ì˜ ì¸ë±ìŠ¤ ì¶”ì 
                    
                    let verseHtml = '';
                    for (let i = 0; i < originalChars.length; i++) {
                        const char = originalChars[i];
                        
                        // ê³µë°±ì´ë‚˜ ì¤„ë°”ê¿ˆì€ ê·¸ëŒ€ë¡œ í‘œì‹œ
                        if (char === ' ' || char === '\n' || char === '\t') {
                            verseHtml += char;
                            // ì‚¬ìš©ì ì…ë ¥ì˜ ê³µë°±ë„ ê±´ë„ˆë›°ê¸°
                            while (userIdx < userChars.length && 
                                   (userChars[userIdx] === ' ' || userChars[userIdx] === '\n' || userChars[userIdx] === '\t')) {
                                userIdx++;
                            }
                            continue;
                        }
                        
                        // ì •ë‹µì˜ í˜„ì¬ ë¬¸ìì™€ ì‚¬ìš©ì ì…ë ¥ì˜ í•´ë‹¹ ìœ„ì¹˜ ë¬¸ì ë¹„êµ
                        if (normalizedIdx < correctChars.length) {
                            const correctChar = correctChars[normalizedIdx];
                            
                            if (userIdx < userChars.length && correctChar === userChars[userIdx]) {
                                // ì¼ì¹˜í•˜ëŠ” ë¬¸ì (ê²€ì€ìƒ‰)
                                verseHtml += escapeHtml(char);
                                userIdx++;
                            } else {
                                // í‹€ë¦° ë¶€ë¶„ (ë¹¨ê°„ìƒ‰)
                                verseHtml += `<span class="incorrect">${escapeHtml(char)}</span>`;
                                // ì‚¬ìš©ì ì…ë ¥ì— ì˜ëª»ëœ ë¬¸ìê°€ ìˆìœ¼ë©´ ê±´ë„ˆë›°ê¸°
                                if (userIdx < userChars.length && userChars[userIdx] !== ' ' && 
                                    userChars[userIdx] !== '\n' && userChars[userIdx] !== '\t') {
                                    userIdx++;
                                }
                            }
                            normalizedIdx++;
                        } else {
                            // ì •ë‹µ í…ìŠ¤íŠ¸ë¥¼ ëª¨ë‘ ì²˜ë¦¬í•œ í›„ ë‚¨ì€ ë¬¸ìë“¤
                            verseHtml += escapeHtml(char);
                        }
                    }
                    
                    html += `
                        <div class="wrong-answer-item">
                            <div class="wrong-answer-header">
                                <div>
                                    <div class="wrong-answer-reference">${wrong.verse.reference}</div>
                                    <div class="wrong-answer-number">${currentMode === 3 ? '' : 'No. ' + wrong.verse.no + ' - ' + wrong.verse.category}</div>
                                </div>
                                <div style="font-size: 14px; color: #ef4444; font-weight: bold;">
                                    ì˜¤ë‹µ ${idx + 1}/${wrongAnswers.length}
                                </div>
                            </div>
                            <div class="wrong-answer-verse">
                                ${verseHtml}
                            </div>
                        </div>
                    `;
                });
            } else {
                html += `<div style="text-align: center; padding: 40px; color: #6b7280;">
                    <p style="font-size: 18px;">í‹€ë¦° ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤!</p>
                </div>`;
            }
            
            wrongAnswersList.innerHTML = html;
        }

        function backToGame() {
            // ì˜¤ë‹µë…¸íŠ¸ í™”ë©´ ìˆ¨ê¸°ê³  ê²Œì„ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            document.getElementById('wrongAnswersArea').style.display = 'none';
            document.getElementById('gameArea').classList.add('active');
        }

        function goHome() {
            // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°
            document.getElementById('gameArea').classList.remove('active');
            document.getElementById('categorySelector').classList.remove('active');
            document.getElementById('wrongAnswersArea').style.display = 'none';
            
            // ìƒíƒœ ì´ˆê¸°í™”
            currentMode = null;
            currentCategory = null;
            currentQuestions = [];
            currentIndex = 0;
            shuffledIndices = [];
            answerResults = [];
            userAnswers = [];
            isChecking = false;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ì…ë ¥ í›„ ìë™ ì²´í¬ (ë””ë°”ìš´ìŠ¤)
        let checkTimeout;
        let lastCheckedValue = '';
        const userInputElement = document.getElementById('userInput');
        userInputElement.addEventListener('input', () => {
            const currentValue = userInputElement.value;
            
            // ì…ë ¥ì´ ë³€ê²½ë˜ë©´ ì´ì „ ì •ë‹µ ìƒíƒœ ë¦¬ì…‹
            if (currentValue !== lastCheckedValue && isChecking) {
                isChecking = false;
                document.getElementById('resultMessage').classList.remove('show', 'correct');
            }
            
            clearTimeout(checkTimeout);
            checkTimeout = setTimeout(() => {
                checkAnswer();
                lastCheckedValue = userInputElement.value;
            }, 300);
        });
    </script>
</body>
</html>
